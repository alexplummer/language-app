{"version":3,"sources":["app.js","appData.js","viewCreation.js","queryInteraction.js","termInteraction.js","homeScreen.js","helperFunctions.js","termCreation.js","introInstructions.js","menuInteraction.js"],"names":["tinyTermsApp","appData","fonts","solid","light","feather","viewCreate","termsToCreate","viewHTML","value","termValue","tinyTerms","pickedList","terms","term","definitionValue","definition","supportValue","support","termEncode","makeSafeClass","revealCounter","viewsCount","storedData","revealGoal","undefined","globalUnlocks","bgStars","active","document","querySelector","classList","add","bgLetters","innerHTML","action","dailyQuery","particles","j","newHolder","ops","revealGoalTarget","termHolders","querySelectorAll","i","length","style","minHeight","countLines","viewedTerms","colour","termWrapper","pickedColour","background","color","symbol","pickedSymbol","revealCountdowns","revealBtn","revealTerm","parentNode","createRevealTimer","addHearts","heartHolder","heartsHTML","hearts","points","localforage","setItem","storedName","goalMeters","termWrappers","goalCount","parseInt","getElementsByTagName","setScore","getItem","err","savedScore","score","progressBar","learnedTerms","completed","Object","keys","remaining","width","createNewQuery","bonus","randomTerm","queryTerms","correctTerms","incorrectTerms","cycledTerms","pickRandom","hasOwnProperty","dailyReminder","queryHandler","dailyTerms","indexOf","queryWrapper","remove","querySubmit","resultHolder","scoreHolder","count","queryComplete","window","addEventListener","e","keyCode","click","preventDefault","queryInput","trim","checkQuery","winCase","border","loseCase","spelling","input","correct","placeholder","removeChild","revealedBtnHandler","clickListener","contains","explode","setTimeout","countHolder","definitionWrapper","definitionHolder","viewCount","revealGoalCount","gameWon","modal","view","completeBonus","winBonus","complete","dailyBonus","minutes","counterMins","seconds","counterSecs","remainingMinutes","remainingSeconds","startTime","timerEnded","Date","getTime","startTimer","nowTime","setAttribute","diffSecs","Math","floor","totalSecs","clearInterval","timerUpdate","timeout","checkCount","setInterval","buttonTimer","disabled","displayedMinutes","displayedSeconds","hiddenZero","textToSpeech","termHolder","languages","TTS","speech","SpeechSynthesisUtterance","lang","speechLang","speechSynthesis","speak","text","locale","rate","reason","alertMsg","k","dictionaryLookup","dictionaryBtn","practiceContent","toUpperCase","encodeURI","dictFrom","dictTo","toLowerCase","jsonp","then","data","dictionaryResponses","findProp","obj","key","out","proto","prototype","ts","toString","hasOwn","bind","call","tuc","console","log","wikiLink","firstTerm","result","query","pages","extract","JSON","parse","addColour","colourBtn","picker","colours","neonColours","metalColours","coloursNeon","coloursMetal","coloursHolder","backgroundColor","getAttribute","colourListener","hideModal","pickSymbol","symbolBtn","symbolHTML","symbols","symbolsSolid","symbolsFeather","symbolListener","symbolClickListener","eachTable","event","target","srcElement","trigger","modalClose","closeModal","showHome","uploadedLists","customListChoices","val","listName","name","listCategory","category","listURL","sheetURL","categoryHandler","homeWrapper","homeHeader","chooseList","categories","navBack","scrollArrow","scrollCheck","lists","categoryBtn","display","buildList","showList","showCategoriesAgain","navListeners","listChoices","clientHeight","scrollHeight","scrollTop","listItem","AllPicked","includes","push","location","reload","removeList","insertPoint","nextSibling","insertBefore","createElement","childNodes","removeItem","zIndex","unlockedView","lockedView","webView","store","refresh","product","get","owned","unlockedListeners","order","when","approved","finish","inputName","inputSheet","uploadList","substring","checkURL","ready","fn","readyState","errorReport","cordova","plugins","instabug","invoke","tutComplete","errorAlert","message","cb","onerror","errorMsg","url","lineNumber","column","errorObj","buildData","columnName","Sheet1","columnNames","elements","termContent","Term","definitionContent","Definition","supportContent","Support","replace","postBuildCallback","checkConnection","offline","online","image","Image","network","src","escape","onload","getComputedStyle","height","getPropertyValue","font_size","line_height","box_sizing","isNaN","padding_top","padding_bottom","border_top","border_bottom","lines","ceil","checkSameDay","todaysDate","getTodaysDate","storedDate","Array","from","dateOpened","arrayCheck","addDay","newDay","todayDate","day","getDate","month","getMonth","str","a","href","host","s","c","charCodeAt","slice","arr1","arr2","stringify","clickFunction","objectList","pickedTerm","random","item1","item2","getBigrams","string","ref","v","stringSimilarity","str1","str2","hit_count","len","len1","pairs1","pairs2","union","x","y","relevance","wordAccuracy","appBlur","hidden","onchange","onfocusin","onfocusout","onpageshow","onpagehide","onfocus","onblur","evt","h","evtMap","focus","focusin","pageshow","blur","focusout","pagehide","type","sortArrayByKey","arr","reverse","sortOrder","sort","b","uri","Promise","resolve","reject","id","round","callbackName","ele","getElementById","script","body","documentElement","appendChild","getListOfTerms","listOfTerms","scannedTerms","dataLength","displayedTerms","firstTime","reminderTerm","remindedTerms","getOwnPropertyNames","viewedLength","viewedSorted","m","splice","onboardShow","onBoardText","topTerm","topBtn","onboardStage2","cssText","termOffset","offsetTop","offsetHeight","top","onboardStage3","onboardStage4","timerOveride","removeAttribute","onboardStage5","goal","onboardStage6","onboardStage7","onboardStage7b","onboardStage8","queryWrap","onboardStage9","navMenu","nav","showNav","hideNav","tinyTermsAllPicked","navHTML","navItems","footerMenu","paidItems","listItems","globalItems","godMode","clickListenerFromVar","unlockItem","listUnlocks","currentScore","itemCost","termsRefresh","pickedTerms","paidUnlocks","check10","terms10","existingTerms","joinedTerms","concat","buttonOnHTML","buttonOffHTML","thisItem","storedValue","clickedItem","className","itemIndex","outerHTML","viewed","incorrect","learned","learnedTerm","learnedDefinition","optionsDisplay","settingsBtn","resetList","resetApp","notifyAsk","resetMenu","clear","defaultTimes","reminderTimes","getTimes","reminderTimesLength","hours","mins","time","addTime","timeClass","timeTemplate","updateListeners","saveReminders","notification","local","cancelAll","timeButtons","timeCount","editedTime","split","theDate","setHours","setMinutes","setSeconds","schedule","firstAt","every","led","thisToggle","thisWrap","thisInput","mdDateTimePicker","default","mode","moment","toggle","pop","debug","loadDelay","timerHalf","notLoaded","noConnection","isConnection","getLists","buildLists","Tabletop","init","callback","fetchListData","simpleSheet","Name","Category","version","Version","skipDefaultCheck","tinyTermsDefault","tutStatus","checkDefault","normalLoad","firstLoad","defaultlist","setUnlocks","initialise","storedPaidUnlocks","storedGlobalUnlocks","fetchData","appBuildHandler","revealedTermCount","tinyTerms$1"],"mappings":"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","file":"app.js","sourcesContent":["// Imports\r\nimport { ready, cl, clv, buildData, errorReport, errorAlert, alertMsg, checkSameDay, checkConnection, arrayCheck, getTodaysDate, appBlur } from \"helperFunctions\";\r\nimport { getListOfTerms } from \"termCreation\";\r\nimport { revealedBtnHandler, dictionaryLookup, textToSpeech, addColour, hideModal, pickSymbol } from \"termInteraction\";\r\nimport { viewCreate, addHearts, goalMeters, setScore, progressBar } from \"viewCreation\";\r\nimport { createNewQuery } from \"queryInteraction\";\r\nimport { showHome } from \"homeScreen\";\r\nimport { onboardShow } from \"introInstructions\";\r\nimport { navMenu, footerMenu, optionsDisplay, notifyAsk } from \"menuInteraction\";\r\nimport appData from \"appData\";\r\n\r\n// Exports\r\nexport default tinyTerms;\r\n\r\n// App namespace\r\nlet tinyTerms = tinyTerms || {};\r\n\r\n// Global options\r\nconst ops = {\r\n\tdisplayedTerms: 5,\r\n\tcounterMins: 60,\r\n\tcounterSecs: 0,\r\n\trevealGoalTarget: 3,\r\n\twordAccuracy: 0.7,\r\n\taddDay: false,\r\n\tdebug: false,\r\n\tgodMode: false,\r\n\tloadDelay: 2500,\r\n\tpoints: {\r\n\t\tcorrect: 50,\r\n\t\tdailyBonus: 10,\r\n\t\thearts: 3,\r\n\t\twinBonus: 10\r\n\t}\r\n};\r\n\r\n// Matches with array of menu items in menuInteraction.js\r\nconst paidUnlocks = {\r\n\tterms10: { points: 0, active: 'locked' },\r\n}\r\nconst listUnlocks = {\r\n\ttermsRefresh: { points: 250, active: 'locked' },\r\n\ttimerHalf: { points: 300, active: 'locked' },\r\n}\r\nconst globalUnlocks = {\r\n\tcoloursNeon: { points: 500, active: 'locked' },\r\n\tsymbolsSolid: { points: 1000, active: 'locked' },\r\n\tbgStars: { points: 3000, active: 'locked' },\r\n\tsymbolsFeather: { points: 5000, active: 'locked' },\r\n\tbgLetters: { points: 10000, active: 'locked' },\r\n\tcoloursMetal: { points: 50000, active: 'locked' },\r\n}\r\n\r\n// Crash protection\r\nlet notLoaded = true;\r\n\r\nsetTimeout(() => {\r\n\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\r\n\tif (notLoaded === true) {\r\n\t\tlet modal = document.querySelector('.m-modal');\r\n\t\tmodal.classList.remove(\"hidden\");\r\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\r\n\r\n\t\tlet view = `<header>\r\n\t\t\t\t\t\t<h2 class=\"\">Uh oh!</h2>\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\t<p>Sorry something went wrong, make sure you are connected to the internet and try again.</p>\r\n\t\t\t\t\t<p>If this keeps happening you can reset the list by <a href=\"#\" class=\"reset-list\">clicking here</a> (wipes list progress).</p>\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\t<button class=\"crash-report\">Report issue</button><button class=\"home-btn\">Close</button>\r\n\t\t\t\t\t`;\r\n\r\n\t\t// Add view\r\n\t\tmodal.querySelector(\".content\").innerHTML = view;\r\n\t\tmodal.classList.add('onboard');\r\n\r\n\t\tdocument.querySelector('.crash-report').addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\terrorReport();\r\n\t\t});\r\n\r\n\t\tdocument.querySelector(\".reset-list\").addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tdelete tinyTerms[tinyTerms.pickedList];\r\n\r\n\t\t\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]).then(function (value) {\r\n\t\t\t\tlocalforage.removeItem('tinyTermsDefault').then(function () {\r\n\t\t\t\t\tlocation.reload();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tshowHome();\r\n\t\t});\r\n\t}\r\n}, 20000);\r\n\r\n// Initialise modules on load\r\nready(function () {\r\n\t\"use strict\";\r\n\r\n\tlocalforage.getItem(\"tinyTerms.lists\", function (err, lists) {\r\n\r\n\t\t// Check for internet, pull list references if connection\r\n\t\tcheckConnection(noConnection, isConnection);\r\n\r\n\t\tfunction noConnection() {\r\n\t\t\tif (lists === null) {\r\n\t\t\t\talertMsg(\"Please connect to the internet to download the lists, after they will be available offline.\", () => {\r\n\t\t\t\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tshowHome();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttinyTerms.listChoices = lists;\r\n\t\t\t\tgetLists();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction isConnection() {\r\n\t\t\tbuildLists();\r\n\t\t}\r\n\t});\r\n\r\n\tfunction buildLists() {\r\n\r\n\t\tTabletop.init({\r\n\t\t\tkey: 'https://docs.google.com/spreadsheets/d/1T8sb0SJRxJQdwgWywAQQnq6rxHt0JRo-81q5Hz_jvXQ/pubhtml',\r\n\t\t\tcallback: fetchListData,\r\n\t\t\tsimpleSheet: false\r\n\t\t});\r\n\r\n\t\tfunction fetchListData(data) {\r\n\t\t\t// Reset default\r\n\t\t\ttinyTerms.listChoices = {};\r\n\r\n\t\t\tfor (let i = 0; i < data.Sheet1.elements.length; i++) {\r\n\r\n\t\t\t\ttinyTerms.listChoices[data.Sheet1.elements[i].Name] = {\r\n\t\t\t\t\tname: data.Sheet1.elements[i].Name,\r\n\t\t\t\t\tcategory: data.Sheet1.elements[i].Category,\r\n\t\t\t\t\tsheetURL: data.Sheet1.elements[i].sheetURL,\r\n\t\t\t\t\tversion: data.Sheet1.elements[i].Version\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlocalforage.setItem(\"tinyTerms.lists\", tinyTerms.listChoices, () => {\r\n\t\t\t\tgetLists();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// Pick a list\r\nfunction getLists(skipDefaultCheck) {\r\n\tlet tinyTermsDefault;\r\n\r\n\tlocalforage.getItem(\"tinyTerms.tutComplete\", function (err, tutStatus) {\r\n\t\ttinyTerms.tutComplete = tutStatus;\r\n\r\n\t\t// Check for default list, used on very first load\r\n\t\tlocalforage.getItem(\"tinyTermsDefault\", function (err, value) {\r\n\t\t\ttinyTermsDefault = value;\r\n\r\n\t\t\tif (tinyTermsDefault === null) {\r\n\t\t\t\tnotLoaded = false;\r\n\t\t\t\tshowHome();\r\n\t\t\t} else {\r\n\t\t\t\tcheckDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t// Check to see if default list already has data\r\n\tfunction checkDefault() {\r\n\t\t// Check for existing data of newly picked list\r\n\t\tlocalforage.getItem(\"tinyTerms\" + tinyTermsDefault, function (err, value) {\r\n\r\n\t\t\t// If data exists in storage, load normally\r\n\t\t\tif (value !== null) {\r\n\t\t\t\ttinyTerms.pickedList = tinyTermsDefault;\r\n\t\t\t\tnormalLoad(tinyTerms.pickedList);\r\n\t\t\t}\r\n\t\t\t// Fetch data if connection\r\n\t\t\telse {\r\n\t\t\t\tcheckConnection(noConnection, isConnection);\r\n\t\t\t\tnotLoaded = false;\r\n\r\n\t\t\t\tfunction noConnection() {\r\n\t\t\t\t\talertMsg(\"Please connect to the internet to download the list, after it will be available offline.\", () => {\r\n\t\t\t\t\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\tshowHome()\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfunction isConnection() {\r\n\t\t\t\t\tfirstLoad();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t\r\n\tfunction normalLoad(defaultlist) {\r\n\t\ttinyTerms.storedName = \"tinyTerms\" + defaultlist;\r\n\r\n\t\tlocalforage.getItem(\"tinyTerms\" + defaultlist, function (err, value) {\r\n\t\t\t\r\n\t\t\t// Set session storage to stored\r\n\t\t\ttinyTerms[tinyTerms.pickedList] = value;\r\n\r\n\t\t\t// Update stored ops\r\n\t\t\ttinyTerms[tinyTerms.pickedList].ops = ops; \r\n\r\n\t\t\tlocalforage.getItem(\"tinyTerms.globalUnlocks\", function (err, globalUnlocks) {\r\n\t\t\t\r\n\t\t\t\t// Set global unlocks ops attributes\r\n\t\t\t\tif (globalUnlocks !== null) {\r\n\t\t\t\t\ttinyTerms.globalUnlocks =  globalUnlocks;\r\n\r\n\t\t\t\t\t// Ten terms\r\n\t\t\t\t\tif (typeof tinyTerms.globalUnlocks.terms10 !== 'undefined') {\r\n\r\n\t\t\t\t\t\tif (tinyTerms.globalUnlocks.terms10.active === 'unlocked') {\r\n\t\t\t\t\t\t\ttinyTerms[tinyTerms.pickedList].ops.displayedTerms = 10;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Set list unlocks ops attributes\r\n\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks !== undefined) {\r\n\r\n\t\t\t\t\t// Half timer\r\n\t\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks.timerHalf.active === 'unlocked') {\r\n\t\t\t\t\t\ttinyTerms[tinyTerms.pickedList].ops.counterMins = 30;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tsetUnlocks(initialise);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Set unlocks\r\nconst setUnlocks = function setUnlocks(callback) {\r\n\r\n\t// Set paid list unlocks\r\n\tlocalforage.getItem(\"tinyTerms.paidUnlocks\", function (err, storedPaidUnlocks) {\r\n\r\n\t\ttinyTerms.paidUnlocks = storedPaidUnlocks || paidUnlocks;\r\n\r\n\t\t// Ten terms\r\n\t\tif (tinyTerms.paidUnlocks.terms10.active === 'unlocked') {\r\n\t\t\ttinyTerms[tinyTerms.pickedList].ops.displayedTerms = 10;\r\n\t\t}\r\n\r\n\t\t// Set global unlocks\r\n\t\tlocalforage.getItem(\"tinyTerms.globalUnlocks\", function (err, storedGlobalUnlocks) {\r\n\r\n\t\t\t// Set default list unlocks\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.listUnlocks = tinyTerms[tinyTerms.pickedList].storedData.listUnlocks || listUnlocks;\r\n\t\t\t\r\n\t\t\t// Set default global unlocks\r\n\t\t\ttinyTerms.globalUnlocks = storedGlobalUnlocks || globalUnlocks;\r\n\t\t\t\t\t\t\r\n\t\t\t// Reset terms refresh \r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.listUnlocks.termsRefresh.active = 'locked';\r\n\r\n\t\t\t// Set list unlocks ops attributes\r\n\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks !== undefined) {\r\n\r\n\t\t\t\t// Half timer\r\n\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks.timerHalf.active === 'unlocked') {\r\n\t\t\t\t\ttinyTerms[tinyTerms.pickedList].ops.counterMins = 30;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcallback();\r\n\t\t});\r\n\t});\r\n}\r\n\r\n\r\n// Sets up new list, gets data\r\nconst firstLoad = function firstLoad() {\r\n\r\n\tlocalforage.getItem(\"tinyTermsDefault\", function (err, value) {\r\n\t\t// Set session storage to stored\r\n\t\ttinyTerms.pickedList = value;\r\n\r\n\t\t// Set picked list and create data object for it\r\n\t\ttinyTerms[tinyTerms.pickedList] = {};\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData = {};\r\n\t\ttinyTerms[tinyTerms.pickedList].ops = ops;\r\n\t\ttinyTerms.storedName = \"tinyTerms\" + tinyTerms.pickedList;\r\n\r\n\t\t// Add to storage\r\n\t\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList], () => {\r\n\t\t\t// Add default lists to uploadedLists, same place as user upload\r\n\t\t\tlocalforage.getItem(\"tinyTerms.uploadedLists\", function (err, uploadedLists) {\r\n\t\t\t\tlet sheetURL;\r\n\r\n\t\t\t\tuploadedLists = uploadedLists || {};\r\n\t\t\t\t// If list from uploaded lists\r\n\t\t\t\tif (uploadedLists.hasOwnProperty(tinyTerms.pickedList)) {\r\n\t\t\t\t\tsheetURL = uploadedLists[tinyTerms.pickedList].sheetURL;\r\n\t\t\t\t}\r\n\t\t\t\t// Else from default lists\r\n\t\t\t\telse {\r\n\t\t\t\t\tsheetURL = tinyTerms.listChoices[tinyTerms.pickedList].sheetURL;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Error handling for Tabletop\r\n\t\t\t\terrorAlert('Couldn\\'t load the list URL, did you copy it correctly?', () => {\r\n\r\n\t\t\t\t\t// Clear list references callback\r\n\t\t\t\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\t\t\t\tlocalforage.removeItem(tinyTerms.pickedList);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tnotLoaded = false;\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Fetch data for list\r\n\t\t\t\tfetchData(sheetURL, firstTime);\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\t\r\n\t});\r\n};\r\n\r\n// Fetches list data\r\nconst fetchData = function fetchData(sheetURL, postBuildCallback) {\r\n\r\n\t// Add a callback method\r\n\ttinyTerms.postBuildCallback = postBuildCallback;\r\n\r\n\t// Get data from sheets\r\n\tTabletop.init({\r\n\t\tkey: sheetURL,\r\n\t\tcallback: buildData,\r\n\t\tsimpleSheet: false\r\n\t});\r\n};\r\n\r\n// Runs if first time list has run\r\nconst firstTime = function firstTime() {\r\n\r\n\t// Create terms\r\n\tsetUnlocks(appBuildHandler);\r\n\r\n\t// Then set first time to false\r\n\ttinyTerms[tinyTerms.pickedList].storedData.firstTime = false;\r\n\r\n\t// Add to storage\r\n\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n};\r\n\r\n// Initialises data and app\r\nconst initialise = function initialise() {\r\n\t\r\n\t// Check if list data got downloaded\r\n\tif (tinyTerms[tinyTerms.pickedList].storedData.dateOpened === undefined) {\r\n\t\t// Clear list references if badly downloaded\r\n\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\tlocalforage.removeItem('tinyTermsDefault').then(function () {\r\n\t\t\t\t\tlocalforage.removeItem(tinyTerms.pickedList);\r\n\t\t\t\t});\r\n\t\t});\r\n\t\tnotLoaded = false;\r\n\t}\r\n\t// Check if a new day\r\n\tcheckSameDay();\r\n\r\n\t// Start build\r\n\tappBuildHandler();\r\n};\r\n\r\n// Calls functions to handle app creation and running\r\nconst appBuildHandler = function appBuildHandler() {\r\n\r\n\t// Get initial terms\r\n\tlet pickedTerms;\r\n\r\n\t// If same day, used daily terms\r\n\tif (tinyTerms[tinyTerms.pickedList].storedData.newDay === false) {\r\n\t\tpickedTerms = tinyTerms[tinyTerms.pickedList].storedData.dailyTerms;\r\n\r\n\t\t// Load query if it exists already\r\n\t\tif (\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyQuery !== undefined &&\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.queryComplete !== true\r\n\t\t) {\r\n\t\t\tcreateNewQuery();\r\n\t\t}\r\n\t} else {\r\n\t\t// Else get new\r\n\t\tpickedTerms = getListOfTerms();\r\n\r\n\t\t// Clear daily goals\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.revealedTermCount;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.dailyReminder;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.hearts;\r\n\t\t\r\n\t\t// Reset store unlocks\r\n\t\tif (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks !== undefined) {\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.listUnlocks.timerHalf.active = 'locked';\r\n\t\t}\r\n\r\n\t\t// Reset daily reveal bonus\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal = tinyTerms[tinyTerms.pickedList].storedData.revealGoal || {};\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete = false;\r\n\r\n\t\t// Create query if revealed terms\r\n\t\tif (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms !== undefined) {\r\n\t\t\tcreateNewQuery();\r\n\t\t}\r\n\r\n\t\t// Create reminded terms default\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms = tinyTerms[tinyTerms.pickedList].storedData.remindedTerms || {};\r\n\t}\r\n\r\n\t// Create initial view\r\n\tviewCreate(pickedTerms);\r\n\tsetScore();\r\n\r\n\t// Create opened date, daily terms, viewed terms\r\n\ttinyTerms[tinyTerms.pickedList].storedData.dateOpened = getTodaysDate();\r\n\ttinyTerms[tinyTerms.pickedList].storedData.dailyTerms = pickedTerms;\r\n\r\n\t// Add to storage\r\n\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n\t// Keep query active each day\r\n\ttinyTerms[tinyTerms.pickedList].storedData.queryComplete = tinyTerms[tinyTerms.pickedList].storedData.queryComplete || {};\r\n\r\n\t// Handles events for revealed terms\r\n\trevealedBtnHandler();\r\n\tdictionaryLookup();\r\n\ttextToSpeech();\r\n\taddColour();\r\n\tpickSymbol();\r\n\thideModal();\r\n\r\n\t// Builds UI elements\r\n\tprogressBar();\r\n\tgoalMeters();\r\n\r\n\t// Shows options menu\r\n\tnavMenu();\r\n\tfooterMenu();\r\n\toptionsDisplay();\r\n\r\n\t// Refresh window on blur\r\n\tappBlur();\r\n\r\n\t// App should have loaded by here\r\n\tnotLoaded = false;\r\n\r\n\tif (tinyTerms.tutComplete === true && typeof cordova !== 'undefined') {\r\n\r\n\t\t// Ask for reminders\r\n\t\tlocalforage.getItem(\"tinyTerms.askNotify\", function (err, value) {\r\n\r\n\t\t\tif (value === null) {\r\n\t\t\t\tlet modal = document.querySelector('.m-modal');\r\n\t\t\t\tmodal.classList.remove(\"hidden\");\r\n\t\t\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\r\n\r\n\t\t\t\tlet view = `<header>\r\n\t\t\t\t\t\t\t\t<h2 class=\"\">Setup reminders</h2>\r\n\t\t\t\t\t\t\t</header>\r\n\t\t\t\t\t\t\t<p>Tiny Terms allows you to add reminders, these notifications are helpful if you want to really commit to learning those terms.</p>\r\n\t\t\t\t\t\t\t<p><strong>(You can change reminder settings from the menu)</strong></p>\r\n\t\t\t\t\t\t\t<button class=\"remind-yes width\">Setup reminders</button>\r\n\t\t\t\t\t\t\t`;\r\n\r\n\t\t\t\t// Add view\r\n\t\t\t\tmodal.querySelector(\".content\").innerHTML = view;\r\n\r\n\t\t\t\tdocument.querySelector('.remind-yes').addEventListener('click', (e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tnotifyAsk();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Set storage\r\n\t\t\t\tvalue = true;\r\n\t\t\t\tlocalforage.setItem('tinyTerms.askNotify', value);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t// Once loaded\r\n\tsetTimeout(\r\n\t\t() => {\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\t\t\tdocument.querySelector(\".m-query\").classList.add(\"animated\", \"slideInDown\");\r\n\r\n\t\t\t// Show onboard if incomplete\r\n\t\t\tif (tinyTerms.tutComplete === null || tinyTerms.tutComplete === false) {\r\n\t\t\t\tonboardShow();\r\n\t\t\t}\r\n\t\t},\r\n\t\ttinyTerms[tinyTerms.pickedList].ops.loadDelay\r\n\t);\r\n\r\n\t// Debug code\r\n\tif (tinyTerms[tinyTerms.pickedList].ops.debug === true) {\r\n\t\tconsole.log(tinyTerms);\r\n\t}\r\n};","// App data\r\n\r\nexport default {\r\n    fonts: {\r\n        solid: [\r\n            'icon-puchi-puchi_adapt',\r\n            'icon-puchi-puchi_affect',\r\n            'icon-puchi-puchi_alarm',\r\n            'icon-puchi-puchi_blaze',\r\n            'icon-puchi-puchi_call',\r\n            'icon-puchi-puchi_cry',\r\n            'icon-puchi-puchi_drink',\r\n            'icon-puchi-puchi_eat',\r\n            'icon-puchi-puchi_game',\r\n            'icon-puchi-puchi_judge',\r\n            'icon-puchi-puchi_like',\r\n            'icon-puchi-puchi_listen',\r\n            'icon-puchi-puchi_lock',\r\n            'icon-puchi-puchi_ring',\r\n            'icon-puchi-puchi_select',\r\n            'icon-puchi-puchi_speak',\r\n            'icon-puchi-puchi_think',\r\n            'icon-puchi-puchi_treat'\r\n        ],\r\n        light: [\r\n            'icon-feather_add',\r\n            'icon-feather_analyze',\r\n            'icon-feather_bloom',\r\n            'icon-feather_brew',\r\n            'icon-feather_climb',\r\n            'icon-feather_copy',\r\n            'icon-feather_crave',\r\n            'icon-feather_encourage',\r\n            'icon-feather_fall',\r\n            'icon-feather_fly',\r\n            'icon-feather_glow',\r\n            'icon-feather_grow',\r\n            'icon-feather_heat',\r\n            'icon-feather_laugh',\r\n            'icon-feather_manufacture',\r\n            'icon-feather_mine',\r\n            'icon-feather_plot',\r\n            'icon-feather_prick'\r\n        ],\r\n        feather: [\r\n            \"icon-lines-and-angles_accommodate\",\r\n            \"icon-lines-and-angles_adapt\",\r\n            \"icon-lines-and-angles_add\",\r\n            \"icon-lines-and-angles_adjust\",\r\n            \"icon-lines-and-angles_agitate\",\r\n            \"icon-lines-and-angles_agree\",\r\n            \"icon-lines-and-angles_aid\",\r\n            \"icon-lines-and-angles_alarm\",\r\n            \"icon-lines-and-angles_alert\",\r\n            \"icon-lines-and-angles_amaze\",\r\n            \"icon-lines-and-angles_amplify\",\r\n            \"icon-lines-and-angles_analyze\",\r\n            \"icon-lines-and-angles_announce\",\r\n            \"icon-lines-and-angles_arrest\",\r\n            \"icon-lines-and-angles_ascend\",\r\n            \"icon-lines-and-angles_ask\",\r\n            \"icon-lines-and-angles_assist\",\r\n            \"icon-lines-and-angles_attract\",\r\n            \"icon-lines-and-angles_augment\",\r\n            \"icon-lines-and-angles_bake\",\r\n            \"icon-lines-and-angles_balance\",\r\n            \"icon-lines-and-angles_battle\",\r\n            \"icon-lines-and-angles_be\",\r\n            \"icon-lines-and-angles_believe\",\r\n            \"icon-lines-and-angles_birth\",\r\n            \"icon-lines-and-angles_blaze\",\r\n            \"icon-lines-and-angles_blend\",\r\n            \"icon-lines-and-angles_bloom\",\r\n            \"icon-lines-and-angles_blow\",\r\n            \"icon-lines-and-angles_bookmark\",\r\n            \"icon-lines-and-angles_bootleg\",\r\n            \"icon-lines-and-angles_bounce\",\r\n            \"icon-lines-and-angles_break\",\r\n            \"icon-lines-and-angles_brew\",\r\n            \"icon-lines-and-angles_broadcast\",\r\n            \"icon-lines-and-angles_browse\",\r\n            \"icon-lines-and-angles_build\",\r\n            \"icon-lines-and-angles_burn\",\r\n            \"icon-lines-and-angles_bury\",\r\n            \"icon-lines-and-angles_buy\",\r\n            \"icon-lines-and-angles_caffeinate\",\r\n            \"icon-lines-and-angles_calculate\",\r\n            \"icon-lines-and-angles_calibrate\",\r\n            \"icon-lines-and-angles_carry\",\r\n            \"icon-lines-and-angles_carve\",\r\n            \"icon-lines-and-angles_cast\",\r\n            \"icon-lines-and-angles_catch\",\r\n            \"icon-lines-and-angles_cease\",\r\n            \"icon-lines-and-angles_celebrate\",\r\n            \"icon-lines-and-angles_challenge\",\r\n            \"icon-lines-and-angles_charge\",\r\n            \"icon-lines-and-angles_charm\",\r\n            \"icon-lines-and-angles_chart\",\r\n            \"icon-lines-and-angles_chat\",\r\n            \"icon-lines-and-angles_choose\",\r\n            \"icon-lines-and-angles_chop\",\r\n            \"icon-lines-and-angles_clean\",\r\n            \"icon-lines-and-angles_cleanse\",\r\n            \"icon-lines-and-angles_climb\",\r\n            \"icon-lines-and-angles_drum\",\r\n            \"icon-lines-and-angles_eat\",\r\n            \"icon-lines-and-angles_edit\",\r\n            \"icon-lines-and-angles_enhance\",\r\n            \"icon-lines-and-angles_enlarge\",\r\n            \"icon-lines-and-angles_enter\",\r\n            \"icon-lines-and-angles_equal\",\r\n            \"icon-lines-and-angles_erase\",\r\n            \"icon-lines-and-angles_examine\",\r\n            \"icon-lines-and-angles_experiment\",\r\n            \"icon-lines-and-angles_explore\",\r\n            \"icon-lines-and-angles_extrude\",\r\n            \"icon-lines-and-angles_feed\",\r\n            \"icon-lines-and-angles_fight\",\r\n            \"icon-lines-and-angles_fill\",\r\n            \"icon-lines-and-angles_film\",\r\n            \"icon-lines-and-angles_filter\",\r\n            \"icon-lines-and-angles_find\",\r\n            \"icon-lines-and-angles_finish\",\r\n            \"icon-lines-and-angles_fix\",\r\n            \"icon-lines-and-angles_flag\",\r\n            \"icon-lines-and-angles_float\",\r\n            \"icon-lines-and-angles_flow\",\r\n            \"icon-lines-and-angles_fly\",\r\n            \"icon-lines-and-angles_focus\",\r\n            \"icon-lines-and-angles_fold\",\r\n            \"icon-lines-and-angles_forbid\",\r\n            \"icon-lines-and-angles_forebode\",\r\n            \"icon-lines-and-angles_fork\",\r\n            \"icon-lines-and-angles_format\",\r\n            \"icon-lines-and-angles_game\",\r\n            \"icon-lines-and-angles_give\",\r\n            \"icon-lines-and-angles_glance\",\r\n            \"icon-lines-and-angles_grill\",\r\n            \"icon-lines-and-angles_grow\",\r\n            \"icon-lines-and-angles_guide\",\r\n            \"icon-lines-and-angles_hang\",\r\n            \"icon-lines-and-angles_harvest\",\r\n            \"icon-lines-and-angles_haunt\",\r\n            \"icon-lines-and-angles_heal\",\r\n            \"icon-lines-and-angles_hear\",\r\n            \"icon-lines-and-angles_hide\",\r\n            \"icon-lines-and-angles_hold\",\r\n            \"icon-lines-and-angles_home\",\r\n            \"icon-lines-and-angles_identify\",\r\n            \"icon-lines-and-angles_imagine\",\r\n            \"icon-lines-and-angles_influence\",\r\n            \"icon-lines-and-angles_inject\",\r\n            \"icon-lines-and-angles_invade\",\r\n            \"icon-lines-and-angles_iron\",\r\n            \"icon-lines-and-angles_jam\",\r\n            \"icon-lines-and-angles_join\",\r\n            \"icon-lines-and-angles_judge\",\r\n            \"icon-lines-and-angles_keep\",\r\n            \"icon-lines-and-angles_kick\",\r\n            \"icon-lines-and-angles_pitch\",\r\n            \"icon-lines-and-angles_plan\",\r\n            \"icon-lines-and-angles_plant\",\r\n            \"icon-lines-and-angles_play\",\r\n            \"icon-lines-and-angles_push\",\r\n            \"icon-lines-and-angles_rain\",\r\n            \"icon-lines-and-angles_read\",\r\n            \"icon-lines-and-angles_record\",\r\n            \"icon-lines-and-angles_redo\",\r\n            \"icon-lines-and-angles_reheat\",\r\n            \"icon-lines-and-angles_remind\",\r\n            \"icon-lines-and-angles_repeat\",\r\n            \"icon-lines-and-angles_report\",\r\n            \"icon-lines-and-angles_resurrect\",\r\n            \"icon-lines-and-angles_rewind\",\r\n            \"icon-lines-and-angles_ride\",\r\n            \"icon-lines-and-angles_ring\",\r\n            \"icon-lines-and-angles_rise\",\r\n            \"icon-lines-and-angles_rock\",\r\n            \"icon-lines-and-angles_roll\",\r\n            \"icon-lines-and-angles_rule\",\r\n            \"icon-lines-and-angles_run\",\r\n            \"icon-lines-and-angles_save\",\r\n            \"icon-lines-and-angles_schedule\",\r\n            \"icon-lines-and-angles_screw\",\r\n            \"icon-lines-and-angles_scroll\",\r\n            \"icon-lines-and-angles_search\",\r\n            \"icon-lines-and-angles_see\",\r\n            \"icon-lines-and-angles_select\",\r\n            \"icon-lines-and-angles_sell\",\r\n            \"icon-lines-and-angles_send\",\r\n            \"icon-lines-and-angles_sew\",\r\n            \"icon-lines-and-angles_shade\",\r\n            \"icon-lines-and-angles_shake\",\r\n            \"icon-lines-and-angles_share\",\r\n            \"icon-lines-and-angles_shine\",\r\n            \"icon-lines-and-angles_shop\",\r\n            \"icon-lines-and-angles_shower\",\r\n            \"icon-lines-and-angles_shuffle\",\r\n            \"icon-lines-and-angles_sing\",\r\n            \"icon-lines-and-angles_sit\",\r\n            \"icon-lines-and-angles_skip\",\r\n            \"icon-lines-and-angles_sleep\",\r\n            \"icon-lines-and-angles_slice\",\r\n            \"icon-lines-and-angles_slide\",\r\n            \"icon-lines-and-angles_smell\",\r\n            \"icon-lines-and-angles_smuggle\",\r\n            \"icon-lines-and-angles_snow\",\r\n            \"icon-lines-and-angles_solve\",\r\n            \"icon-lines-and-angles_sound\",\r\n            \"icon-lines-and-angles_sparkle\",\r\n            \"icon-lines-and-angles_speak\",\r\n            \"icon-lines-and-angles_spin\",\r\n            \"icon-lines-and-angles_spy\",\r\n            \"icon-lines-and-angles_stack\",\r\n            \"icon-lines-and-angles_stamp\",\r\n            \"icon-lines-and-angles_steam\",\r\n            \"icon-lines-and-angles_stomp\",\r\n            \"icon-lines-and-angles_stop\",\r\n            \"icon-lines-and-angles_strum\",\r\n            \"icon-lines-and-angles_study\",\r\n            \"icon-lines-and-angles_submerge\",\r\n            \"icon-lines-and-angles_succeed\",\r\n            \"icon-lines-and-angles_sweep\",\r\n            \"icon-lines-and-angles_swim\",\r\n            \"icon-lines-and-angles_sync\",\r\n            \"icon-lines-and-angles_tag\",\r\n            \"icon-lines-and-angles_target\",\r\n            \"icon-lines-and-angles_teach\",\r\n            \"icon-lines-and-angles_think\",\r\n            \"icon-lines-and-angles_thunder\",\r\n            \"icon-lines-and-angles_tie\",\r\n            \"icon-lines-and-angles_tower\",\r\n            \"icon-lines-and-angles_transport\",\r\n            \"icon-lines-and-angles_trash\",\r\n            \"icon-lines-and-angles_travel\",\r\n            \"icon-lines-and-angles_trend\",\r\n            \"icon-lines-and-angles_turn\",\r\n            \"icon-lines-and-angles_type\",\r\n            \"icon-lines-and-angles_undo\",\r\n            \"icon-lines-and-angles_unlock\",\r\n            \"icon-lines-and-angles_upload\",\r\n            \"icon-lines-and-angles_use\",\r\n            \"icon-lines-and-angles_wait\",\r\n            \"icon-lines-and-angles_wash\",\r\n            \"icon-lines-and-angles_watch\",\r\n            \"icon-lines-and-angles_wear\",\r\n            \"icon-lines-and-angles_weigh\",\r\n            \"icon-lines-and-angles_win\",\r\n            \"icon-lines-and-angles_work\",\r\n            \"icon-lines-and-angles_worship\",\r\n            \"icon-lines-and-angles_write\",\r\n            \"icon-lines-and-angles_yell\",\r\n            \"icon-lines-and-angles_clip\",\r\n            \"icon-lines-and-angles_close\",\r\n            \"icon-lines-and-angles_code\",\r\n            \"icon-lines-and-angles_collect\",\r\n            \"icon-lines-and-angles_commit\",\r\n            \"icon-lines-and-angles_connect\",\r\n            \"icon-lines-and-angles_contact\",\r\n            \"icon-lines-and-angles_contain\",\r\n            \"icon-lines-and-angles_control\",\r\n            \"icon-lines-and-angles_cook\",\r\n            \"icon-lines-and-angles_cool\",\r\n            \"icon-lines-and-angles_copy\",\r\n            \"icon-lines-and-angles_crave\",\r\n            \"icon-lines-and-angles_create\",\r\n            \"icon-lines-and-angles_creep\",\r\n            \"icon-lines-and-angles_crop\",\r\n            \"icon-lines-and-angles_cry\",\r\n            \"icon-lines-and-angles_curdle\",\r\n            \"icon-lines-and-angles_cut\",\r\n            \"icon-lines-and-angles_dance\",\r\n            \"icon-lines-and-angles_dazzle\",\r\n            \"icon-lines-and-angles_decide\",\r\n            \"icon-lines-and-angles_defend\",\r\n            \"icon-lines-and-angles_deliver\",\r\n            \"icon-lines-and-angles_design\",\r\n            \"icon-lines-and-angles_destroy\",\r\n            \"icon-lines-and-angles_develop\",\r\n            \"icon-lines-and-angles_die\",\r\n            \"icon-lines-and-angles_disappear\",\r\n            \"icon-lines-and-angles_discard\",\r\n            \"icon-lines-and-angles_discover\",\r\n            \"icon-lines-and-angles_disguise\",\r\n            \"icon-lines-and-angles_divide\",\r\n            \"icon-lines-and-angles_download\",\r\n            \"icon-lines-and-angles_draw\",\r\n            \"icon-lines-and-angles_drill\",\r\n            \"icon-lines-and-angles_drink\",\r\n            \"icon-lines-and-angles_drive\",\r\n            \"icon-lines-and-angles_drop\",\r\n            \"icon-lines-and-angles_kiss\",\r\n            \"icon-lines-and-angles_launch\",\r\n            \"icon-lines-and-angles_lick\",\r\n            \"icon-lines-and-angles_lift\",\r\n            \"icon-lines-and-angles_light\",\r\n            \"icon-lines-and-angles_like\",\r\n            \"icon-lines-and-angles_link\",\r\n            \"icon-lines-and-angles_live\",\r\n            \"icon-lines-and-angles_load\",\r\n            \"icon-lines-and-angles_locate\",\r\n            \"icon-lines-and-angles_lock\",\r\n            \"icon-lines-and-angles_madho\",\r\n            \"icon-lines-and-angles_manufacture\",\r\n            \"icon-lines-and-angles_mark\",\r\n            \"icon-lines-and-angles_measure\",\r\n            \"icon-lines-and-angles_medicate\",\r\n            \"icon-lines-and-angles_melt\",\r\n            \"icon-lines-and-angles_merge\",\r\n            \"icon-lines-and-angles_mill\",\r\n            \"icon-lines-and-angles_move\",\r\n            \"icon-lines-and-angles_multiply\",\r\n            \"icon-lines-and-angles_mute\",\r\n            \"icon-lines-and-angles_navigate\",\r\n            \"icon-lines-and-angles_open\",\r\n            \"icon-lines-and-angles_pack\",\r\n            \"icon-lines-and-angles_paint\",\r\n            \"icon-lines-and-angles_park\",\r\n            \"icon-lines-and-angles_paste\",\r\n            \"icon-lines-and-angles_pause\",\r\n            \"icon-lines-and-angles_pay\",\r\n            \"icon-lines-and-angles_perform\",\r\n            \"icon-lines-and-angles_photograph\",\r\n            \"icon-lines-and-angles_pick\",\r\n            \"icon-lines-and-angles_pin\",\r\n            \"icon-lines-and-angles_plot\",\r\n            \"icon-lines-and-angles_point\",\r\n            \"icon-lines-and-angles_poison\",\r\n            \"icon-lines-and-angles_present\",\r\n            \"icon-lines-and-angles_press\",\r\n            \"icon-lines-and-angles_primp\",\r\n            \"icon-lines-and-angles_print\",\r\n            \"icon-lines-and-angles_pucker\"\r\n            ]\r\n    }\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, makeSafeClass, countLines } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { createRevealTimer } from 'termInteraction';\r\n\r\n// Exports\r\nexport { viewCreate, addHearts, goalMeters, setScore, progressBar };\r\n\r\n// Create app view\r\nconst viewCreate = function viewCreate(termsToCreate) {\r\n\r\n    let viewHTML = \"\";\r\n\r\n    // Create HTML for terms\r\n    for (let value of termsToCreate) {\r\n\r\n        // Get terms and definitions from data\r\n        let termValue = tinyTerms[tinyTerms.pickedList].terms[value].term;\r\n        let definitionValue = tinyTerms[tinyTerms.pickedList].terms[value].definition;\r\n        let supportValue = tinyTerms[tinyTerms.pickedList].terms[value].support;\r\n        let termEncode = makeSafeClass(termValue);\r\n        let revealCounter;\r\n        let viewsCount;\r\n\r\n        // Check storage for revealed count\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealGoal = tinyTerms[tinyTerms.pickedList].storedData.revealGoal || {};\r\n\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[termValue] === undefined) {\r\n            viewsCount = 0;\r\n        }\r\n        else {\r\n            viewsCount = (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[termValue]) || 0;\r\n        }\r\n\r\n        // Star background\r\n        if (tinyTerms.globalUnlocks.bgStars.active === 'unlocked') {\r\n            document.querySelector('body').classList.add('stars');\r\n        }\r\n\r\n        // Letters background\r\n        if (tinyTerms.globalUnlocks.bgLetters.active === 'unlocked') {\r\n            document.querySelector('body').classList.add('letters');\r\n        }\r\n\r\n        document.querySelector('h1').innerHTML = tinyTerms.pickedList;\r\n        document.querySelector('.list-action').innerHTML = tinyTerms[tinyTerms.pickedList].action + '<span class=\"query-holder\">'+tinyTerms[tinyTerms.pickedList].storedData.dailyQuery+'</span>';\r\n\r\n        let particles = \"\";\r\n\r\n        for (let j = 0; j < 50; j++) {\r\n            particles += '<div class=\"particle\">&#9733;</div>';\r\n        }\r\n\r\n        // Create terms HTML\r\n        let newHolder =\r\n            `<div class=\"m-term-wrapper ${termEncode}\">\r\n                <p class=\"term-holder\">${termValue}</p>\r\n                <div class=\"theme-holder\"><p class=\"symbol-holder\"></p></div>\r\n                <div class=\"explosion\">\r\n                    ${particles}\r\n                </div>\r\n                <div class=\"right\">\r\n                    <p class=\"term-views\"><span>Goal:</span> <span class=\"count\">${viewsCount}</span> / ${tinyTerms[tinyTerms.pickedList].ops.revealGoalTarget}</p>\r\n                    <div class=\"goal-indicators\">\r\n                        <span></span>\r\n                        <span></span>\r\n                        <span></span>\r\n                    </div>\r\n                    <button class=\"reveal\">Reveal</button>\r\n                </div>\r\n                <div class=\"definition-wrapper hidden\">\r\n                    <p class=\"definition-holder\">${definitionValue}</p>\r\n                    <div class=\"helpers\">\r\n                        <a href=\"#\" class=\"lookup\"></a>\r\n                        <a href=\"#\" class=\"colour\"></a>\r\n                        <a href=\"#\" class=\"symbol\"></a>\r\n                    </div>\r\n                    <div class=\"support-wrapper\">${supportValue}</div>\r\n                </div>\r\n            </div>`;\r\n\r\n        viewHTML += newHolder;\r\n    }\r\n    // Add to view\r\n    document.querySelector('.terms-wrapper').innerHTML = viewHTML;\r\n    \r\n    // Style terms based on number of lines\r\n    let termHolders = document.querySelectorAll('.term-holder');\r\n\r\n    for (let i = 0; i < termHolders.length; i++) {\r\n        termHolders[i].style.minHeight = '0px';\r\n        termHolders[i].classList.add('lines-'+countLines(termHolders[i]));\r\n        termHolders[i].style.minHeight = '101px';\r\n    }\r\n\r\n    // Add theme to previously created terms\r\n    for (let value of termsToCreate) {\r\n        let termValue = tinyTerms[tinyTerms.pickedList].terms[value].term;\r\n        let termEncode = makeSafeClass(termValue);\r\n\r\n        // Check storage for assigned colour\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue] !== undefined && tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].colour !== undefined) {\r\n            let termWrapper = document.querySelector('.' + termEncode + '');\r\n            let pickedColour = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].colour;\r\n            // Add colour to object\r\n            termWrapper.querySelector('.theme-holder').style.background = pickedColour;\r\n            \r\n            if (pickedColour !== \"#fff\") {\r\n                termWrapper.querySelector('.term-holder').style.color = \"#fff\";\r\n                termWrapper.classList.add('bg-active');\r\n            }\r\n            \r\n        }\r\n        // Check storage for assigned symbol\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue] !== undefined && tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].symbol !== undefined) {\r\n            let termWrapper = document.querySelector('.' + termEncode + '');\r\n            let pickedSymbol = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].symbol;\r\n            // Add symbol to object\r\n            termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n            termWrapper.querySelector('.symbol-holder').classList.add(pickedSymbol);\r\n        }\r\n    }\r\n\r\n    // Add countdown timers to term buttons\r\n    for (let value of termsToCreate) {\r\n\r\n        // Check if timer data exists\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns !== undefined) {\r\n\r\n            // Add countdown timers to buttons\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[value] !== undefined) {\r\n\r\n                let revealBtn = document.querySelectorAll('.reveal');\r\n\r\n                // Find button node that matches term in DOM\r\n                for (let i = 0; i < revealBtn.length; i++) {\r\n                    let revealTerm = revealBtn[i].parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n                    if (revealTerm === value) {\r\n                        createRevealTimer(revealBtn[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Add hearts to page\r\nconst addHearts = function addHearts() {\r\n    let heartHolder = document.querySelector('.hearts');\r\n    let heartsHTML = \"\";\r\n\r\n    // If no hearts data exists\r\n    if (tinyTerms[tinyTerms.pickedList].storedData.hearts === undefined) {\r\n        tinyTerms[tinyTerms.pickedList].storedData.hearts = tinyTerms[tinyTerms.pickedList].ops.points.hearts;\r\n    }\r\n    for (let i = 0; i < tinyTerms[tinyTerms.pickedList].storedData.hearts; i++) {\r\n        heartsHTML += '<p></p>';\r\n    }\r\n    // Add to view\r\n    heartHolder.innerHTML = heartsHTML;\r\n\r\n    // Add to storage\r\n    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n}\r\n\r\n// Fill goal meters\r\nconst goalMeters = function goalMeters() {\r\n    let termWrappers = document.querySelectorAll('.m-term-wrapper');\r\n\r\n    for (let i = 0; i < termWrappers.length; i++) {\r\n        let goalCount = termWrappers[i].querySelector('.count').innerHTML;\r\n        goalCount = parseInt(goalCount);\r\n\r\n        for (let j = 0; j < goalCount; j++) {\r\n\r\n            if (j < 3) {\r\n                termWrappers[i].querySelector('.goal-indicators').getElementsByTagName('span')[j].classList.add('filled');\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Sets the score\r\nconst setScore = function setScore() {\r\n\r\n    // Add to storage\r\n    localforage.getItem('tinyTerms.score', (err, savedScore) => {\r\n\r\n        // Set score if it doesn't exist\r\n        if (savedScore === null) {\r\n            tinyTerms.score = 0;\r\n\r\n            // Add to storage\r\n            localforage.setItem('tinyTerms.score', score);\r\n        }\r\n        else {\r\n            tinyTerms.score = savedScore;\r\n        }\r\n\r\n        let score = tinyTerms.score;\r\n\r\n        // Add to view\r\n        document.querySelector('.score-holder').innerHTML = score;\r\n    });\r\n}\r\n\r\n// Add progress bar\r\nconst progressBar = function progressBar() {\r\n    // Create correct terms default\r\n    tinyTerms[tinyTerms.pickedList].storedData.learnedTerms = tinyTerms[tinyTerms.pickedList].storedData.learnedTerms || {};\r\n    let completed = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms).length;\r\n    let remaining = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length;\r\n\r\n    // Add to DOM\r\n    document.querySelector('.m-progress-bar').querySelector('.completed').innerHTML = completed;\r\n    document.querySelector('.m-progress-bar').querySelector('.remaining').innerHTML = ' / ' + remaining;\r\n    document.querySelector('.m-progress-bar').querySelector('.progress-bg').style.width = ((completed / remaining) * 100) + \"%\";\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, pickRandom, checkQuery, makeSafeClass } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { addHearts } from 'viewCreation';\r\n\r\n// Exports\r\nexport { createNewQuery };\r\n\r\n// Sets up query\r\nconst createNewQuery = function createNewQuery(bonus) {\r\n\r\n    // Pick a term for query\r\n    let randomTerm;\r\n    let i = 0;\r\n\r\n    // If no stored data for reveal countdowns\r\n    tinyTerms[tinyTerms.pickedList].storedData.queryTerms = tinyTerms[tinyTerms.pickedList].storedData.queryTerms || {};\r\n\r\n    // Set correctTerms storage if not exists\r\n    tinyTerms[tinyTerms.pickedList].storedData.correctTerms = tinyTerms[tinyTerms.pickedList].storedData.correctTerms || {};\r\n\r\n    // Set incorrectTerms storage if not exists\r\n    tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms = tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms || {};\r\n\r\n    let cycledTerms = [];\r\n    // Choose term from viewed terms\r\n    while (i < Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length) {\r\n\r\n        // If no daily term\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.dailyQuery === undefined) {\r\n            // Pick a random term\r\n            randomTerm = pickRandom(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms);\r\n        }\r\n        else {\r\n            randomTerm = tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n        }\r\n        // Make sure not answered correctly before\r\n        if (!tinyTerms[tinyTerms.pickedList].storedData.correctTerms.hasOwnProperty(randomTerm)) {\r\n\r\n            // If query not from daily reminder term\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder !== undefined) {\r\n                if (!tinyTerms[tinyTerms.pickedList].storedData.dailyReminder.hasOwnProperty(randomTerm)) {\r\n                    queryHandler();\r\n                    break;\r\n                }\r\n            }\r\n            // If query not from daily terms\r\n            else if (!tinyTerms[tinyTerms.pickedList].storedData.dailyTerms.hasOwnProperty(randomTerm)) {\r\n                queryHandler();\r\n                break;\r\n            }\r\n        }\r\n        if (cycledTerms.indexOf(randomTerm)) {\r\n            i++\r\n        }\r\n        // Else look for another\r\n        if (i === Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length) {\r\n\r\n            let queryWrapper = document.querySelector('.query-wrapper');\r\n\r\n            // Show the query wrapper\r\n            queryWrapper.querySelector('.list-action').classList.add('hidden');\r\n            queryWrapper.querySelector('.query-form').classList.add('hidden');\r\n            queryWrapper.querySelector('.m-query').innerHTML += \"<p>Reveal more terms to get a daily test!</p><br>\";\r\n            queryWrapper.classList.remove('hidden');\r\n        }\r\n    }\r\n\r\n    // Build the query\r\n    function queryHandler() {\r\n        let queryWrapper = document.querySelector('.query-wrapper');\r\n        let querySubmit = document.querySelector('.query-submit');\r\n        let resultHolder = document.querySelector('.result-holder');\r\n        let scoreHolder = document.querySelector('.score-holder');\r\n        let heartHolder = document.querySelector('.hearts');\r\n        let definition = tinyTerms[tinyTerms.pickedList].terms[randomTerm].definition;\r\n        let count = 0;\r\n\r\n        // Save to storage\r\n        tinyTerms[tinyTerms.pickedList].storedData.dailyQuery = randomTerm;\r\n        tinyTerms[tinyTerms.pickedList].storedData.queryComplete = false;\r\n\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        let termEncode = makeSafeClass(randomTerm);\r\n\r\n        // Hide daily term definition if same\r\n        if (document.querySelector('.' + termEncode + '') !== null) {\r\n            document.querySelector('.' + termEncode + '').querySelector('.definition-wrapper').classList.add('hidden');\r\n        }\r\n\r\n        // Add to view\r\n        document.querySelector('.query-holder').innerHTML = randomTerm;\r\n\r\n        // Add hearts\r\n        addHearts();\r\n\r\n        // Show the query wrapper\r\n        queryWrapper.classList.remove('hidden');\r\n\r\n        // Change title if bonus\r\n        if (bonus) {\r\n            queryWrapper.getElementsByTagName('h2')[0].innerHTML = \"Bonus Test\";\r\n        }\r\n\r\n        window.addEventListener(\"keypress\", function (e) {\r\n            if (e.keyCode === 13) {\r\n                querySubmit.click();\r\n            }\r\n        });\r\n\r\n        // Query outcomes\r\n        querySubmit.addEventListener(\"click\", (e) => {\r\n            e.preventDefault();\r\n            let queryInput = document.querySelector('.query-input').value;\r\n\r\n            queryInput = queryInput.trim();\r\n\r\n            if (checkQuery(queryInput, definition) === true) {\r\n                winCase();\r\n            }\r\n            else if (checkQuery(queryInput, definition) === \"mispelled\") {\r\n                winCase(\"mispelled\", queryInput);\r\n            }\r\n            else if (queryInput === \"\") {\r\n                document.querySelector('.query-input').style.border = \"1px solid #ff0000\";\r\n                resultHolder.innerHTML = \"Please enter a definition.\";\r\n                resultHolder.classList.remove('hidden');\r\n            }\r\n            else {\r\n                loseCase();\r\n            }\r\n        });\r\n\r\n        // If definition is right\r\n        function winCase(spelling, input) {\r\n            // Hide the query input\r\n            document.querySelector('.query-form').classList.add('hidden');\r\n            heartHolder.classList.add('hidden');\r\n\r\n            // If mispelled\r\n            if (spelling === \"mispelled\") {\r\n                // Display win message\r\n                resultHolder.innerHTML = \"Well done but check your spelling (\" + input + \"), the definition is <strong>\\\"\" + definition + \"\\\"</strong>\";\r\n                resultHolder.classList.remove('hidden','wrong');\r\n                resultHolder.classList.add('right');\r\n            }\r\n            else {\r\n                // Display win message\r\n                resultHolder.innerHTML = \"Well done, the definition is <strong>\\\"\" + definition + \"\\\"</strong>\";\r\n                resultHolder.classList.remove('hidden','wrong');\r\n                resultHolder.classList.add('right');\r\n            }\r\n            \r\n            // Add to score\r\n            let score = tinyTerms.score;\r\n            score += tinyTerms[tinyTerms.pickedList].ops.points.correct;\r\n\r\n            // Update view\r\n            scoreHolder.innerHTML = score;\r\n\r\n            // Add to stored data\r\n            tinyTerms.score = score;\r\n\r\n             // Save to storage\r\n            localforage.setItem('tinyTerms.score', score, () => {\r\n                tinyTerms[tinyTerms.pickedList].storedData.correctTerms[randomTerm] = definition;\r\n                tinyTerms[tinyTerms.pickedList].storedData.queryComplete = true;\r\n                delete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n\r\n                // Save to storage\r\n                localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            });    \r\n        }\r\n        // If definition is wrong\r\n        function loseCase() {\r\n            let queryInput = document.querySelector('.query-input');\r\n            queryInput.style.border = \"1px solid #ccc\";\r\n            \r\n            // Add placeholder\r\n            queryInput.placeholder = queryInput.value;\r\n\r\n            // Remove guess\r\n            queryInput.value = \"\";\r\n\r\n            // Update view\r\n            resultHolder.innerHTML = \"Try again.\";\r\n            resultHolder.classList.remove('hidden','wrong');\r\n            resultHolder.classList.add('wrong');\r\n\r\n            // Lose a heart\r\n            heartHolder.removeChild(heartHolder.getElementsByTagName('p')[0]);\r\n            tinyTerms[tinyTerms.pickedList].storedData.hearts = tinyTerms[tinyTerms.pickedList].storedData.hearts - 1;\r\n\r\n            // If all hearts lost\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.hearts === 0) {\r\n                // Hide query \r\n                document.querySelector('.query-form').classList.add('hidden');\r\n                heartHolder.classList.add('hidden');\r\n\r\n                // Update DOM\r\n                queryInput.value = \"\";\r\n                queryInput.placeholder = \"Enter the definition\";\r\n\r\n                // Update view\r\n                resultHolder.innerHTML = \"Sorry, you are out of attempts!\";\r\n                resultHolder.classList.remove('hidden','wrong','right');\r\n                resultHolder.classList.add('lost');\r\n\r\n                // Add to storedDatta \r\n                tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms[randomTerm] = definition;\r\n                tinyTerms[tinyTerms.pickedList].storedData.queryComplete = true;\r\n                delete tinyTerms[tinyTerms.pickedList].storedData.hearts;\r\n            }\r\n            // Save to storage\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n        }\r\n    }\r\n}","\r\n// Imports\r\nimport { cl, clv, clickListener, alertMsg, jsonp, findKeys, findOneKey, makeSafeClass } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { createNewQuery } from 'queryInteraction';\r\nimport { setScore, addHearts, progressBar, goalMeters } from 'viewCreation';\r\n\r\n// Exports\r\nexport { revealedBtnHandler, createRevealTimer, dictionaryLookup, textToSpeech, addColour, hideModal, pickSymbol };\r\n\r\n// Handles functions when reveal button clicked\r\nconst revealedBtnHandler = function revealedBtnHandler() {\r\n\r\n    let revealBtn = document.querySelectorAll('.reveal');\r\n\r\n    clickListener(revealBtn, (i) => {\r\n\r\n        // Disabled button prevention\r\n        if (revealBtn[i].classList.contains('disabled')) {\r\n            return false;\r\n        }\r\n\r\n        // Explode!!\r\n        let explode = revealBtn[i].parentNode.parentNode.querySelector('.explosion');\r\n\r\n        explode.classList.add('explode');\r\n\r\n        setTimeout(() => explode.classList.remove('explode'), 1000);\r\n\r\n        let term = [revealBtn[i].parentNode.parentNode.querySelector('.term-holder').innerHTML];\r\n\r\n        // Updates the revealed view counter\r\n        let countHolder = revealBtn[i].parentNode.querySelector('.count');\r\n        let definitionWrapper = revealBtn[i].parentNode.parentNode.querySelector('.definition-wrapper');\r\n        let definitionHolder = revealBtn[i].parentNode.parentNode.querySelector('.definition-holder');\r\n        let count = parseInt(countHolder.innerHTML);\r\n\r\n        // Show definition\r\n        definitionWrapper.classList.remove('hidden');\r\n\r\n        // Animations\r\n        definitionWrapper.classList.add('slideInUp', 'animated');\r\n        revealBtn[i].parentNode.classList.add('rubberBand', 'animated');\r\n\r\n        // Set storedData\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term] = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term] || {};\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount || 0;\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount += 1;\r\n\r\n        // Daily reveal bonus\r\n        let revealGoalCount;\r\n\r\n        // If no existing term bonus\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] === undefined) {\r\n            revealGoalCount = 1;\r\n        }\r\n\r\n        // Add one to daily bonus\r\n        else {\r\n            revealGoalCount = tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term];\r\n            revealGoalCount += 1;\r\n        }\r\n\r\n        // Update DOM\r\n        countHolder.innerHTML = revealGoalCount;\r\n\r\n        // Add to goal meter\r\n        goalMeters();\r\n\r\n        // If bonus is met\r\n        if (revealGoalCount === tinyTerms[tinyTerms.pickedList].ops.revealGoalTarget) {\r\n\r\n            // Add term to learned terms list\r\n            tinyTerms[tinyTerms.pickedList].storedData.learnedTerms = tinyTerms[tinyTerms.pickedList].storedData.learnedTerms || {};\r\n            tinyTerms[tinyTerms.pickedList].storedData.learnedTerms[term] = tinyTerms[tinyTerms.pickedList].terms[term].definition;\r\n\r\n            // Check if whole term list answered correctly\r\n            if (Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms).length === Object.keys(tinyTerms[tinyTerms.pickedList].terms).length) {\r\n                tinyTerms[tinyTerms.pickedList].storedData.gameWon = true;\r\n                gameWon();\r\n            }\r\n\r\n            // If game won\r\n            function gameWon() {\r\n                let modal = document.querySelector('.m-modal');\r\n\r\n                // Bring up modal\r\n                modal.classList.remove('hidden');\r\n                document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n                let view = `<header>\r\n                                <h2 class=\"\">Whoop whoop!!</h2>\r\n                            </header>\r\n                            <p>Well done you completed the whole list! You get a bonus 10 points for each term learned.</p>\r\n                            <p>You can keep learning this list, reset it in the options to start from scratch or move on to\r\n                            learn something new entirely.</p>\r\n                            <p><strong>Great job!</strong></p>`;\r\n\r\n                // Add view\r\n                modal.querySelector('.content').innerHTML += view;\r\n\r\n                // Award bonus points\r\n                let completeBonus = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length * tinyTerms[tinyTerms.pickedList].ops.points.winBonus;\r\n\r\n                // Add to score\r\n                let score = tinyTerms.score;\r\n                score += completeBonus;\r\n                // Update view\r\n                scoreHolder.innerHTML = score;\r\n                // Add to stored data\r\n                tinyTerms.score = score;\r\n                // Save to storage\r\n                localforage.setItem('tinyTerms.score', score);\r\n            }\r\n\r\n            // Update progress bar\r\n            progressBar();\r\n\r\n            // If daily bonus not already triggered\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete === false) {\r\n\r\n                // Keep query active \r\n                tinyTerms[tinyTerms.pickedList].storedData.queryComplete = false;\r\n\r\n                // Delete hearts\r\n                delete tinyTerms[tinyTerms.pickedList].storedData.hearts;\r\n\r\n                // Create a new query\r\n                createNewQuery(true);\r\n            }\r\n            // Set only once a day\r\n            tinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete = true;\r\n\r\n            // Add to score\r\n            let score = tinyTerms.score;\r\n            score += tinyTerms[tinyTerms.pickedList].ops.points.dailyBonus;\r\n            // Update view\r\n            document.querySelector('.score-holder').innerHTML = score;\r\n            // Add to stored data\r\n            tinyTerms.score = score;\r\n            // Save to storage\r\n            localforage.setItem('tinyTerms.score', score);\r\n        }\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] = revealGoalCount;\r\n\r\n        // Save to storage\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        // Starts a timer \r\n        createRevealTimer(revealBtn[i]);\r\n    });\r\n}\r\n\r\n// Adds a timer to the reveal button\r\nconst createRevealTimer = function createRevealTimer(revealBtn) {\r\n\r\n    // If no stored data for reveal countdowns\r\n    tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns || {};\r\n\r\n    let term = [revealBtn.parentNode.parentNode.querySelector('.term-holder').innerHTML];\r\n    let minutes = tinyTerms[tinyTerms.pickedList].ops.counterMins;\r\n    let seconds = tinyTerms[tinyTerms.pickedList].ops.counterSecs;\r\n    let remainingMinutes;\r\n    let remainingSeconds;\r\n    let startTime;\r\n    let timerEnded;\r\n\r\n    // New timer\r\n    if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term] === undefined) {\r\n\r\n        // Get a new time\r\n        startTime = new Date().getTime();\r\n\r\n        // Set storedData\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term] = {\r\n            \"startTime\": startTime,\r\n            \"timerEnded\": false\r\n        };\r\n\r\n        // Start timer\r\n        startTimer();\r\n    }\r\n    // Existing timer\r\n    else {\r\n        // Start timer\r\n        startTimer();\r\n    }\r\n\r\n    function startTimer() {\r\n        let nowTime = new Date().getTime();\r\n\r\n        // Disable button\r\n        revealBtn.classList.add('disabled');\r\n        revealBtn.setAttribute(\"disabled\", true);\r\n\r\n        // Get terms start time for countdown\r\n        startTime = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].startTime;\r\n        timerEnded = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerEnded;\r\n\r\n        // Get difference in seconds\r\n        let diffSecs = Math.floor((nowTime - startTime) / 1000);\r\n        // Get total in seconds\r\n        let totalSecs = (tinyTerms[tinyTerms.pickedList].ops.counterMins * 60) + seconds;\r\n\r\n        // NowTime overtaken startTime\r\n        if (diffSecs >= totalSecs) {\r\n            timerEnded = true;\r\n            // Stop interval\r\n            clearInterval(tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerUpdate);\r\n            // Clear storage for term timer\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term];\r\n        }\r\n        // Timer stopped, return to normal\r\n        if (timerEnded === true) {\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            return false;\r\n        }\r\n        // Set remaining time \r\n        remainingSeconds = totalSecs - diffSecs;\r\n    }\r\n\r\n    // Set start time to storage\r\n    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n    let timeout;\r\n    let checkCount = 0;\r\n\r\n    // If timer is active   \r\n    if (timerEnded === false) {\r\n\r\n        // Start timer interval\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerUpdate = setInterval(() => {\r\n            // Resync timer in some devices when off screen\r\n            checkCount += 1;\r\n            if (checkCount % 5 === 0) {\r\n                startTimer();\r\n            }\r\n            // Call UI timer build\r\n            buttonTimer();\r\n        }, 1000)\r\n    }\r\n    else {\r\n        revealBtn.innerHTML = (\"Reveal\");\r\n        revealBtn.classList.remove('disabled');\r\n        revealBtn.disabled = false;\r\n    }\r\n\r\n    // Builds the timer\r\n    function buttonTimer() {\r\n        let displayedMinutes = Math.floor(remainingSeconds / 60);\r\n        let displayedSeconds = remainingSeconds % 60;\r\n        let hiddenZero = '';\r\n\r\n        // Timer end\r\n        if (remainingSeconds <= 0) {\r\n            revealBtn.innerHTML = (\"Reveal\");\r\n            revealBtn.classList.remove('disabled');\r\n            revealBtn.disabled = false;\r\n            return false;\r\n        }\r\n\r\n        // Handle issues like zero index\r\n        if (displayedSeconds < 10 && displayedSeconds >= 0) {\r\n            hiddenZero = '0';\r\n        }\r\n        if (remainingSeconds === 60) {\r\n            displayedSeconds = '00';\r\n        }\r\n        // Update DOM\r\n        revealBtn.innerHTML = (displayedMinutes + ':' + hiddenZero + displayedSeconds);\r\n\r\n        // Decrease timer\r\n        remainingSeconds -= 1;\r\n    }\r\n};\r\n\r\n// Allows for text to speech\r\nconst textToSpeech = function textToSpeech() {\r\n    let termHolder = document.querySelectorAll('.term-holder');\r\n\r\n    clickListener(termHolder, (i) => {\r\n\r\n        let languages = {\r\n            'German': 'de-DE',\r\n            'English': 'en-GB',\r\n            'Spanish': 'es-ES',\r\n            'French': 'fr-FR',\r\n            'Italian': 'it-IT',\r\n            'Portuguese': 'pt-BR'\r\n        }\r\n\r\n        if (typeof TTS === \"undefined\") {\r\n            let speech = new SpeechSynthesisUtterance(termHolder[i].innerHTML);\r\n            speech.lang = languages[tinyTerms[tinyTerms.pickedList].speechLang];\r\n\r\n            window.speechSynthesis.speak(speech);\r\n        }\r\n        else {\r\n            TTS\r\n                .speak({\r\n                    text: termHolder[i].innerHTML,\r\n                    locale: languages[tinyTerms[tinyTerms.pickedList].speechLang],\r\n                    rate: 1\r\n                }, function () {\r\n                }, function (reason) {\r\n                    alertMsg(reason);\r\n                });\r\n        }\r\n    });\r\n    if (tinyTerms[tinyTerms.pickedList].speechLang === \"None\") {\r\n        for (let k = 0; k < termHolder.length; k++) {\r\n            termHolder[k].classList.add('no-speak');\r\n        }\r\n    }\r\n}\r\n\r\n// Retrieves dictionary references\r\nconst dictionaryLookup = function dictionaryLookup() {\r\n\r\n    let dictionaryBtn = document.querySelectorAll('.lookup');\r\n    let modal = document.querySelector('.m-modal');\r\n\r\n    clickListener(dictionaryBtn, (i) => {\r\n        let term = dictionaryBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"dictionary\">Further study</h2>\r\n                    </header>\r\n                    <h3>Practice writing</h3>\r\n                    <textarea class=\"writing-practice\" placeholder=\"Write the definition here, alone or as part of a sentance.\"></textarea>\r\n                    <button class=\"writing-check\">Check</button>\r\n                    <h3 class=\"dotted\">Dictionary definitions</h3>\r\n                    <p>${term}:</p>\r\n                    <ul class=\"definitions\"></ul>\r\n                    <h3 class=\"dotted\">Wiki info</h3>\r\n                    <ul class=\"wiki-link-wrapper\"></ul>\r\n                    <div class=\"wiki-result\"></div>\r\n                    `;\r\n\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        // Check practice writing\r\n        document.querySelector('.writing-check').addEventListener('click',(e) => {\r\n            e.preventDefault();\r\n            let practiceContent = document.querySelector('.writing-practice').value.toUpperCase();\r\n            let definition = tinyTerms[tinyTerms.pickedList].terms[term].definition.toUpperCase();\r\n\r\n            if (practiceContent.indexOf(definition) > -1) {\r\n                document.querySelector('.writing-practice').value = \"\";\r\n                document.querySelector('.writing-practice').placeholder = \"Well done, that's correct!\"; \r\n            }\r\n            else {\r\n                document.querySelector('.writing-practice').value = \"\";\r\n                document.querySelector('.writing-practice').placeholder = \"That's incorrect, try again.\";\r\n            }\r\n        });\r\n\r\n        // Make JSONP call to Glosbe API\r\n        let definitionHolder = modal.querySelector('.definitions');\r\n        let dictionaryLookup = encodeURI('https://glosbe.com/gapi/translate?from=' + tinyTerms[tinyTerms.pickedList]\r\n            .dictFrom + '&dest=' + tinyTerms[tinyTerms.pickedList]\r\n                .dictTo + '&format=json&pretty=true&phrase=' + term.toLowerCase() + '');\r\n\r\n        // Make request to Glosbe\r\n        jsonp(dictionaryLookup)\r\n            .then(function (data) {\r\n                let dictionaryResponses = \"\";\r\n\r\n                try {\r\n                    // Search through data for \"meanings\"\r\n                    findProp(data, \"text\");\r\n\r\n                    function findProp(obj, key, out) {\r\n                        let i;\r\n                        let proto = Object.prototype;\r\n                        let ts = proto.toString;\r\n                        let hasOwn = proto.hasOwnProperty.bind(obj);\r\n\r\n                        for (i in obj) {\r\n                            if (hasOwn(i)) {\r\n                                if (i === key) {\r\n                                    dictionaryResponses += '<li>' + obj[i] + '</li>';\r\n                                } else if ('[object Array]' === ts.call(obj[i]) || '[object Object]' === ts.call(obj[i])) {\r\n                                    findProp(obj[i], key, out);\r\n                                }\r\n                            }\r\n                        }\r\n                        return out;\r\n                    }\r\n                    if (data.tuc === undefined || data.tuc.length === 0) {\r\n                        dictionaryResponses = \"(Sorry, no dictionary results found)\"\r\n                    }\r\n                    // Add to DOM\r\n                    definitionHolder.innerHTML = dictionaryResponses;\r\n                }\r\n                catch (err) {\r\n                    console.log(err);\r\n                }\r\n            });\r\n\r\n        // Wiki lookup\r\n        jsonp('https://' + tinyTerms[tinyTerms.pickedList].dictFrom + '.wikipedia.org/w/api.php?action=opensearch&limit=3&namespace=0&format=json&search=' + term).then(function (data) {\r\n\r\n            // List out wiki results\r\n            for (let i = 0; i < 3; i++) {\r\n\r\n                if (data[1][i] !== undefined) {\r\n                    document.querySelector('.wiki-link-wrapper').innerHTML += '<li><a href=\"#\" class=\"wiki-link\">' + data[1][i] + '</a></li>';\r\n                }\r\n            }\r\n\r\n            // List out wiki results\r\n            let wikiLink = document.querySelectorAll('.wiki-link');\r\n\r\n            wikiLink[0].classList.add('active');\r\n\r\n            // Write out the first result\r\n            let firstTerm = wikiLink[0].innerHTML;\r\n\r\n            jsonp('https://' + tinyTerms[tinyTerms.pickedList].dictFrom + '.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&redirects=true&titles=' + firstTerm).then(function (data) {\r\n\r\n                let result = Object.keys(data.query.pages)[0];\r\n                result = data.query.pages[result].extract;\r\n\r\n                if (result === undefined) { \r\n                    jsonp('https://' + tinyTerms[tinyTerms.pickedList].dictFrom + '.wikipedia.org/w/api.php?action=parse&prop=text&page=' + firstTerm).then(function (data) {\r\n                        result = JSON.parse(data.parse.text[\"*\"]);\r\n                    });\r\n                }\r\n                if (result === undefined) { \r\n                    result = \"Sorry, no info found.\";\r\n                }\r\n                document.querySelector('.wiki-result').innerHTML = result;\r\n            });\r\n\r\n            // Add event listeners for other results\r\n            for (let j = 0; j < wikiLink.length; j++) {\r\n\r\n                wikiLink[j].addEventListener('click', (e) => {\r\n                    e.preventDefault();\r\n                    let term = wikiLink[j].innerHTML;\r\n\r\n                    document.querySelector('.active').classList.remove('active');\r\n                    wikiLink[j].classList.add('active');\r\n\r\n                    jsonp('https://' + tinyTerms[tinyTerms.pickedList].dictFrom + '.wikipedia.org/w/api.php?format=json&action=query&prop=extracts&redirects=true&titles=' + term).then(function (data) {\r\n\r\n                        let result = Object.keys(data.query.pages)[0];\r\n                        result = data.query.pages[result].extract;\r\n\r\n                        if (result === undefined) { \r\n                            jsonp('https://' + tinyTerms[tinyTerms.pickedList].dictFrom + '.wikipedia.org/w/api.php?action=parse&prop=text&page=' + term).then(function (data) {\r\n                                result = JSON.parse(data.parse.text[\"*\"]);\r\n                            });\r\n                        }\r\n                        if (result === undefined) { \r\n                            result = \"Sorry, no info found.\";\r\n                        }\r\n                        document.querySelector('.wiki-result').innerHTML = result;\r\n                    });\r\n                })\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n// Adds colours to term holders\r\nconst addColour = function addColour() {\r\n\r\n    let modal = document.querySelector('.m-modal');\r\n    let colourBtn = document.querySelectorAll('.colour');\r\n    let picker;\r\n    let colours;\r\n\r\n    clickListener(colourBtn, (i) => {\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let termHolder = colourBtn[i].parentNode.parentNode.parentNode;\r\n        let term = colourBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"colour\">Colour picker</h2>\r\n                    </header>\r\n                    <p>Click below to add a colour for <br>\"<span class=\"colour-term\">${term}</span>\":</p>\r\n                    <ul class=\"colour-wrap\">\r\n                        <li><a href=\"#\" data-colour=\"#F44336\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#E91E63\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#9C27B0\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#3F51B5\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#2196F3\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#009688\"></a></li>\r\n                        <br>\r\n                        <li><a href=\"#\" data-colour=\"#4CAF50\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#CDDC39\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#FFC107\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#FF5722\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#212121\"></a></li>\r\n                        <li><a href=\"#\" class=\"no-colour\" data-colour=\"#fff\"></a></li>\r\n                    </ul>`;\r\n\r\n        let neonColours = `\r\n                           <li><a href=\"#\" data-colour=\"#FF0099\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#83F52C\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#FD1C03\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#00FFFF\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#9D00FF\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#E6FB04\"></a></li>\r\n                            `;\r\n\r\n        let metalColours = `\r\n                           <li><a href=\"#\" data-colour=\"#CC9900\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#C0C0C0\"></a></li>\r\n                           <li><a href=\"#\" data-colour=\"#CD7f32\"></a></li>\r\n                            `;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        // Unlocks\r\n        if (tinyTerms.globalUnlocks !== undefined) {\r\n\r\n            // Neon colours\r\n            if (tinyTerms.globalUnlocks.coloursNeon.active === 'unlocked') {\r\n                modal.querySelector('.colour-wrap').innerHTML += neonColours;\r\n            }\r\n\r\n            // Metal colours\r\n            if (tinyTerms.globalUnlocks.coloursMetal.active === 'unlocked') {\r\n                modal.querySelector('.colour-wrap').innerHTML += metalColours;\r\n            }\r\n        }\r\n\r\n        let coloursHolder = modal.querySelector('.colour-wrap');\r\n\r\n        // Add colour vars\r\n        colours = coloursHolder.getElementsByTagName('a');\r\n\r\n        for (let j = 0; j < colours.length; j++) {\r\n            colours[j].style.backgroundColor = colours[j].getAttribute('data-colour');\r\n        }\r\n        colourListener();\r\n    });\r\n\r\n    // Add colour function\r\n    function colourListener() {\r\n        let term = document.querySelector('.colour-term').innerHTML;\r\n        let termEncode = makeSafeClass(term);\r\n        let termWrapper = document.querySelector('.' + termEncode + '');\r\n\r\n        // Pick a colour\r\n        clickListener(colours, (i) => {\r\n            let pickedColour = colours[i].getAttribute('data-colour');\r\n\r\n            // Add colour to object\r\n            termWrapper.querySelector('.theme-holder').style.background = pickedColour;\r\n        \r\n            if (pickedColour !== \"#fff\") {\r\n                termWrapper.querySelector('.term-holder').style.color = \"#fff\";\r\n                termWrapper.classList.add('bg-active');\r\n            }\r\n\r\n            // Set storage\r\n            tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].colour = pickedColour;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n            // Hide modal\r\n            hideModal(true);\r\n        });\r\n        document.querySelector('.no-colour').addEventListener('click', (e) => {\r\n            termWrapper.querySelector('.term-holder').style.color = \"#3F4747\";\r\n            // Set storage\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].colour;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n        });\r\n    }\r\n}\r\n\r\n// Symbol picker\r\nconst pickSymbol = function pickSymbol() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let symbolBtn = document.querySelectorAll('.symbol');\r\n    let symbolHTML = \"<tr>\";\r\n    let symbols = appData.fonts;\r\n\r\n    // Solid symbols\r\n    if (tinyTerms.globalUnlocks.symbolsSolid.active === 'unlocked') {\r\n\r\n        symbolHTML += '<table>';\r\n        let k = 0;\r\n\r\n        for (let i = 0; i < appData.fonts.solid.length; i++) {\r\n\r\n            if (k % 5 === 0 && k != 0) {\r\n                symbolHTML += '</tr><tr>';\r\n            }\r\n            symbolHTML += '<td><p class=' + appData.fonts.solid[i] + '></p></td>';\r\n            k++;\r\n\r\n            if (i === (appData.fonts.solid.length - 1)) {\r\n                symbolHTML += \"</tr>\"\r\n            }\r\n        }\r\n        symbolHTML += '</table>';\r\n    }\r\n\r\n    // Feather symbols\r\n    if (tinyTerms.globalUnlocks.symbolsFeather.active === 'unlocked') {\r\n\r\n        symbolHTML += '<table>';\r\n        let k = 0;\r\n\r\n        for (let i = 0; i < appData.fonts.light.length; i++) {\r\n\r\n            if (k % 5 === 0 && k != 0) {\r\n                symbolHTML += '</tr><tr>';\r\n            }\r\n            symbolHTML += '<td><p class=' + appData.fonts.light[i] + '></p></td>';\r\n            k++;\r\n\r\n            if (i === (appData.fonts.light.length - 1)) {\r\n                symbolHTML += \"</tr>\"\r\n            }\r\n        }\r\n\r\n        symbolHTML += '</table>';\r\n    }\r\n\r\n    symbolHTML += '<table>';\r\n    let k = 0;\r\n\r\n    // Default symbols\r\n    for (let i = 0; i < appData.fonts.feather.length; i++) {\r\n\r\n\r\n\r\n        if (k % 5 === 0 && k != 0) {\r\n            symbolHTML += '</tr><tr>';\r\n        }\r\n        symbolHTML += '<td><p class=' + appData.fonts.feather[i] + '></p></td>';\r\n        k++;\r\n\r\n        if (i === (appData.fonts.feather.length - 1)) {\r\n            symbolHTML += \"</tr>\"\r\n        }\r\n    }\r\n\r\n    symbolHTML += '</table>';\r\n\r\n    /* OLD UNICODE SYMOBLS\r\n    let symbolRanges = [[0x2600,0x26FF]]; //,[0x1200, 0x135A],[0xA000, 0xA48C]\r\n    for (let j = 0; j < symbolRanges.length; j++) {\r\n\r\n        for (let i = symbolRanges[j][0]; i < symbolRanges[j][1]; i++) {\r\n\r\n            if (k % 5 === 0 && k != 0) {\r\n                symbolHTML += '</tr><tr>';\r\n            }\r\n\r\n            let symbol = String.fromCodePoint(i);\r\n            symbolHTML += '<td><p>' + symbol + '&#xFE0E;</p></td>';\r\n            k++;\r\n\r\n            if (i === (symbolRanges[j][1] - 1)) {\r\n                symbolHTML += \"</tr>\"\r\n            }\r\n        }\r\n    }\r\n    */\r\n\r\n    clickListener(symbolBtn, (i) => {\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let termHolder = symbolBtn[i].parentNode.parentNode.parentNode;\r\n        let term = symbolBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"symbol\">Glyph picker</h2>\r\n                    </header>\r\n                    <p>Click below to add a glyph for <br>\"<span class=\"symbol-term\">${term}</span>\":</p>\r\n                    <div class=\"symbol-wrap\">\r\n                        <a href=\"#\" class=\"symbol-clear icon-right-open\">Clear selected symbol</a>\r\n                        ${symbolHTML}\r\n                    </div>`;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        symbolListener();\r\n    });\r\n    // Check for clicked symbol\r\n    function symbolListener() {\r\n        let term = document.querySelector('.symbol-term').innerHTML;\r\n        let termEncode = makeSafeClass(term);\r\n        let termWrapper = document.querySelector('.' + termEncode + '');\r\n        let pickedSymbol = \"\";\r\n\r\n        for (let i = 0; i < modal.getElementsByTagName('table').length; i++) {\r\n            symbolClickListener(modal.getElementsByTagName('table')[i]);\r\n        }\r\n\r\n        function symbolClickListener(eachTable) {\r\n\r\n            eachTable.addEventListener('click', function (e) {\r\n                e = e || window.event;\r\n                let target = e.target || e.srcElement;\r\n                pickedSymbol = target.getAttribute(\"class\");\r\n                // Add symbol to object\r\n                termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n                termWrapper.querySelector('.symbol-holder').classList.add(pickedSymbol);\r\n                // Set storage\r\n                tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].symbol = pickedSymbol;\r\n                localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n                // Hide modal\r\n                hideModal(true);\r\n            }, false);\r\n        }\r\n\r\n        document.querySelector('.symbol-clear').addEventListener('click', (e) => {\r\n            // Set storage\r\n            termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].symbol;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            hideModal(true);\r\n        });\r\n    }\r\n}\r\n\r\n// Hide modal\r\nconst hideModal = function hideModal(trigger) {\r\n    let modal = document.querySelector('.m-modal');\r\n    let modalClose = modal.querySelector('.close');\r\n\r\n    modalClose.addEventListener(\"click\", (e) => {\r\n        e.preventDefault();\r\n        closeModal();\r\n    });\r\n    // Programatically close modal\r\n    if (trigger) {\r\n        closeModal();\r\n    }\r\n    // Hide modal\r\n    function closeModal() {\r\n        document.getElementsByTagName('body')[0].classList.remove('modal-active');\r\n        modal.classList.add('hidden');\r\n        modal.querySelector('.content').innerHTML = \"\";\r\n    }\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, clickListener, checkURL, makeSafeClass } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { hideModal } from 'termInteraction';\r\n\r\n// Exports\r\nexport { showHome };\r\n\r\n// Show home screen\r\nconst showHome = function showHome() {\r\n\r\n\t// Once loaded\r\n\tsetTimeout(() => {\r\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\t\tdocument\r\n\t\t\t.querySelector(\".m-query\")\r\n\t\t\t.classList.add(\"animated\", \"slideInDown\");\r\n\t},\r\n\t\t2500\r\n\t);\r\n\r\n\ttinyTerms.uploadedLists = tinyTerms.uploadedLists || {};\r\n\r\n\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\ttinyTerms.customListChoices = tinyTerms.customListChoices || {};\r\n\r\n\t\t// Get uploaded lists\r\n\t\tfor (let val in uploadedLists) {\r\n\t\t\tlet listName = uploadedLists[val].name;\r\n\t\t\tlet listCategory = uploadedLists[val].category;\r\n\t\t\tlet listURL = uploadedLists[val].sheetURL;\r\n\r\n\t\t\ttinyTerms.customListChoices[listName] = {\r\n\t\t\t\tname: listName,\r\n\t\t\t\tcategory: listCategory,\r\n\t\t\t\tsheetURL: listURL\r\n\t\t\t}\r\n\t\t}\r\n\t\tcategoryHandler();\r\n\t});\r\n\r\n\t// Show home screen\r\n\tlet homeWrapper = document.querySelector('.m-menu');\r\n\thomeWrapper.classList.remove('hidden');\r\n\tdocument.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\tdocument.getElementsByTagName('body')[0].classList.add('home');\r\n\r\n\tlet homeHeader = document.querySelector('.home-bg').getElementsByTagName('h2')[0];\r\n\tlet chooseList = homeWrapper.querySelector('.choose-list');\r\n\tlet categories = chooseList.getElementsByTagName('nav')[0].innerHTML;\r\n\tlet navBack = document.querySelector('.nav-back');\r\n\tlet scrollArrow = document.querySelector('.scroll-arrow');\r\n\tlet scrollCheck;\r\n\tlet lists;\r\n\r\n\t// Sets initial listeners on categories\r\n\tfunction categoryHandler() {\r\n\t\tlet categoryBtn = document.querySelectorAll('.category');\r\n\r\n\t\t// Show custom list category if user uploaded\r\n\t\tif (Object.keys(tinyTerms.customListChoices).length > 0) {\r\n\t\t\tdocument.querySelector('.custom').style.display = \"inline-block\";\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < categoryBtn.length; i++) {\r\n\t\t\tcategoryBtn[i].addEventListener('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t// Build coresponding list\r\n\t\t\t\tbuildList(categoryBtn[i].innerHTML);\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// Show the list\r\n\t\t\t\t\tshowList();\r\n\t\t\t\t\t// Listener to go back to categories\r\n\t\t\t\t\tnavBack.addEventListener('click', (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tshowCategoriesAgain();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Set listeners for nav\r\n\t\t\t\t\tnavListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tfunction buildList(category) {\r\n\t\tchooseList.classList.add('animated', 'slideOutLeft');\r\n\t\thomeHeader.classList.add('animated', 'fadeOutUp');\r\n\t\tlists = \"\";\r\n\t\tfor (let val in tinyTerms.listChoices) {\r\n\r\n\t\t\tif (tinyTerms.listChoices[val].category === category) {\r\n\t\t\t\tlists += '<a href=\"#\">' + tinyTerms.listChoices[val].name + '</a>';\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let val in tinyTerms.customListChoices) {\r\n\t\t\t\r\n\t\t\tif (tinyTerms.customListChoices[val].category === category) {\r\n\t\t\t\tlists += '<div class=\"' + makeSafeClass(tinyTerms.customListChoices[val].name) + '\"><span class=\"custom-list\"></span><a href=\"#\">' + tinyTerms.customListChoices[val].name + '</a></div>';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showList() {\r\n\t\thomeHeader.innerHTML = \"Choose a list:\";\r\n\t\thomeHeader.classList.remove('fadeOutUp');\r\n\t\thomeHeader.classList.add('fadeInDown');\r\n\t\tnavBack.classList.remove('hidden');\r\n\t\tchooseList.getElementsByTagName('nav')[0].innerHTML = lists;\r\n\t\tchooseList.classList.remove('slideOutLeft');\r\n\t\tchooseList.classList.add('slideInRight');\r\n\r\n\t\tif (chooseList.getElementsByTagName('a').length > 3) {\r\n\t\t\tchooseList.classList.add('slideInRight', 'scroll');\r\n\r\n\t\t\tscrollCheck = setInterval(() => {\r\n\t\t\t\tif (chooseList.clientHeight === (chooseList.scrollHeight - chooseList.scrollTop)) {\r\n\t\t\t\t\tscrollArrow.classList.add('hidden');\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tscrollArrow.classList.remove('hidden');\r\n\t\t\t\t}\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showCategoriesAgain() {\r\n\t\thomeHeader.classList.add('fadeOutUp');\r\n\t\thomeHeader.classList.remove('fadeInDown');\r\n\t\tchooseList.classList.remove('slideInRight');\r\n\t\tchooseList.classList.add('slideOutRight');\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\thomeHeader.innerHTML = \"Choose a category:\";\r\n\t\t\thomeHeader.classList.remove('fadeOutUp');\r\n\t\t\thomeHeader.classList.add('fadeInDown');\r\n\t\t\tnavBack.classList.add('hidden');\r\n\t\t\tchooseList.getElementsByTagName('nav')[0].innerHTML = categories;\r\n\t\t\tchooseList.classList.add('slideInLeft');\r\n\t\t\tchooseList.classList.remove('slideOutRight', 'scroll');\r\n\t\t\tcategoryHandler();\r\n\t\t}, 500);\r\n\t}\r\n\r\n\tfunction navListeners() {\r\n\t\t// Add listener to nav\r\n\t\tlet listItem = document.querySelector('.choose-list').querySelectorAll('a');\r\n\r\n\t\tfor (var i = 0; i < listItem.length; i++) {\r\n\t\t\tlistItem[i].addEventListener('click', function (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\ttinyTerms.pickedList = this.innerHTML;\r\n\t\t\t\tlocalforage.getItem('tinyTermsAllPicked', function (err, value) {\r\n\t\t\t\t\ttinyTerms.AllPicked = value || [];\r\n\r\n\t\t\t\t\tif (tinyTerms.AllPicked.includes(tinyTerms.pickedList) === false) {\r\n\t\t\t\t\t\ttinyTerms.AllPicked.push(tinyTerms.pickedList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlocalforage.setItem('tinyTermsAllPicked', tinyTerms.AllPicked, () => {\r\n\t\t\t\t\t\tlocalforage.setItem('tinyTermsDefault', tinyTerms.pickedList, () => {\r\n\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Add listener to remove list\r\n\t\tlet removeList = document.querySelectorAll('.custom-list');\r\n\t\tfor (let i = 0; i < removeList.length; i++) {\r\n\r\n\t\t\tremoveList[i].addEventListener('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tlet insertPoint = removeList[i].nextSibling;\r\n\t\t\t\tdocument.querySelector('.create-list').classList.add('hidden');\r\n\t\t\t\tremoveList[i].classList.add('hidden');\r\n\t\t\t\tremoveList[i].parentNode.insertBefore(document.createElement(\"div\"), insertPoint.nextSibling);\r\n\t\t\t\tinsertPoint.nextSibling.innerHTML = '<p>Are you sure you want to delete your list? (Can\\'t undo)</p><button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n\t\t\t\tdocument.querySelector('.delete-confirm').addEventListener('click', () => {\r\n\t\t\t\t\tlet listName = removeList[i].parentNode.childNodes[1].innerHTML;\r\n\r\n\t\t\t\t\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\t\t\t\t\ttinyTerms.uploadedLists = uploadedLists || {};\r\n\t\t\t\t\t\tdelete tinyTerms.uploadedLists[listName];\r\n\t\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Delete list from nav\r\n\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\tremoveList[i].parentNode.removeChild(insertPoint.nextSibling);\r\n\t\t\t\t\t\tremoveList[i].parentNode.parentNode.removeChild(document.querySelector('.' + makeSafeClass(listName)));\r\n\r\n\t\t\t\t\t\t// Delete list references\r\n\t\t\t\t\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\t\t\t\t\tlocalforage.removeItem(tinyTerms[tinyTerms.pickedList]).then(function () {\r\n\t\t\t\t\t\t\t\tlocalforage.removeItem(\"tinyTermsDefault\");\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tdocument.querySelector('.delete-cancel').addEventListener('click', () => {\r\n\t\t\t\t\tremoveList[i].parentNode.removeChild(insertPoint.nextSibling);\r\n\t\t\t\t\tremoveList[i].classList.remove('hidden');\r\n\t\t\t\t\tdocument.querySelector('.create-list').classList.remove('hidden');\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// Upload list button\r\n\tdocument.querySelector('.upload-info').addEventListener('click', (e) => {\r\n\t\te.preventDefault();\r\n\t\t\r\n\t\tlet modal = document.querySelector('.m-modal');\r\n\r\n\t\t// Bring up modal\r\n\t\tmodal.classList.remove('hidden');\r\n\t\tmodal.style.zIndex = \"101\";\r\n\t\tmodal.querySelector('.close').addEventListener('click', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\thideModal(true);\r\n\t\t});\r\n\t\t\r\n\t\tlet unlockedView = `<header>\r\n\t\t\t\t\t\t\t\t<h2 class=\"\">Upload a list</h2>\r\n\t\t\t\t\t\t\t</header>\r\n\t\t\t\t\t\t\t<p>Create your very own list of Tiny Terms! For more info please visit:</p>\r\n\t\t\t\t\t\t\t<a target=\"_blank\" href=\"http://www.tiny-terms.com\">http://www.tiny-terms.com</a>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t<div class=\"list-uploader\">\r\n\t\t\t\t\t\t\t\t<label>List Name (max 25 characters)</label>\r\n\t\t\t\t\t\t\t\t<input class=\"upload-name\" type=\"text\" placeholder=\"Enter list name\">\r\n\t\t\t\t\t\t\t\t<label>List URL</label>\r\n\t\t\t\t\t\t\t\t<input class=\"upload-sheet\" type=\"text\" placeholder=\"Paste list URL\">\r\n\t\t\t\t\t\t\t\t<button class=\"upload-list\">Upload</button>\r\n\t\t\t\t\t\t\t</div>`;\r\n\t\t\r\n\t\tlet lockedView = `<header>\r\n                        \t<h2 class=\"\">Upload a list</h2>\r\n\t\t\t\t\t\t</header>\r\n\t\t\t\t\t\t<p>Create your very own list of Tiny Terms! For more info please visit:</p>\r\n\t\t\t\t\t\t<a target=\"_blank\" href=\"http://www.tiny-terms.com\">http://www.tiny-terms.com</a>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"list-uploader\">\r\n\t\t\t\t\t\t\t<p>Unlock this feature for just 59p</p>\r\n\t\t\t\t\t\t\t<button class=\"unlock-uploadlist\">Unlock</button>\r\n\t\t\t\t\t\t</div>`;\r\n\t\t\r\n\t\tlet webView = `<header>\r\n                        \t<h2 class=\"\">Upload a list</h2>\r\n\t\t\t\t\t\t</header>\r\n\t\t\t\t\t\t<p>Create your very own list of Tiny Terms! For more info please visit:</p>\r\n\t\t\t\t\t\t<a target=\"_blank\" href=\"http://www.tiny-terms.com\">http://www.tiny-terms.com</a>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div class=\"list-uploader\">\r\n\t\t\t\t\t\t\t<p>This feature is only available in the App version.</p>\r\n\t\t\t\t\t\t</div>`;\r\n\r\n\t\tif (typeof store !== 'undefined') {\r\n\t\t\tstore.refresh();\r\n\t\t\tlet product = store.get(\"custom list\");\r\n\t\t\t\r\n\t\t\tif (product.owned) {\r\n\t\t\t\tmodal.querySelector('.content').innerHTML += unlockedView;\r\n\t\t\t\tunlockedListeners();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tmodal.querySelector('.content').innerHTML += lockedView;\r\n\r\n\t\t\t\tdocument.querySelector('.unlock-uploadlist').addEventListener('click', (e) => {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tstore.order('custom list');\r\n\r\n\t\t\t\t\tstore.when(\"custom list\").approved(function (order) {\r\n\t\t\t\t\t\torder.finish();\r\n\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tmodal.querySelector('.content').innerHTML += webView;\r\n\t\t}\r\n\r\n\t\tfunction unlockedListeners() {\r\n\t\t\twindow.addEventListener(\"keypress\", function (e) {\r\n\t\t\t\tlet inputName = document.querySelector('.upload-name').value;\r\n\t\t\t\tlet inputSheet = document.querySelector('.upload-sheet').value;\r\n\r\n\t\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\t\tuploadList(inputName, inputSheet);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tdocument.querySelector('.upload-list').addEventListener('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tlet inputName = document.querySelector('.upload-name').value;\r\n\t\t\t\tlet inputSheet = document.querySelector('.upload-sheet').value;\r\n\r\n\t\t\t\tuploadList(inputName, inputSheet);\r\n\t\t\t});\r\n\t\t}\t\r\n\t});\r\n\r\n\tfunction uploadList(inputName, inputSheet) {\r\n\t\tinputName = inputName.substring(0, 25);\r\n\r\n\t\tif (inputName.length === 0) {\r\n\t\t\tdocument.querySelector('.upload-name').style.border = \"1px solid #ff0000\";\r\n\t\t\tdocument.querySelector('.upload-name').placeholder = \"Please enter a name\";\r\n\t\t}\r\n\t\tif (inputName.length > 0 && inputSheet.length > 0) {\r\n\r\n\t\t\t// Check valid URL\r\n\t\t\tif (checkURL(inputSheet) === true) {\r\n\t\t\t\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\t\t\t\ttinyTerms.uploadedLists = uploadedLists || {};\r\n\t\t\t\t\ttinyTerms.uploadedLists[inputName] = {\r\n\t\t\t\t\t\tname: inputName,\r\n\t\t\t\t\t\tcategory: 'Your lists',\r\n\t\t\t\t\t\tsheetURL: inputSheet\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\ttinyTerms.customListChoices = tinyTerms.customListChoices || {};\r\n\t\t\t\t\t\ttinyTerms.customListChoices[inputName] = {\r\n\t\t\t\t\t\t\tname: inputName,\r\n\t\t\t\t\t\t\tcategory: 'Your lists',\r\n\t\t\t\t\t\t\tsheetURL: inputSheet\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tdocument.querySelector('.custom').style.display = \"inline-block\";\r\n\t\t\t\t\t\tbuildList('Your lists');\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t// Show the list\r\n\t\t\t\t\t\t\tshowList();\r\n\t\t\t\t\t\t\t// Listener to go back to categories\r\n\t\t\t\t\t\t\tnavBack.addEventListener('click', (e) => {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tshowCategoriesAgain();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// Set listeners for nav\r\n\t\t\t\t\t\t\tnavListeners();\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\thideModal(true);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdocument.querySelector('.upload-sheet').style.border = \"1px solid #ff0000\";\r\n\t\t\t\tdocument.querySelector('.upload-sheet').value = \"\";\r\n\t\t\t\tdocument.querySelector('.upload-sheet').placeholder = \"Please enter a valid Sheets URL\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}","// Imports\nimport tinyTerms from \"app\";\nimport { showHome } from \"homeScreen\";\nimport { hideModal } from 'termInteraction';\n\n// Exports\nexport {\n\tready,\n\tcl,\n\tclv,\n\terrorReport,\n\tbuildData,\n\tcheckSameDay,\n\tarrayCheck,\n\tcheckConnection,\n\tmakeSafeClass,\n\tgetTodaysDate,\n\tcheckURL,\n\terrorAlert,\n\talertMsg,\n\tpickRandom,\n\tclickListener,\n\tcountLines,\n\tgetTimeComplete,\n\tcheckQuery,\n\tsortArrayByKey,\n\tappBlur,\n\tjsonp,\n\tfindKeys,\n\tfindOneKey,\n\tupdateDataCount,\n\tgetCSS\n};\n\n// JS ready\nfunction ready(fn) {\n\tif (document.readyState != \"loading\") {\n\t\tfn();\n\t}\n\telse {\n\t\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n\t}\n}\n\n// Console log -> cl\nfunction cl(log) {\n\tconsole.log(log);\n}\n\n// Console log plus value\nfunction clv(term, log) {\n\tconsole.log(term + \"= \" + log);\n}\n\n// Send crash report\nconst errorReport = function errorReport() {\n\n\tif (typeof cordova !== \"undefined\") {\n\t\tcordova.plugins.instabug.invoke();\n\t}\n\telse {\n\t\tlet modal = document.querySelector('.m-modal');\n\t\tmodal.classList.remove(\"hidden\");\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\t\tlet view = `<header>\n\t\t\t\t\t\t<h2 class=\"\">Get in touch</h2>\n\t\t\t\t\t</header>\n\t\t\t\t\t<p>We always welcome feedback especially if something isn't working as expected.\n\t\t\t\t\t<br><br>\n\t\t\t\t\tPlease email us at <a href=\"mailto:info@tiny-terms.com\">info@tiny-terms.com</a> with your thoughts.</p>\n\n\t\t\t\t\t<button class=\"close-feedback\">Close</button>\n\t\t\t\t\t`;\n\n\t\t// Add view\n\t\tmodal.querySelector(\".content\").innerHTML = view;\n\t\tmodal.classList.add('onboard');\n\n\t\tdocument.querySelector('.close-feedback').addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\thideModal(true);\n\t\t\ttinyTerms.tutComplete = true;\n\t\t\tlocalforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\n\t\t\tmodal.classList.remove('onboard');\n\t\t});\n\t\treturn false;\n\t}\n}\n\n// Alert errors\nconst errorAlert = function errorAlert(message, cb) {\n\n\twindow.onerror = (errorMsg, url, lineNumber, column, errorObj) => {\n\t\tlet modal = document.querySelector('.m-modal');\n\t\tmodal.classList.remove(\"hidden\");\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\t\tlet view = `<header>\n                        <h2 class=\"\">Uh oh!</h2>\n                    </header>\n                    <br>\n                    <h3>${message}</h3>\n                    <p><strong>Here's the exact problem:</strong></p>\n                    <p>'Error: ${errorMsg}</p> \n                    <p>Script: ${url}</p> \n                    <p>Line: ${lineNumber}</p>\n                    <p>Column: ${column}</p> \n                    <p>StackTrace: ${errorObj}</p>\n\n                    <button class=\"crash-report\">Report issue</button><button class=\"home-btn\">Close</button>\n                    `;\n\n\t\t// Add view\n\t\tmodal.querySelector(\".content\").innerHTML = view;\n\t\tmodal.classList.add('onboard');\n\t\tcb();\n\n\t\tdocument.querySelector('.crash-report').addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\terrorReport();\n\t\t});\n\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\tshowHome()\n\t\t});\n\t\treturn false;\n\t};\n}\n\n// Alert errors\nconst alertMsg = function alertMsg(message, cb) {\n\n\tlet modal = document.querySelector('.m-modal');\n\tmodal.classList.remove(\"hidden\");\n\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\tlet view = `<header>\n\t\t\t\t\t<h2 class=\"\">Something's not right</h2>\n\t\t\t\t</header>\n\t\t\t\t<p>${message}</p>\n\n\t\t\t\t<button class=\"home-btn\">Close</button>\n\t\t\t\t`;\n\n\t// Add view\n\tmodal.querySelector(\".content\").innerHTML = view;\n\tmodal.classList.add('onboard');\n\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\n\t\te.preventDefault();\n\t\tshowHome()\n\t});\n\tcb();\n\treturn false;\n}\n\n// Gets data from Google Sheets\nconst buildData = function buildData(data) {\n\n\tif (data === undefined) {\n\t\tlet modal = document.querySelector('.m-modal');\n\t\tmodal.classList.remove(\"hidden\");\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\t\tlet view = `<header>\n\t\t\t\t\t\t<h2 class=\"\">The list didn't load</h2>\n\t\t\t\t\t</header>\n\t\t\t\t\t<p>Please check you have internet connection.</p> \n\t\t\t\t\t<p>If you are using a custom list please check the URL you added is correct.</p>\n\n\t\t\t\t\t<button class=\"home-btn\">Close</button>\n\t\t\t\t\t`;\n\n\t\t// Add view\n\t\tmodal.querySelector(\".content\").innerHTML = view;\n\t\tmodal.classList.add('onboard');\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\tshowHome()\n\t\t});\n\t}\n\telse {\n\t\tlet columnName = data.Sheet1.columnNames[1];\n\n\t\ttinyTerms[tinyTerms.pickedList].speechLang = columnName;\n\t\ttinyTerms[tinyTerms.pickedList].dictFrom = data.Sheet1.elements[0][columnName];\n\t\ttinyTerms[tinyTerms.pickedList].dictTo = data.Sheet1.elements[1][columnName];\n\t\ttinyTerms[tinyTerms.pickedList].action = data.Sheet1.elements[2][columnName];\n\t\ttinyTerms[tinyTerms.pickedList].terms = tinyTerms[tinyTerms.pickedList].terms || {};\n\n\t\tfor (let i = 0; i < data.Sheet1.elements.length; i++) {\n\t\t\tlet termContent = data.Sheet1.elements[i].Term;\n\t\t\tlet definitionContent = data.Sheet1.elements[i].Definition;\n\t\t\tlet supportContent = data.Sheet1.elements[i].Support;\n\n\t\t\ttermContent = termContent.replace(/[!@#$%^&*]/g, \"\");\n\t\t\tdefinitionContent = definitionContent.replace(/[!@#$%^&*]/g, \"\");\n\n\t\t\ttinyTerms[tinyTerms.pickedList].terms[termContent] = {};\n\t\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].term = termContent;\n\t\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].definition = definitionContent;\n\t\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].support = supportContent;\n\t\t}\n\n\t\ttinyTerms.postBuildCallback();\n\t}\n};\n\n// Check for network connection\nconst checkConnection = function checkConnection(offline, online) {\n\tlet image = new Image();\n\tlet network;\n\n\timage.src = 'http://www.tiny-terms.com/img/brand/logo_white.svg?d=' + escape(Date());\n\n\timage.onload = () => network = true;\n\n\tsetTimeout(() => {\n\t\tif (network === true) {\n\t\t\tonline();\n\t\t}\n\t\telse {\n\t\t\toffline();\n\t\t}\n\t}, 5000);\n\n\n\t/*\n\tlet networkState = navigator.connection.type;\n\tlet states = {};\n\n\tstates[Connection.UNKNOWN] = 'Unknown';\n\tstates[Connection.ETHERNET] = 'Ethernet';\n\tstates[Connection.WIFI] = 'WiFi';\n\tstates[Connection.CELL_2G] = '2G';\n\tstates[Connection.CELL_3G] = '3G';\n\tstates[Connection.CELL_4G] = '4G';\n\tstates[Connection.CELL] = 'Cell';\n\tstates[Connection.NONE] = 'None';\n\n\treturn states[networkState];\n\t*/\n}\n\n// Count number of lines of text\nconst countLines = function countLines(target) {\n\tlet style = window.getComputedStyle(target, null);\n\tlet height = parseInt(style.getPropertyValue(\"height\"));\n\tlet font_size = parseInt(style.getPropertyValue(\"font-size\"));\n\tlet line_height = parseInt(style.getPropertyValue(\"line-height\"));\n\tlet box_sizing = style.getPropertyValue(\"box-sizing\");\n\n\tif (isNaN(line_height)) line_height = font_size * 1.2;\n\n\tif (box_sizing == 'border-box') {\n\t\tlet padding_top = parseInt(style.getPropertyValue(\"padding-top\"));\n\t\tlet padding_bottom = parseInt(style.getPropertyValue(\"padding-bottom\"));\n\t\tlet border_top = parseInt(style.getPropertyValue(\"border-top-width\"));\n\t\tlet border_bottom = parseInt(style.getPropertyValue(\"border-bottom-width\"));\n\t\theight = height - padding_top - padding_bottom - border_top - border_bottom\n\t}\n\tlet lines = Math.ceil(height / line_height);\n\treturn lines;\n}\n\n// Checks if the same or new day\nfunction checkSameDay() {\n\tlet todaysDate = getTodaysDate();\n\tlet storedDate = [];\n\n\t// Get date last stored\n\tstoredDate = Array.from(\n\t\ttinyTerms[tinyTerms.pickedList].storedData.dateOpened\n\t);\n\n\t// Check if same day\n\tif (arrayCheck(todaysDate, storedDate) === true) {\n\t\tif (tinyTerms[tinyTerms.pickedList].ops.addDay === true) {\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = true;\n\t\t}\n\t\telse {\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = false;\n\t\t}\n\t}\n\telse {\n\t\t// Otherwise a new day\n\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = true;\n\t}\n}\n\n// Creates array of day and month\nfunction getTodaysDate() {\n\t// Get current day + month\n\tlet todayDate = [];\n\tlet day = new Date().getDate();\n\tlet month = new Date().getMonth();\n\n\ttodayDate.push([day, month]);\n\n\treturn todayDate;\n}\n\n// Creates array of day, month, hour, minute, second\nfunction getTimeComplete() {\n\t// Get complete date time value\n\tlet timeComplete = [];\n\tlet day = new Date().getDate();\n\tlet month = new Date().getMonth();\n\tlet hour = new Date().getHours();\n\tlet minute = new Date().getMinutes();\n\tlet second = new Date().getSeconds();\n\n\ttimeComplete.push([day, month, hour, minute, second]);\n\n\treturn timeComplete;\n}\n\n// Validate URL\nconst checkURL = function checkURL(str) {\n\tlet a = document.createElement(\"a\");\n\ta.href = str;\n\treturn a.host && a.host != window.location.host;\n};\n\n// Makes a safe class name\nconst makeSafeClass = function makeSafeClass(name) {\n\treturn name.replace(/[^a-z0-9]/g, function (s) {\n\t\tlet c = s.charCodeAt(0);\n\t\tif (c == 32) return \"-\";\n\t\tif (c >= 65 && c <= 90) return \"_\" + s.toLowerCase();\n\t\treturn \"__\" + (\"000\" + c.toString(16)).slice(-4);\n\t});\n};\n\n// Check if arrays are the same\nfunction arrayCheck(arr1, arr2) {\n\t// If same return true\n\tif (JSON.stringify(arr1) == JSON.stringify(arr2)) {\n\t\treturn true;\n\t}\n\t// Else false\n\treturn false;\n}\n\n// Adds click functionality to selectors\nfunction clickListener(elements, clickFunction) {\n\n\tfor (let i = 0; i < elements.length; i++) {\n\t\telements[i].addEventListener(\"click\", e => {\n\t\t\te.preventDefault();\n\t\t\tclickFunction(i);\n\t\t});\n\t}\n}\n\n// Get a random term\nfunction pickRandom(objectList) {\n\tlet keys = Object.keys(objectList);\n\tlet pickedTerm = keys[keys.length * Math.random() << 0];\n\treturn pickedTerm;\n}\n\n// Check if two words the same\nfunction checkQuery(item1, item2) {\n\tif (item1 === item2) return true;\n\tif (item1.toUpperCase() === item2.toUpperCase()) return true;\n\n\t// Perform fuzzy comparison\n\tlet getBigrams = function (string) {\n\t\tlet i, j, ref, s, v;\n\t\ts = string.toLowerCase();\n\t\tv = new Array(s.length - 1);\n\t\tfor ((i = (j = 0)), (ref = v.length); j <= ref; i = (j += 1)) {\n\t\t\tv[i] = s.slice(i, i + 2);\n\t\t}\n\t\treturn v;\n\t};\n\tlet stringSimilarity = function (str1, str2) {\n\t\tlet hit_count, j, k, len, len1, pairs1, pairs2, union, x, y;\n\t\tif (str1.length > 0 && str2.length > 0) {\n\t\t\tpairs1 = getBigrams(str1);\n\t\t\tpairs2 = getBigrams(str2);\n\t\t\tunion = pairs1.length + pairs2.length;\n\t\t\thit_count = 0;\n\t\t\tfor ((j = 0), (len = pairs1.length); j < len; j++) {\n\t\t\t\tx = pairs1[j];\n\t\t\t\tfor ((k = 0), (len1 = pairs2.length); k < len1; k++) {\n\t\t\t\t\ty = pairs2[k];\n\t\t\t\t\tif (x === y) {\n\t\t\t\t\t\thit_count++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hit_count > 0) {\n\t\t\t\treturn 2.0 * hit_count / union;\n\t\t\t}\n\t\t}\n\t\treturn 0.0;\n\t};\n\tlet relevance = stringSimilarity(item1, item2);\n\tif (relevance > tinyTerms[tinyTerms.pickedList].ops.wordAccuracy)\n\t\treturn \"mispelled\";\n\n\t// Else false\n\treturn false;\n}\n\n// When user navigates away from page\nconst appBlur = function appBlur() {\n\tlet hidden = \"hidden\";\n\n\t// Standards:\n\tif (hidden in document)\n\t\tdocument.addEventListener(\"visibilitychange\", onchange);\n\telse if ((hidden = \"mozHidden\") in document)\n\t\tdocument.addEventListener(\"mozvisibilitychange\", onchange);\n\telse if ((hidden = \"webkitHidden\") in document)\n\t\tdocument.addEventListener(\"webkitvisibilitychange\", onchange);\n\telse if ((hidden = \"msHidden\") in document)\n\t\tdocument.addEventListener(\"msvisibilitychange\", onchange);\n\telse if (\"onfocusin\" in document)\n\t\t// IE 9 and lower:\n\t\tdocument.onfocusin = (document.onfocusout = onchange);\n\telse\n\t\t// All others:\n\t\twindow.onpageshow = (window.onpagehide = (window.onfocus = (window.onblur = onchange)));\n\n\tfunction onchange(evt) {\n\t\tlet v = \"visible\",\n\t\t\th = \"hidden\",\n\t\t\tevtMap = {\n\t\t\t\tfocus: v,\n\t\t\t\tfocusin: v,\n\t\t\t\tpageshow: v,\n\t\t\t\tblur: h,\n\t\t\t\tfocusout: h,\n\t\t\t\tpagehide: h\n\t\t\t};\n\n\t\tevt = evt || window.event;\n\t\tif (evt.type in evtMap) {\n\t\t\t//cl(evtMap[evt.type]);\n\t\t}\n\t\telse {\n\t\t\tlocation.reload();\n\t\t}\n\t}\n\n\t// set the initial state (but only if browser supports the Page Visibility API)\n\tif (document[hidden] !== undefined)\n\t\tonchange({\n\t\t\ttype: document[hidden] ? \"blur\" : \"focus\"\n\t\t});\n};\n\n// Order array based on nested key\nconst sortArrayByKey = function sortArrayByKey(arr, key, reverse) {\n\tlet sortOrder = 1;\n\tif (reverse) {\n\t\tsortOrder = -1;\n\t}\n\treturn arr.sort(function (a, b) {\n\t\tlet x = a[1][key];\n\t\tlet y = b[1][key];\n\t\treturn sortOrder * (x < y ? -1 : x > y ? 1 : 0);\n\t});\n};\n\n// Creates JSONP requests\nconst jsonp = function jsonp(uri) {\n\treturn new Promise(function (resolve, reject) {\n\t\tlet id = \"_\" + Math.round(10000 * Math.random());\n\t\tlet callbackName = \"jsonp_callback_\" + id;\n\t\twindow[callbackName] = function (data) {\n\t\t\tdelete window[callbackName];\n\t\t\tlet ele = document.getElementById(id);\n\t\t\tele.parentNode.removeChild(ele);\n\t\t\tresolve(data);\n\t\t};\n\n\t\tlet src = uri + \"&callback=\" + callbackName;\n\t\tlet script = document.createElement(\"script\");\n\t\tscript.src = src;\n\t\tscript.id = id;\n\t\tscript.addEventListener(\"error\", reject);\n\t\t(document.getElementsByTagName(\"head\")[0] ||\n\t\t\tdocument.body ||\n\t\t\tdocument.documentElement)\n\t\t\t.appendChild(script);\n\t});\n};\n\n// Find all keys in object ! Potentially cyclicle !\nconst findKeys = function findKeys(obj, key) {\n\tlet val = obj[key];\n\tlet keysList = [];\n\n\tfor (val in obj) {\n\t\tif (obj[val] === key) {\n\t\t\tkeysList.push(obj[val]);\n\t\t}\n\t}\n\treturn keysList;\n};\n\n\n// Search object for one key\nfunction findOneKey(obj, key) {\n\tvar val = obj[key];\n\tconsole.log(obj);\n\tif (val !== undefined) {\n\t\treturn val;\n\t}\n\tfor (var name in obj) {\n\t\tconsole.log(name);\n\t\tvar result = findOneKey(obj[name], key);\n\t\tconsole.log(result);\n\t\tif (result !== undefined) {\n\t\t\treturn result;\n\t\t}\n\t}\n\treturn undefined;\n}\n\n\n// Handles count of a type of data\nconst updateDataCount = function updateDataCount(\n\tobjectParent,\n\tnewProps,\n\tbaseValue\n) {\n\t// If no viewed data, create new\n\tif (!objectParent.hasOwnProperty(newProps)) {\n\t\tfor (let value of newProps) {\n\t\t\tobjectParent[value] = baseValue;\n\t\t}\n\t}\n\telse {\n\t\t// If viewed data exists\n\t\t// Update count\n\t\tfor (let value of newProps) {\n\t\t\tif (objectParent.hasOwnProperty(value)) {\n\t\t\t\tobjectParent[value] += 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tobjectParent[value] = baseValue;\n\t\t\t}\n\t\t}\n\t}\n\t// Pass back final object\n\treturn objectParent;\n};\n\n// Returns a CSS property for an elements\nconst getCSS = function getCSS(style, selector) {\n\tfor (let i = 0; i < document.styleSheets.length; i++) {\n\t\tlet mysheet = document.styleSheets[i];\n\t\tlet myrules = mysheet.cssRules ? mysheet.cssRules : mysheet.rules;\n\t\tfor (let j = 0; j < myrules.length; j++) {\n\t\t\tif (\n\t\t\t\tmyrules[j].selectorText &&\n\t\t\t\tmyrules[j].selectorText.toLowerCase() === selector\n\t\t\t) {\n\t\t\t\treturn myrules[j].style[style];\n\t\t\t}\n\t\t}\n\t}\n};","\r\n// Imports\r\nimport { cl, clv, pickRandom, sortArrayByKey } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\n\r\n// Exports\r\nexport { getListOfTerms };\r\n\r\n// Creates a list of terms\r\nconst getListOfTerms = function getListOfTerms() {\r\n\tlet i = 0;\r\n\tlet j = 0;\r\n\tlet listOfTerms = [];\r\n\tlet scannedTerms = [];\r\n\tconst dataLength = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length;\r\n\r\n\t// Prevent overflow\r\n\tif (tinyTerms[tinyTerms.pickedList].ops.displayedTerms > dataLength) {\r\n\t\ttinyTerms[tinyTerms.pickedList].ops.displayedTerms = dataLength;\r\n\t}\r\n\r\n\t// First time app opened\r\n\tif (tinyTerms[tinyTerms.pickedList].storedData.firstTime === undefined) {\r\n\r\n\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\tlet pickedTerm = pickRandom(tinyTerms[tinyTerms.pickedList].terms);\r\n\r\n\t\t\t// Ensure term hasn't been already scanned\r\n\t\t\tif (!listOfTerms.includes(pickedTerm)) {\r\n\t\t\t\tlistOfTerms.push(pickedTerm);\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// App opened before\r\n\telse {\r\n\r\n\t\t// Add reminder for previous incorrect term\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.incorrectTerms = tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms || {};\r\n\r\n\t\tif (Object.keys(tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms).length > 0) {\r\n\r\n\t\t\tlet reminderTerm;\r\n\r\n\t\t\t// Add reminded terms list\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms = tinyTerms[tinyTerms.pickedList].storedData.remindedTerms || {};\r\n\r\n\t\t\t// Keep reminded term the same\r\n\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder === undefined) {\r\n\t\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyReminder = {};\r\n\t\t\t\treminderTerm = pickRandom(tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms);\r\n\t\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyReminder[reminderTerm] = tinyTerms[tinyTerms.pickedList].terms[reminderTerm].definition;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treminderTerm = tinyTerms[tinyTerms.pickedList].storedData.dailyReminder;\r\n\t\t\t\treminderTerm = Object.getOwnPropertyNames(reminderTerm);\r\n\t\t\t}\r\n\r\n\t\t\t// Add to terms\r\n\t\t\tlistOfTerms.push(reminderTerm);\r\n\r\n\t\t\t// Remove from incorrect terms\r\n\t\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms[reminderTerm];\r\n\r\n\t\t\t// Add to list of reminded terms\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms[reminderTerm] = tinyTerms[tinyTerms.pickedList].terms[reminderTerm].definition;\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Choose terms to  display\r\n\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n\t\t\tlet viewedLength = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length;\r\n\r\n\t\t\t// If all terms viewed \r\n\t\t\tif ((viewedLength + i) === dataLength) {\r\n\t\t\t\tlet viewedSorted = [];\r\n\r\n\t\t\t\t// Convert viewed terms to array\r\n\t\t\t\tfor (let term in tinyTerms[tinyTerms.pickedList].storedData.viewedTerms) {\r\n\t\t\t\t\tviewedSorted.push([term, tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term]]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If reminder term picked remove from selection\r\n\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder !== undefined) {\r\n\r\n\t\t\t\t\tfor (let m = viewedSorted.length - 1; m >= 0; m--) {\r\n\r\n\t\t\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder.hasOwnProperty(viewedSorted[m][0])) {\r\n\t\t\t\t\t\t\tviewedSorted.splice(m, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Sort array by view count\r\n\t\t\t\tviewedSorted = sortArrayByKey(viewedSorted, 'viewCount');\r\n\r\n\t\t\t\t// Finish off iterator with lowest viewed terms\r\n\t\t\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\t\t\tlistOfTerms.push(viewedSorted[i][0]);\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n                \r\n\t\t\t\t// Overflow protection\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\t// Still unviewed terms in data\r\n\t\t\telse {\r\n\t\t\t\tlet pickedTerm = pickRandom(tinyTerms[tinyTerms.pickedList].terms);\r\n\r\n\t\t\t\t// Ensure term hasn't been already scanned\r\n\t\t\t\tif (!scannedTerms.includes(pickedTerm)) {\r\n\t\t\t\t\tscannedTerms.push(pickedTerm);\r\n\r\n\t\t\t\t\t// Ensure term not viewed before\r\n\t\t\t\t\tif (!tinyTerms[tinyTerms.pickedList].storedData.viewedTerms.hasOwnProperty(pickedTerm)) {\r\n\t\t\t\t\t\tlistOfTerms.push(pickedTerm);\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Overflow protection\r\n\t\t\tif (j > 10000) {\r\n\t\t\t\ti = tinyTerms[tinyTerms.pickedList].ops.displayedTerms;\r\n\t\t\t}\r\n\t\t\tj++;\r\n\t\t}\r\n\t}\r\n\t// Return final list of terms\r\n\treturn listOfTerms;\r\n}","\r\n// Imports\r\nimport { cl, clv, clickListener } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { hideModal } from 'termInteraction';\r\nimport { createNewQuery } from 'queryInteraction';\r\n\r\n// Exports\r\nexport { onboardShow };\r\n\r\n// Show home screen\r\nconst onboardShow = function onboardShow() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let onBoardText = document.querySelector('.m-onboarding');\r\n    let topTerm = document.querySelectorAll('.m-term-wrapper')[0];\r\n    let definitionHolder = topTerm.querySelector('.definition-holder');\r\n\tlet topBtn = topTerm.getElementsByTagName('button')[0];\r\n\r\n    tinyTerms.tutComplete = false;\r\n    localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n\r\n    // Onboard - Stage 1\r\n    modal.classList.remove('hidden');\r\n    document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n    let view = `<header>\r\n                    <h2 class=\"icon-compass\">Welcome</h2>\r\n                </header>\r\n                <p>Looks like this is your first time here, so let's go over some basics before you get started.</p>\r\n                <button class=\"onboard-1\">Let's go!</button>\r\n                <a href=\"#\" class=\"close-tut\">Skip the tutorial</a>\r\n                `;\r\n    modal.querySelector('.content').innerHTML = view;\r\n    modal.classList.add('onboard');\r\n    document.querySelector('.close-tut').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        hideModal(true);\r\n        modal.classList.remove('onboard');\r\n        tinyTerms.tutComplete = true;\r\n        localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n    });\r\n\r\n    document.querySelector('.onboard-1').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        onboardStage2();\r\n    });\r\n    function onboardStage2() {\r\n        hideModal(true);\r\n        topTerm.style.zIndex = \"100\";\r\n        topTerm.querySelector('.term-holder').classList.add('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.definition-wrapper').classList.add('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n        topBtn.setAttribute('disabled', 'true');\r\n        document.querySelector('.m-modal').style.cssText = \"display: none !important\";\r\n        onBoardText.classList.remove('hidden');\r\n\r\n        let view = `<p>This is one of the terms you will be learning, you get 5 each day.</p>\r\n                    <button class=\"onboard-2\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        let termOffset = topTerm.offsetTop + topTerm.offsetHeight;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        document.querySelector('.onboard-2').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage3();\r\n        });\r\n    }\r\n    function onboardStage3() {\r\n        topTerm.querySelector('.term-holder').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.term-views').classList.add('animated', 'pulse', 'infinite');\r\n        let view = `<p>On the right is the goal meter, fill this and the term is marked as complete.</p>\r\n                    <button class=\"onboard-3\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        onBoardText.classList.add('onboard-right');\r\n\r\n        document.querySelector('.onboard-3').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage4();\r\n        });\r\n    }\r\n    function onboardStage4() {\r\n        topTerm.querySelector('.term-views').classList.remove('animated', 'pulse', 'infinite');\r\n        topBtn.classList.add('animated', 'pulse', 'infinite');\r\n        \r\n\t\tlet timerOveride = setInterval(()=>{\r\n\t\t\ttopBtn.classList.remove('disabled');\r\n        \ttopBtn.removeAttribute('disabled');\r\n\t\t},100);\r\n\r\n        let view = `<p style=\"border:0; margin: 10px 0; padding: 0\">Press the reveal button to continue!</p>\r\n                    `;\r\n        onBoardText.innerHTML = view;\r\n\r\n        topBtn.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n\t\t\tclearInterval(timerOveride);\r\n            onboardStage5();\r\n        });\r\n    }\r\n    function onboardStage5() {\r\n        topBtn.classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.definition-wrapper').classList.remove('hidden');\r\n        topTerm.querySelector('.definition-holder').classList.add('animated', 'pulse', 'infinite');\r\n        topBtn.classList.add('disabled');\r\n\r\n\t\t// Prevent cheating\r\n\t\tlet goal = topTerm.querySelector('.count');\r\n\t\tlet goalCount = parseInt(goal.innerHTML);\r\n\r\n\t\tif (goalCount > 1) {\r\n\t\t\tgoalCount -= 1;\r\n\t\t\tgoal.innerHTML = goalCount;\r\n\t\t\tlet term = topTerm.querySelector('.term-holder').innerHTML;\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount = goalCount;\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] = goal.innerHTML = goalCount;\r\n\t\t\t // Save to storage\r\n        \tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\t\t}\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + definitionHolder.offsetHeight + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>This is the definition you need to learn, helpful information is displayed underneath.</p>\r\n                    <button class=\"onboard-5\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        onBoardText.classList.remove('onboard-right');\r\n\r\n        document.querySelector('.onboard-5').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage6();\r\n        });\r\n    }\r\n    function onboardStage6() {\r\n        topTerm.querySelector('.definition-holder').classList.remove('animated', 'pulse', 'infinite');\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>Tiny Terms uses spaced repetition, check back in an hour to add to the goal.</p>\r\n                    <button class=\"onboard-6\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        onBoardText.classList.add('onboard-right');\r\n\r\n        document.querySelector('.onboard-6').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage7();\r\n        });\r\n    }\r\n    function onboardStage7() {\r\n        topTerm.querySelector('.lookup').classList.add('animated', 'pulse', 'infinite');\r\n        document.querySelector('.query-holder').setAttribute('disabled', 'true');\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + definitionHolder.offsetHeight + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>Clicking the Further Study button will give you detailed info on the term and the ability to practice writing it.</p>\r\n                    <button class=\"onboard-7\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        document.querySelector('.onboard-7').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage7b();\r\n        });\r\n    }\r\n    function onboardStage7b() {\r\n        topTerm.querySelector('.lookup').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.colour').classList.add('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.symbol').classList.add('animated', 'pulse', 'infinite');\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + definitionHolder.offsetHeight + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>You can add a colour and symbol to the term, the visual association will help you remember.</p>\r\n                    <button class=\"onboard-7\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        document.querySelector('.onboard-7').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage8();\r\n        });\r\n    }\r\n    function onboardStage8() {\r\n        topTerm.querySelector('.colour').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.symbol').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.style.zIndex = \"50\";\r\n        let queryWrap = document.querySelector('.m-query');\r\n        document.querySelector('.query-submit').setAttribute('disabled', 'true');\r\n        document.querySelector('.query-input').setAttribute('disabled', 'true');\r\n        document.querySelector('.m-modal').style.cssText = \"\";\r\n        hideModal(true);\r\n\r\n        createNewQuery(true);\r\n        delete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        let termOffset = queryWrap.offsetTop + queryWrap.offsetHeight;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n        queryWrap.style.zIndex = \"100\";\r\n\r\n        let view = `<p>Each day you get a mini test to see how well you have remembered, you can also unlock an extra test by completing at least one goal meter in a day.</p>\r\n                    <button class=\"onboard-8\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        document.querySelector('.onboard-8').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage9();\r\n        });\r\n    }\r\n    function onboardStage9() {\r\n        modal.classList.remove('hidden');\r\n        onBoardText.innerHTML = \"\";\r\n        onBoardText.classList.add('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n        let queryWrap = document.querySelector('.m-query');\r\n        document.querySelector('.query-holder').removeAttribute('disabled');\r\n        document.querySelector('.query-submit').removeAttribute('disabled');\r\n        document.querySelector('.query-input').removeAttribute('disabled');\r\n        \r\n\r\n        queryWrap.style.zIndex = \"50\";\r\n        queryWrap.classList.add('hidden');\r\n        topTerm.querySelector('.definition-wrapper').classList.remove('hidden');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"\">That's about it</h2>\r\n                    </header>\r\n                    <p>Fill the progress bar by completing the goal meters to finish the list! You get points for answering tests correctly and completing goal meters, use them to unlock cool stuff. <br><br>Good luck!</p>\r\n                    <button class=\"close-tut\">Close the tutorial</button>\r\n                    `;\r\n        modal.querySelector('.content').innerHTML = view;\r\n        modal.classList.add('onboard');\r\n        document.querySelector('.close-tut').addEventListener(\"click\", (e) => {\r\n            e.preventDefault();\r\n            hideModal(true);\r\n            tinyTerms.tutComplete = true;\r\n            localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n            modal.classList.remove('onboard');\r\n        });\r\n    }\r\n}","\r\n// Imports\r\nimport { cl, clv, errorReport, clickListener } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { getListOfTerms } from \"termCreation\";\r\nimport { showHome } from \"homeScreen\";\r\nimport { onboardShow } from \"introInstructions\";\r\nimport { hideModal } from 'termInteraction';\r\n\r\n// Exports\r\nexport { navMenu, footerMenu, optionsDisplay, notifyAsk };\r\n\r\n// Nav menu functions\r\nconst navMenu = function navMenu() {\r\n    let nav = document.querySelector('.m-nav').querySelectorAll('nav')[0];\r\n\r\n    showNav();\r\n\r\n    function showNav() {\r\n        document.getElementsByTagName('h1')[0].addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            document.querySelector('.m-nav').classList.remove('hidden', 'slideOutLeft');\r\n            document.querySelector('.m-nav').classList.add('animated', 'slideInLeft');\r\n\r\n            document.querySelector('.nav-bg').classList.add('animated', 'fadeIn');\r\n            document.querySelector('.nav-bg').classList.remove('fadeOut');\r\n            document.getElementsByTagName('body')[0].classList.add('nav-on');\r\n\r\n            setTimeout(() => { hideNav() }, 100);\r\n        });\r\n    }\r\n\r\n    function hideNav() {\r\n        document.querySelector('.nav-bg').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            document.querySelector('.m-nav').classList.remove('slideInLeft');\r\n            document.querySelector('.m-nav').classList.add('slideOutLeft');\r\n            document.getElementsByTagName('body')[0].classList.remove('nav-on');\r\n\r\n            document.querySelector('.nav-bg').classList.add('fadeOut');\r\n            document.querySelector('.nav-bg').classList.remove('fadeIn');\r\n\r\n            setTimeout(() => { showNav() }, 100);\r\n        });\r\n    }\r\n\r\n    document.querySelector('.nav-close').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        document.querySelector('.m-nav').classList.remove('slideInLeft');\r\n        document.querySelector('.m-nav').classList.add('slideOutLeft');\r\n        document.getElementsByTagName('body')[0].classList.remove('nav-on');\r\n\r\n        document.querySelector('.nav-bg').classList.add('fadeOut');\r\n        document.querySelector('.nav-bg').classList.remove('fadeIn');\r\n\r\n        setTimeout(() => { showNav() }, 100);\r\n    });\r\n\r\n\r\n    localforage.getItem(\"tinyTermsAllPicked\", function (err, tinyTermsAllPicked) {\r\n        tinyTerms.AllPicked = tinyTermsAllPicked || [];\r\n        let navHTML = nav.innerHTML;\r\n\r\n        for (let i = 0; i < tinyTerms.AllPicked.length; i++) {\r\n            navHTML += '<a href=\"#\">' + tinyTerms.AllPicked[i] + '</a>';\r\n        }\r\n        nav.innerHTML = navHTML;\r\n\r\n        let navItems = nav.querySelectorAll('a');\r\n        let i = 1;\r\n\r\n        do {\r\n            navItems[i].addEventListener('click', function (e) {\r\n\r\n                e.preventDefault();\r\n                tinyTerms.pickedList = this.innerHTML;\r\n\r\n                localforage.setItem('tinyTermsDefault', tinyTerms.pickedList, () => {\r\n                    location.reload();\r\n                });\r\n            });\r\n            i++\r\n        }\r\n        while (i < navItems.length);\r\n\r\n        document.querySelector('.view-all').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            document.querySelector('.m-nav').classList.add('hidden');\r\n            document.getElementsByTagName('body')[0].classList.remove('nav-on');\r\n            document.getElementsByTagName(\"body\")[0].classList.add(\"loading\");\r\n            showHome();\r\n        });\r\n    });\r\n}\r\n\r\n// Footer menu functions\r\nconst footerMenu = function footerMenu() {\r\n    let modal = document.querySelector('.m-modal');\r\n\r\n    document.querySelector('.refresh').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        location.reload();\r\n    });\r\n\r\n    document.querySelector('.store').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-007-signs\">Store</h2>\r\n                    </header>\r\n                    <div class=\"options store\">\r\n                        <p>Paid unlocks:</p>\r\n                        <a href=\"#\" class=\"points-10-terms\"><strong>59p</strong> Get 10 terms a day</a>\r\n                        <p>Points rewards - this list:</p>\r\n                        <a href=\"#\" class=\"points-refresh-terms\"><strong>250</strong> Refresh terms</a>\r\n                        <a href=\"#\" class=\"points-half-timer\"><strong>300</strong> Half timer (1 day)</a>\r\n                        <p>Points rewards - all lists:</p>\r\n                        <a href=\"#\" class=\"points-neon-colours\"><strong>500</strong> Neon colours</a>\r\n                        <a href=\"#\" class=\"points-solid-symbols\"><strong>1000</strong> Solid symbols</a>\r\n                        <a href=\"#\" class=\"points-star-bg\"><strong>3000</strong> Star background</a>\r\n                        <a href=\"#\" class=\"points-feather-symbols\"><strong>5000</strong> Feather symbols</a>\r\n                        <a href=\"#\" class=\"points-letters-bg\"><strong>10,000</strong> Letters background</a>\r\n                        <a href=\"#\" class=\"points-metal-colours\"><strong>50,000</strong> Metal colours</a>\r\n                        <p>Apply code:</p>\r\n                        <input class=\"\" type=\"text\" placeholder=\"Add code here\">\r\n                        <button class=\"submit\">Submit</button>\r\n                    </div>\r\n                    `;\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        // Values must match paid unlocks object order in app.js\r\n        let paidItems = [\r\n            '.points-10-terms'\r\n        ];\r\n\r\n        // Values must match list unlocks object order in app.js\r\n        let listItems = [\r\n            '.points-refresh-terms',\r\n            '.points-half-timer'\r\n        ];\r\n\r\n        // Values must match global unlocks object order in app.js\r\n        let globalItems = [\r\n            '.points-neon-colours',\r\n            '.points-solid-symbols',\r\n            '.points-star-bg',\r\n            '.points-feather-symbols',\r\n            '.points-letters-bg',\r\n            '.points-metal-colours'\r\n        ];\r\n\r\n        // God mode..... FEEL THE POWEEERR!!!\r\n        if (tinyTerms[tinyTerms.pickedList].ops.godMode === true) {\r\n            tinyTerms.score = 1000000;\r\n            document.querySelector('.score-holder').innerHTML = tinyTerms.score;\r\n        }\r\n\r\n        // Click listener for list store items\r\n        clickListenerFromVar(listItems, (i) => {\r\n            let unlockItem = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.listUnlocks)[i];\r\n            let currentScore = tinyTerms.score;\r\n            let itemCost = tinyTerms[tinyTerms.pickedList].storedData.listUnlocks[unlockItem].points;\r\n\r\n            if (currentScore - itemCost > 0) {\r\n                let score = currentScore - itemCost;\r\n\r\n                tinyTerms[tinyTerms.pickedList].storedData.listUnlocks[unlockItem].active = 'unlocked';\r\n\r\n                // Refresh terms\r\n                if (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks.termsRefresh.active === 'unlocked') {\r\n                    let pickedTerms = getListOfTerms();\r\n                    tinyTerms[tinyTerms.pickedList].storedData.dailyTerms = pickedTerms;\r\n                }\r\n                localforage.setItem('tinyTerms.score', score, () => {\r\n                    // Save to storage\r\n                    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList], () => {\r\n                        // Refresh\r\n                        location.reload();\r\n                    });\r\n                });\r\n            }\r\n            else {\r\n                let modal = document.querySelector('.m-modal');\r\n                let view = `<header>\r\n                                <h2 class=\"\">Sorry, not enough points</h2>\r\n                            </header>\r\n                            <p>You can earn more points by completing goal meters, passing tests and finishing lists.</p>\r\n\r\n                            <button class=\"home-btn\">Close</button>\r\n                            `;\r\n\r\n                // Add view\r\n                modal.querySelector(\".content\").innerHTML = view;\r\n                document.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n                    e.preventDefault();\r\n                    hideModal(true);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Paid unlocks click listeners\r\n        clickListenerFromVar(paidItems, (i) => {\r\n            let unlockItem = Object.keys(tinyTerms.paidUnlocks)[i];\r\n\r\n            if (tinyTerms.paidUnlocks[unlockItem].active === 'unlocked'\r\n                || tinyTerms.paidUnlocks[unlockItem].active === 'inactive') {\r\n                return false;\r\n            }\r\n            else {\r\n\r\n                let webView = `<header>\r\n                                    <h2 class=\"\">Available in the app</h2>\r\n                                </header>\r\n                                <p>Download the Android app today to unlock this feature.</p>`;\r\n\r\n                if (typeof store !== 'undefined') {\r\n                    store.refresh();\r\n                    let product = store.get(\"extra items\");\r\n\r\n                    if (product.owned) {\r\n                        tinyTerms.paidUnlocks[unlockItem].active = 'unlocked';\r\n                        check10();\r\n                    }\r\n                    else {\r\n                        store.order('extra items');\r\n\r\n                        store.when(\"extra items\").approved(function (order) {\r\n                            tinyTerms.paidUnlocks[unlockItem].active = 'unlocked';\r\n                            order.finish();\r\n                            check10();\r\n                        });\r\n                    }\r\n                }\r\n                else {\r\n                    modal.querySelector('.content').innerHTML = webView;\r\n                }\r\n\r\n                check10();\r\n\r\n                function check10() {\r\n                    // 10 terms\r\n                    if (tinyTerms.paidUnlocks.terms10.active === 'unlocked') {\r\n                        let pickedTerms = getListOfTerms();\r\n                        let existingTerms = tinyTerms[tinyTerms.pickedList].storedData.dailyTerms;\r\n                        let joinedTerms = existingTerms.concat(pickedTerms);\r\n\r\n                        tinyTerms[tinyTerms.pickedList].storedData.dailyTerms = joinedTerms;\r\n\r\n                        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList], () => {\r\n                            // Save to storage\r\n                            localforage.setItem('tinyTerms.paidUnlocks', tinyTerms.paidUnlocks, () => {\r\n                                // Refresh\r\n                                location.reload();\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        // Hide 10 terms\r\n        if (tinyTerms.paidUnlocks.terms10.active === 'unlocked') {\r\n            document.querySelector('.points-10-terms').innerHTML = \"(Unlocked)\";\r\n        }\r\n\r\n        // Click listener for global store items\r\n        clickListenerFromVar(globalItems, (i) => {\r\n            let unlockItem = Object.keys(tinyTerms.globalUnlocks)[i];\r\n            let currentScore = tinyTerms.score;\r\n            let itemCost = tinyTerms.globalUnlocks[unlockItem].points;\r\n\r\n            if (tinyTerms.globalUnlocks[unlockItem].active === 'unlocked'\r\n                || tinyTerms.globalUnlocks[unlockItem].active === 'inactive') {\r\n                return false;\r\n            }\r\n            else if (currentScore - itemCost > 0) {\r\n                let score = currentScore - itemCost;\r\n\r\n                tinyTerms.globalUnlocks[unlockItem].active = 'unlocked';\r\n\r\n                localforage.setItem('tinyTerms.score', score, () => {\r\n                    // Like a christmas tree all up in here\r\n                    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList], () => {\r\n                        // Save to storage\r\n                        localforage.setItem('tinyTerms.globalUnlocks', tinyTerms.globalUnlocks, () => {\r\n                            // Refresh\r\n                            location.reload();\r\n                        });\r\n                    });\r\n                });\r\n            }\r\n            else {\r\n                let modal = document.querySelector('.m-modal');\r\n                let view = `<header>\r\n                                <h2 class=\"\">Sorry, not enough points</h2>\r\n                            </header>\r\n                            <p>You can earn more points by completing goal meters, passing tests and finishing lists.</p>\r\n\r\n                            <button class=\"home-btn\">Close</button>\r\n                            `;\r\n\r\n                // Add view\r\n                modal.querySelector(\".content\").innerHTML = view;\r\n                document.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n                    e.preventDefault();\r\n                    hideModal(true);\r\n                });\r\n            }\r\n        });\r\n\r\n        // Adds click functionality to selectors\r\n        function clickListenerFromVar(elements, clickFunction) {\r\n\r\n            for (let i = 0; i < elements.length; i++) {\r\n\r\n                document.querySelector(elements[i]).addEventListener(\"click\", e => {\r\n                    e.preventDefault();\r\n                    clickFunction(i);\r\n                });\r\n            }\r\n        }\r\n\r\n        // Menu mod for list unlocked items\r\n        for (let i = 0; i < listItems.length; i++) {\r\n            let unlockItem = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.listUnlocks)[i];\r\n\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.listUnlocks[unlockItem].active === 'unlocked') {\r\n                document.querySelector(listItems[i]).parentNode.removeChild(document.querySelector(listItems[i]));\r\n            }\r\n        }\r\n\r\n        let buttonOnHTML = `<button class=\"store-on\">Turn on</button>`;\r\n        let buttonOffHTML = `<button class=\"store-off\">Turn off</button>`;\r\n\r\n        // Menu mod for global unlocked items\r\n        for (let i = 0; i < globalItems.length; i++) {\r\n            let thisItem = globalItems[i];\r\n            let unlockItem = Object.keys(tinyTerms.globalUnlocks)[i];\r\n            let storedValue = tinyTerms.globalUnlocks[unlockItem].active;\r\n\r\n            if (storedValue === 'unlocked') {\r\n                document.querySelector(thisItem).innerHTML = buttonOffHTML;\r\n            }\r\n            if (storedValue === 'inactive') {\r\n                document.querySelector(thisItem).innerHTML = buttonOnHTML;\r\n            }\r\n        }\r\n        // Click listener store off buttons\r\n        for (let i = 0; i < document.querySelectorAll('.store-off').length; i++) {\r\n\r\n            document.querySelectorAll('.store-off')[i].addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n\r\n                let clickedItem = document.querySelectorAll('.store-off')[i].parentNode.className;\r\n                let thisItem = '.' + clickedItem;\r\n                let itemIndex = globalItems.indexOf('.' + clickedItem);\r\n                let unlockItem = Object.keys(tinyTerms.globalUnlocks)[itemIndex];\r\n                let storedValue = tinyTerms.globalUnlocks[unlockItem].active;\r\n\r\n                document.querySelector(thisItem).querySelector('.store-off').outerHTML = buttonOnHTML;\r\n\r\n                tinyTerms.globalUnlocks[unlockItem].active = 'inactive';\r\n\r\n                // Save to storage\r\n                localforage.setItem('tinyTerms.globalUnlocks', tinyTerms.globalUnlocks, () => {\r\n                    // Refresh\r\n                    location.reload();\r\n                });\r\n            });\r\n        }\r\n        // Click listener store on buttons\r\n        for (let i = 0; i < document.querySelectorAll('.store-on').length; i++) {\r\n\r\n            document.querySelectorAll('.store-on')[i].addEventListener('click', (e) => {\r\n                e.preventDefault();\r\n\r\n                let clickedItem = document.querySelectorAll('.store-on')[i].parentNode.className;\r\n                let thisItem = '.' + clickedItem;\r\n                let itemIndex = globalItems.indexOf('.' + clickedItem);\r\n                let unlockItem = Object.keys(tinyTerms.globalUnlocks)[itemIndex];\r\n                let storedValue = tinyTerms.globalUnlocks[unlockItem].active;\r\n\r\n                document.querySelector(thisItem).querySelector('.store-on').outerHTML = buttonOffHTML;\r\n\r\n                tinyTerms.globalUnlocks[unlockItem].active = 'unlocked';\r\n\r\n                // Save to storage\r\n                localforage.setItem('tinyTerms.globalUnlocks', tinyTerms.globalUnlocks, () => {\r\n                    // Refresh\r\n                    location.reload();\r\n                });\r\n            });\r\n        }\r\n    });\r\n\r\n    document.querySelector('.stats').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let name = tinyTerms.pickedList;\r\n        let completed = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms).length;\r\n        let remaining = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length;\r\n        let viewed = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length;\r\n        let correct = 0;\r\n        let incorrect = 0;\r\n\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.correctTerms !== undefined) {\r\n            correct = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.correctTerms).length;\r\n        }\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms !== undefined) {\r\n            incorrect = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms).length;\r\n        }\r\n\r\n        let learned = [];\r\n\r\n        for (let i = 0; i < completed; i++) {\r\n            let learnedTerm = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms)[i];\r\n            let learnedDefinition = tinyTerms[tinyTerms.pickedList].storedData.learnedTerms[learnedTerm];\r\n            learned += '<p class=\"small\">' + learnedTerm + ' - ' + learnedDefinition + '</p>';\r\n        }\r\n        if (completed === 0) {\r\n            learned = '<p class=\"small\">No completed terms, fill some goals!</p>'\r\n        }\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-008-bar-chart\">Progress</h2>\r\n                    </header>\r\n                    <div class=\"options stats\">\r\n                        <p><strong>${name}</strong></p>\r\n                        <p><strong>Total completed terms:</strong> <span class=\"right\">${completed} <span class=\"small\">/ ${remaining}</span></span></p>\r\n                        <br>\r\n                        <p><strong>Total viewed terms:</strong> <span class=\"right\">${viewed} <span class=\"small\">/ ${remaining}</span></span></p>\r\n                        <p><strong>Total correct tests:</strong> <span class=\"right\">${correct}</span></p>\r\n                        <p><strong>Total incorrect tests:</strong> <span class=\"right\">${incorrect}</span></p>\r\n                        <h3>Completed terms:</h3>\r\n                        ${learned}\r\n                    </div>\r\n                    `;\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n    });\r\n}\r\n\r\n// Options menu\r\nconst optionsDisplay = function optionsDisplay() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let settingsBtn = document.querySelector('.settings');\r\n\r\n    settingsBtn.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-cog-outline\">Options</h2>\r\n                    </header>\r\n                    <div class=\"options\">\r\n                        <p>Help</p>\r\n                        <a href=\"#\" class=\"icon-right-open show-tut\">Show the tutorial again</a>\r\n                        <a href=\"mailto:info@tiny-terms.com\" class=\"icon-right-open\">Email a question</a>\r\n                        <a href=\"#\" class=\"icon-right-open feedback\">Report a bug/leave feedback</a>\r\n                        <p>More Options</p>\r\n                        <a href=\"#\" class=\"icon-right-open reminders\">Reminders</a>\r\n                        <a href=\"#\" class=\"icon-right-open reset-list\">Reset list progress</a>\r\n                        <a href=\"#\" class=\"icon-right-open reset\">Reset the app</a>\r\n                        <p class=\"low-header\">Credits</p>\r\n                        <p><small>All design and development by Alex Plummer.</small><br>\r\n                        <small>Icons courtesy of <a href=\"http://www.toicon.com/authors/1\">Shannon E Thomas</a> at <a href=\"http://www.toicon.com\">toicon.com</a></small></p>\r\n                    </div>\r\n                    `;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        let resetList = document.querySelector('.reset-list');\r\n        let resetApp = document.querySelector('.reset');\r\n\r\n        if (typeof cordova === 'undefined') {\r\n            document.querySelector('.options').removeChild(document.querySelector('.options').querySelector('.reminders'));\r\n        }\r\n        else {\r\n            document.querySelector('.reminders').addEventListener('click', (e) => { e.preventDefault(); notifyAsk() });\r\n        }\r\n\r\n        document.querySelector('.show-tut').addEventListener('click', (e) => { e.preventDefault(); onboardShow() });\r\n\r\n        document.querySelector('.feedback').addEventListener('click', (e) => { e.preventDefault(); errorReport() });\r\n\r\n        function resetMenu() {\r\n            if (document.querySelector('.delete-confirm') !== null) {\r\n                resetList.innerHTML = \"Reset list progress\";\r\n                resetApp.innerHTML = \"Reset the app\";\r\n                document.querySelector('.delete-confirm').parentNode.removeChild(document.querySelector('.delete-cancel'));\r\n                document.querySelector('.delete-confirm').parentNode.removeChild(document.querySelector('.delete-confirm'));\r\n            }\r\n        }\r\n        resetList.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            resetMenu();\r\n            resetList.innerHTML = \"Are you sure you want to delete progress for this list? (Can't undo)\";\r\n            resetList.parentNode.insertBefore(document.createElement(\"div\"), resetList.nextSibling);\r\n            resetList.nextSibling.innerHTML = '<button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n            document.querySelector('.delete-confirm').addEventListener('click', () => {\r\n                delete tinyTerms[tinyTerms.pickedList];\r\n                localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]).then(function (value) {\r\n                    localforage.removeItem('tinyTermsDefault').then(function () {\r\n                        location.reload();\r\n                    });\r\n                });\r\n            });\r\n            document.querySelector('.delete-cancel').addEventListener('click', () => {\r\n                hideModal(true);\r\n            });\r\n        });\r\n        document.querySelector('.reset').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            resetMenu();\r\n            resetApp.innerHTML = \"Are you sure you want to delete all progress for the app? (Can't undo)\";\r\n            resetApp.parentNode.insertBefore(document.createElement(\"div\"), resetApp.nextSibling);\r\n            resetApp.nextSibling.innerHTML = '<button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n            document.querySelector('.delete-confirm').addEventListener('click', () => {\r\n                localforage.clear().then(() => {\r\n                    location.reload();\r\n                });\r\n            });\r\n            document.querySelector('.delete-cancel').addEventListener('click', () => {\r\n                hideModal(true);\r\n            });\r\n        });\r\n    });\r\n}\r\n\r\n// Ask for reminders\r\nconst notifyAsk = function notifyAsk() {\r\n    let modal = document.querySelector('.m-modal');\r\n\r\n    modal.classList.remove('hidden');\r\n    document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n    let view = `<header>\r\n                    <h2 class=\"icon-cog-outline\">Reminders</h2>\r\n                </header>\r\n                <div class=\"m-reminders options\">\r\n                    <p>You can configure reminders here, they are really helpful if you keep forgetting to learn terms!</p>\r\n                    <button class=\"save-times\">Save reminders</button>\r\n                    <button class=\"add-time\">New reminder</button>\r\n                    <div class=\"time-holders\">\r\n                    </div>\r\n                </div>\r\n                `;\r\n\r\n    // Add view\r\n    modal.querySelector('.content').innerHTML = view;\r\n\r\n    let defaultTimes = [[8, 15], [12, 15], [17, 50]];\r\n\r\n    tinyTerms[tinyTerms.pickedList].storedData.reminderTimes = tinyTerms[tinyTerms.pickedList].storedData.reminderTimes || defaultTimes;\r\n\r\n    // Get stored times, then add to DOM\r\n    getTimes();\r\n\r\n    function getTimes() {\r\n        let reminderTimesLength = tinyTerms[tinyTerms.pickedList].storedData.reminderTimes.length;\r\n\r\n        document.querySelector('.time-holders').innerHTML = \"\";\r\n\r\n        // Build times based off stored data\r\n        for (let i = 0; i < reminderTimesLength; i++) {\r\n            let hours = tinyTerms[tinyTerms.pickedList].storedData.reminderTimes[i][0];\r\n            let mins = tinyTerms[tinyTerms.pickedList].storedData.reminderTimes[i][1];\r\n            if (mins === 0) { mins = '00' };\r\n            let time = hours + ':' + mins;\r\n\r\n            addTime(i, time);\r\n        }\r\n    }\r\n\r\n    // Add to DOM\r\n    function addTime(i, time) {\r\n        let timeClass = 'time-' + i;\r\n        let timeTemplate = `<div class=\"time-wrap ${timeClass}\">\r\n                                <input type=\"text\" class=\"time-input\" disabled value=\"${time}\">\r\n                                <button class=\"change-time\">Change</button>\r\n                                <button class=\"remove-time\">Remove</button>\r\n                            </div>`;\r\n\r\n        document.querySelector('.time-holders').innerHTML += timeTemplate;\r\n        updateListeners();\r\n    }\r\n\r\n    // Add a new time \r\n    document.querySelector('.add-time').addEventListener('click', (e) => {\r\n        tinyTerms[tinyTerms.pickedList].storedData.reminderTimes.push([12, 0]);\r\n        getTimes();\r\n    });\r\n\r\n    // Save reminders\r\n    document.querySelector('.save-times').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        saveReminders();\r\n\r\n        // Save to storage\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]).then(function (value) {\r\n            let view = `<header>\r\n                            <h2 class=\"icon-cog-outline\">Saved</h2>\r\n                        </header>\r\n                        <div class=\"m-reminders options\">\r\n                            <p>Thanks, your reminders have been saved.</p>\r\n                        </div>\r\n                        `;\r\n\r\n            // Add view\r\n            modal.querySelector('.content').innerHTML = view;\r\n        });\r\n    });\r\n\r\n    function saveReminders() {\r\n        let reminderTimesLength = tinyTerms[tinyTerms.pickedList].storedData.reminderTimes.length;\r\n\r\n        // Reset stored\r\n        tinyTerms[tinyTerms.pickedList].storedData.reminderTimes = [];\r\n        cordova.plugins.notification.local.cancelAll(function() {}, this);\r\n\r\n        // Build times based off edited times\r\n        let timeButtons = document.querySelectorAll('.time-wrap');\r\n        let timeCount = timeButtons.length;\r\n\r\n        for (let i = 0; i < timeCount; i++) {\r\n            let editedTime = document.querySelectorAll('.time-wrap')[i].querySelector('.time-input').value;\r\n\r\n            let hours = editedTime.split(\":\")[0];\r\n            let mins = editedTime.split(\":\")[1];\r\n\r\n            // Add to stored\r\n            tinyTerms[tinyTerms.pickedList].storedData.reminderTimes.push([hours, mins]);\r\n\r\n            let theDate = new Date();\r\n\r\n            theDate.setHours(hours);\r\n            theDate.setMinutes(mins);\r\n            theDate.setSeconds(0);\r\n\r\n            cordova.plugins.notification.local.schedule({\r\n                id: i,\r\n                text: \"It's time to learn!\",\r\n                firstAt: theDate,\r\n                every: \"day\",\r\n                led: \"e21657\"\r\n            });\r\n        }\r\n    }\r\n\r\n    // Update listeners for buttons\r\n    function updateListeners() {\r\n        let timeButtons = document.querySelectorAll('.time-wrap');\r\n        let timeCount = timeButtons.length;\r\n\r\n        // Edit time\r\n        for (let i = 0; i < timeCount; i++) {\r\n            document.querySelectorAll('.time-wrap')[i].querySelector('.change-time').addEventListener('click', function (e) {\r\n                e.preventDefault();\r\n                let thisToggle = 'x' + i;\r\n                let thisWrap = '.time-' + i;\r\n                let thisInput = document.querySelector(thisWrap).getElementsByTagName('input')[0];\r\n\r\n                thisToggle = new mdDateTimePicker.default({\r\n                    type: 'time',\r\n                    mode: true\r\n                });\r\n\r\n                thisToggle.time = moment().hours(12).minutes(0);\r\n                thisToggle.toggle();\r\n                thisToggle.trigger = thisInput;\r\n\r\n                thisInput.addEventListener('onOk', function () {\r\n                    let hours = thisToggle.time.hours().toString();\r\n                    let mins = thisToggle.time.minutes().toString();\r\n\r\n                    if (mins < 10) { mins = '0' + mins };\r\n                    this.value = hours + ':' + mins;\r\n                });\r\n            });\r\n\r\n            // Remove time\r\n            document.querySelectorAll('.time-wrap')[i].querySelector('.remove-time').addEventListener('click', function (e) {\r\n                tinyTerms[tinyTerms.pickedList].storedData.reminderTimes.splice(i, 1).pop();\r\n                getTimes();\r\n            });\r\n        }\r\n    }\r\n}"]}