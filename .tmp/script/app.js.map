{"version":3,"sources":["app.js","appData.js","viewCreation.js","queryInteraction.js","termInteraction.js","homeScreen.js","helperFunctions.js","termCreation.js","introInstructions.js","menuInteraction.js"],"names":["tinyTermsApp","appData","fonts","feather","viewCreate","termsToCreate","viewHTML","value","termValue","tinyTerms","pickedList","terms","term","definitionValue","definition","supportValue","support","termEncode","makeSafeClass","revealCounter","viewsCount","storedData","revealGoal","undefined","document","querySelector","innerHTML","action","dailyQuery","newHolder","ops","revealGoalTarget","termHolders","querySelectorAll","i","length","style","minHeight","classList","add","countLines","viewedTerms","colour","termWrapper","pickedColour","background","color","symbol","pickedSymbol","revealCountdowns","revealBtn","revealTerm","parentNode","createRevealTimer","addHearts","heartHolder","heartsHTML","hearts","points","localforage","setItem","storedName","setScore","scoreHolder","score","progressBar","learnedTerms","completed","Object","keys","remaining","width","createNewQuery","bonus","randomTerm","queryTerms","correctTerms","incorrectTerms","cycledTerms","pickRandom","hasOwnProperty","dailyReminder","queryHandler","dailyTerms","indexOf","remove","queryWrapper","querySubmit","resultHolder","parseInt","count","queryComplete","getElementsByTagName","window","addEventListener","e","keyCode","click","preventDefault","queryInput","checkQuery","winCase","border","loseCase","spelling","input","correct","placeholder","removeChild","revealedBtnHandler","clickListener","contains","countHolder","definitionWrapper","definitionHolder","viewCount","revealGoalCount","gameWon","modal","view","completeBonus","complete","dailyBonus","minutes","counterMins","seconds","counterSecs","remainingMinutes","remainingSeconds","startTime","timerEnded","Date","getTime","startTimer","nowTime","setAttribute","diffSecs","Math","floor","totalSecs","clearInterval","timerUpdate","timeout","checkCount","setInterval","buttonTimer","disabled","displayedMinutes","displayedSeconds","hiddenZero","textToSpeech","termHolder","languages","TTS","speech","SpeechSynthesisUtterance","lang","speechLang","speechSynthesis","speak","text","locale","rate","reason","alertMsg","k","dictionaryLookup","dictionaryBtn","encodeURI","dictFrom","dictTo","toLowerCase","jsonp","then","data","dictionaryResponses","findProp","obj","key","out","proto","prototype","ts","toString","hasOwn","bind","call","tuc","err","console","log","addColour","colourBtn","picker","colours","coloursHolder","j","backgroundColor","getAttribute","colourListener","hideModal","pickSymbol","symbolBtn","symbolHTML","symbols","symbolListener","event","target","srcElement","trigger","modalClose","closeModal","showHome","setTimeout","uploadedLists","getItem","customListChoices","val","listName","name","listCategory","category","listURL","sheetURL","categoryHandler","homeWrapper","homeHeader","chooseList","categories","navBack","scrollArrow","scrollCheck","lists","categoryBtn","display","buildList","showList","showCategoriesAgain","navListeners","listChoices","clientHeight","scrollHeight","scrollTop","listItem","AllPicked","includes","push","location","reload","removeList","insertPoint","nextSibling","insertBefore","createElement","childNodes","removeItem","zIndex","inputName","inputSheet","uploadList","substring","checkURL","ready","fn","readyState","errorReport","cordova","plugins","instabug","invoke","errorAlert","message","cb","onerror","errorMsg","url","lineNumber","column","errorObj","buildData","columnName","Sheet1","columnNames","elements","termContent","Term","definitionContent","Definition","supportContent","Support","postBuildCallback","checkConnection","networkState","navigator","connection","type","states","Connection","UNKNOWN","ETHERNET","WIFI","CELL_2G","CELL_3G","CELL_4G","CELL","NONE","getComputedStyle","height","getPropertyValue","font_size","line_height","box_sizing","isNaN","padding_top","padding_bottom","border_top","border_bottom","lines","ceil","checkSameDay","todaysDate","getTodaysDate","storedDate","Array","from","dateOpened","arrayCheck","addDay","newDay","todayDate","day","getDate","month","getMonth","str","a","href","host","replace","s","c","charCodeAt","slice","arr1","arr2","JSON","stringify","clickFunction","objectList","pickedTerm","random","item1","item2","toUpperCase","getBigrams","string","ref","v","stringSimilarity","str1","str2","hit_count","len","len1","pairs1","pairs2","union","x","y","relevance","wordAccuracy","appBlur","hidden","onchange","onfocusin","onfocusout","onpageshow","onpagehide","onfocus","onblur","evt","h","evtMap","focus","focusin","pageshow","blur","focusout","pagehide","sortArrayByKey","arr","reverse","sortOrder","sort","b","uri","Promise","resolve","reject","id","round","callbackName","ele","getElementById","src","script","body","documentElement","appendChild","getListOfTerms","listOfTerms","scannedTerms","dataLength","displayedTerms","firstTime","reminderTerm","remindedTerms","getOwnPropertyNames","viewedLength","viewedSorted","m","splice","onboardShow","onBoardText","topTerm","topBtn","tutComplete","onboardStage2","cssText","termOffset","offsetTop","offsetHeight","top","onboardStage3","onboardStage4","timerOveride","removeAttribute","onboardStage5","goal","goalCount","onboardStage6","onboardStage7","onboardStage8","queryWrap","onboardStage9","navMenu","nav","showNav","toggle","hideNav","tinyTermsAllPicked","navHTML","navItems","footerMenu","optionsDisplay","settingsBtn","resetList","resetApp","resetMenu","clear","debug","loadDelay","notLoaded","getLists","skipDefaultCheck","tinyTermsDefault","tutStatus","checkDefault","normalLoad","firstLoad","defaultlist","initialise","fetchData","Tabletop","init","callback","simpleSheet","appBuildHandler","pickedTerms","revealedTermCount","tinyTerms$1"],"mappings":"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","file":"app.js","sourcesContent":["// Imports\r\nimport { ready, cl, clv, buildData, errorReport, errorAlert, alertMsg, checkSameDay, checkConnection, arrayCheck, getTodaysDate, appBlur } from \"helperFunctions\";\r\nimport { getListOfTerms } from \"termCreation\";\r\nimport { revealedBtnHandler, dictionaryLookup, textToSpeech, addColour, hideModal, pickSymbol } from \"termInteraction\";\r\nimport { viewCreate, addHearts, setScore, progressBar } from \"viewCreation\";\r\nimport { createNewQuery } from \"queryInteraction\";\r\nimport { showHome } from \"homeScreen\";\r\nimport { onboardShow } from \"introInstructions\";\r\nimport { navMenu, footerMenu, optionsDisplay } from \"menuInteraction\";\r\nimport appData from \"appData\";\r\n\r\n// Exports\r\nexport default tinyTerms;\r\n\r\n// App namespace\r\nlet tinyTerms = tinyTerms || {};\r\n\r\n// Global options\r\nlet ops = {\r\n\tdisplayedTerms: 5,\r\n\tcounterMins: 60,\r\n\tcounterSecs: 0,\r\n\trevealGoalTarget: 3,\r\n\twordAccuracy: 0.7,\r\n\taddDay: false,\r\n\tdebug: true,\r\n\tloadDelay: 2500,\r\n\tpoints: {\r\n\t\tcorrect: 50,\r\n\t\tdailyBonus: 10,\r\n\t\thearts: 3\r\n\t}\r\n};\r\n\r\n// Default list choices\r\ntinyTerms.listChoices = {\r\n\t\"Italian Verbs ITA-ENG\": {\r\n\t\tname: \"Italian Verbs ITA-ENG\",\r\n\t\tcategory: \"Language\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1Q1pmDXybg_GDB6bSXknuBET2Nm8L-Roi2Kj01SHm_WI/pubhtml\"\r\n\t},\r\n\t\"Computer Components\": {\r\n\t\tname: \"Computer Components\",\r\n\t\tcategory: \"Technology\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1Ho5Viqg71mIBlbyAIjLIqHEWRr4znDCLZSBtwVTtZk0/edit\"\r\n\t},\r\n\t\"Periodic Elements\": {\r\n\t\tname: \"Periodic Elements\",\r\n\t\tcategory: \"Science\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1sL3kTrZq3Hdb_iBo7hC8x9oGXXownlxmmdmmvALAPlU/edit#gid=0\"\r\n\t},\r\n\t\"Global Capital Cities\": {\r\n\t\tname: \"Global Capital Cities\",\r\n\t\tcategory: \"Culture\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1hU1pJSR2sp4g7C91prXqijBzNVZTJ4Qkip0rY4IuWaQ/pubhtml\"\r\n\t},\r\n\t\"Top 100 words ITA-ENG\": {\r\n\t\tname: \"Top 100 words ITA-ENG\",\r\n\t\tcategory: \"Language\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1gBNQk9jH7X2iRIbcZg3F5kbOTGgl9EvlJ65UkYHV6Mo/pubhtml\"\r\n\t},\r\n\t\"Italian Anatomy ITA-ENG\": {\r\n\t\tname: \"Italian Anatomy ITA-ENG\",\r\n\t\tcategory: \"Language\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/1lDCYm0E9y8IBHoS2JrEu6iPe4UJEkfU3dEywURhhqb0/pubhtml\"\r\n\t},\r\n\t\"Bee Anatomy\": {\r\n\t\tname: \"Bee Anatomy\",\r\n\t\tcategory: \"Science\",\r\n\t\tsheetURL: \"https://docs.google.com/spreadsheets/d/12-g6CDVGXIPTn5Va7rY6OC22ZS12p6av46p2LMht61I/pubhtml\"\r\n\t}\r\n};\r\n\r\n// Crash protection\r\nlet notLoaded = true;\r\n\r\nsetTimeout(() => {\r\n\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\r\n\tif (notLoaded === true) {\r\n\t\tlet modal = document.querySelector('.m-modal');\r\n\t\tmodal.classList.remove(\"hidden\");\r\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\r\n\r\n\t\tlet view = `<header>\r\n\t\t\t\t\t\t<h2 class=\"\">Uh oh!</h2>\r\n\t\t\t\t\t</header>\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\t<h3>Sorry something went wrong</h3>\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\t<button class=\"crash-report\">Report issue</button><button class=\"home-btn\">Close</button>\r\n\t\t\t\t\t`;\r\n\r\n\t\t// Add view\r\n\t\tmodal.querySelector(\".content\").innerHTML += view;\r\n\t\tmodal.classList.add('onboard');\r\n\r\n\t\tdocument.querySelector('.errorReport').addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\terrorReport();\r\n\t\t});\r\n\r\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tshowHome();\r\n\t\t});\r\n\r\n\t\t\r\n\r\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tshowHome();\r\n\t\t});\r\n\t}\r\n}, 10000);\r\n\r\n// Initialise modules on load\r\nready(function () {\r\n\t\"use strict\";\r\n\t// Error handling for Tabletop\r\n\terrorAlert('Sorry there was a problem.', () => {\r\n\r\n\t\t// Clear list references callback\r\n\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\tlocalforage.removeItem(tinyTerms.pickedList);\r\n\t\t});\r\n\t\tnotLoaded = false;\r\n\t});\r\n\tgetLists();\r\n});\r\n\r\n// Pick a list\r\nfunction getLists(skipDefaultCheck) {\r\n\tlet tinyTermsDefault;\r\n\r\n\tlocalforage.getItem(\"tinyTerms.tutComplete\", function (err, tutStatus) {\r\n\t\ttinyTerms.tutComplete = tutStatus;\r\n\r\n\t\t// Check for default list, used on very first load\r\n\t\tlocalforage.getItem(\"tinyTermsDefault\", function (err, value) {\r\n\t\t\ttinyTermsDefault = value;\r\n\r\n\t\t\tif (tinyTermsDefault === null) {\r\n\t\t\t\tnotLoaded = false;\r\n\t\t\t\tshowHome();\r\n\t\t\t} else {\r\n\t\t\t\tcheckDefault();\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\tfunction checkDefault() {\r\n\t\t// Check for existing data of newly picked list\r\n\t\tlocalforage.getItem(\"tinyTerms\" + tinyTermsDefault, function (err, value) {\r\n\t\t\tif (value !== null) {\r\n\t\t\t\ttinyTerms.pickedList = tinyTermsDefault;\r\n\t\t\t\tnormalLoad(tinyTerms.pickedList);\r\n\t\t\t} \r\n\t\t\telse {\r\n\t\t\t\tif (typeof Connection !== \"undefined\") {\r\n\t\t\t\t\tlet connection = checkConnection();\r\n\t\t\t\t\tnotLoaded = false;\r\n\r\n\t\t\t\t\tif (connection === 'Unknown' || connection === '2G' || connection === 'Cell' || connection === 'None') {\r\n\r\n\t\t\t\t\t\talertMsg(\"Please connect to the internet to download list, after it will be available offline.\", () => {\r\n\t\t\t\t\t\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tshowHome()\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tfirstLoad();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tfirstLoad();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tfunction normalLoad(defaultlist) {\r\n\t\ttinyTerms.storedName = \"tinyTerms\" + defaultlist;\r\n\r\n\t\tlocalforage.getItem(\"tinyTerms\" + defaultlist, function (err, value) {\r\n\t\t\t// Set session storage to stored\r\n\t\t\ttinyTerms[tinyTerms.pickedList] = value;\r\n\r\n\t\t\t// Update stored ops\r\n\t\t\ttinyTerms[tinyTerms.pickedList].ops = ops;\r\n\t\t\tinitialise();\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Sets up new list, gets data\r\nconst firstLoad = function firstLoad() {\r\n\r\n\tlocalforage.getItem(\"tinyTermsDefault\", function (err, value) {\r\n\t\t// Set session storage to stored\r\n\t\ttinyTerms.pickedList = value;\r\n\r\n\t\t// Set picked list and create data object for it\r\n\t\ttinyTerms[tinyTerms.pickedList] = {};\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData = {};\r\n\t\ttinyTerms[tinyTerms.pickedList].ops = ops;\r\n\t\ttinyTerms.storedName = \"tinyTerms\" + tinyTerms.pickedList;\r\n\r\n\t\t// Set new list to storage, add as default\r\n\t\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n\t\t// Add default lists to uploadedLists, same place as user upload\r\n\t\tlocalforage.getItem(\"tinyTerms.uploadedLists\", function (err, uploadedLists) {\r\n\t\t\tlet sheetURL;\r\n\r\n\t\t\tuploadedLists = uploadedLists || {};\r\n\t\t\t// If list from uploaded lists\r\n\t\t\tif (uploadedLists.hasOwnProperty(tinyTerms.pickedList)) {\r\n\t\t\t\tsheetURL = uploadedLists[tinyTerms.pickedList].sheetURL;\r\n\t\t\t}\r\n\t\t\t// Else from default lists\r\n\t\t\telse {\r\n\t\t\t\tsheetURL = tinyTerms.listChoices[tinyTerms.pickedList].sheetURL;\r\n\t\t\t}\r\n\r\n\t\t\t// Fetch data for list\r\n\t\t\tfetchData(sheetURL, firstTime);\r\n\t\t});\r\n\t});\r\n};\r\n\r\n// Fetches list data\r\nconst fetchData = function fetchData(sheetURL, postBuildCallback) {\r\n\r\n\t// Add a callback method\r\n\ttinyTerms.postBuildCallback = postBuildCallback;\r\n\r\n\t// Error handling for Tabletop\r\n\terrorAlert('Couldn\\'t load the list URL, did you copy it correctly?', () => {\r\n\r\n\t\t// Clear list references callback\r\n\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\tlocalforage.removeItem(tinyTerms.pickedList);\r\n\t\t});\r\n\t\tnotLoaded = false;\r\n\t});\r\n\r\n\t// Get data from sheets\r\n\tTabletop.init({\r\n\t\tkey: sheetURL,\r\n\t\tcallback: buildData,\r\n\t\tsimpleSheet: false\r\n\t});\r\n};\r\n\r\n// Runs if first time app has run\r\nconst firstTime = function firstTime() {\r\n\r\n\tif (tinyTerms[tinyTerms.pickedList].ops.debug !== true) {\r\n\t\twindow.onerror = \"\";\r\n\t}\r\n\t\r\n\t// Create terms\r\n\tappBuildHandler();\r\n\r\n\t// Show intro onboarding\r\n\tif (tinyTerms.tutComplete === null) {\r\n\t\tonboardShow();\r\n\t}\r\n\r\n\t// Then set first time to false\r\n\ttinyTerms[tinyTerms.pickedList].storedData.firstTime = false;\r\n\r\n\t// Add to storage\r\n\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n};\r\n\r\n// Initialises data and app\r\nconst initialise = function initialise() {\r\n\t\r\n\t// Check if a new day\r\n\tcheckSameDay();\r\n\r\n\t// Start build\r\n\tappBuildHandler();\r\n};\r\n\r\n// Calls functions to handle app creation and running\r\nconst appBuildHandler = function appBuildHandler() {\r\n\t// Get initial terms\r\n\tlet pickedTerms;\r\n\r\n\t// If same day, used daily terms\r\n\tif (tinyTerms[tinyTerms.pickedList].storedData.newDay === false) {\r\n\t\tpickedTerms = tinyTerms[tinyTerms.pickedList].storedData.dailyTerms;\r\n\r\n\t\t// Load query if it exists already\r\n\t\tif (\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyQuery !== undefined &&\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.queryComplete !== true\r\n\t\t) {\r\n\t\t\tcreateNewQuery();\r\n\t\t}\r\n\t} else {\r\n\t\t// Else get new\r\n\t\tpickedTerms = getListOfTerms();\r\n\r\n\t\t// Clear daily goals\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.revealedTermCount;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.dailyReminder;\r\n\r\n\t\t// Reset daily reveal bonus\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal = tinyTerms[tinyTerms.pickedList].storedData.revealGoal || {};\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete = false;\r\n\r\n\t\t// Create query if revealed terms\r\n\t\tif (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms !== undefined) {\r\n\t\t\tcreateNewQuery();\r\n\t\t}\r\n\r\n\t\t// Create reminded terms default\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms = tinyTerms[tinyTerms.pickedList].storedData.remindedTerms || {};\r\n\t}\r\n\r\n\t// Create initial view\r\n\tviewCreate(pickedTerms);\r\n\tsetScore();\r\n\r\n\t// Create opened date, daily terms, viewed terms\r\n\ttinyTerms[tinyTerms.pickedList].storedData.dateOpened = getTodaysDate();\r\n\ttinyTerms[tinyTerms.pickedList].storedData.dailyTerms = pickedTerms;\r\n\r\n\t// Add to storage\r\n\tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n\t// Keep query active each day\r\n\ttinyTerms[tinyTerms.pickedList].storedData.queryComplete = tinyTerms[tinyTerms.pickedList].storedData.queryComplete || {};\r\n\r\n\t// Handles events for revealed terms\r\n\trevealedBtnHandler();\r\n\tdictionaryLookup();\r\n\ttextToSpeech();\r\n\taddColour();\r\n\tpickSymbol();\r\n\thideModal();\r\n\r\n\t// Builds UI elements\r\n\tprogressBar();\r\n\r\n\t// Shows options menu\r\n\tnavMenu();\r\n\tfooterMenu();\r\n\toptionsDisplay();\r\n\r\n\t// Refresh window on blur\r\n\tappBlur();\r\n\r\n\t// App should have loaded by here\r\n\tnotLoaded = false;\r\n\r\n\t// Once loaded\r\n\tsetTimeout(\r\n\t\t() => {\r\n\t\t\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\t\t\tdocument\r\n\t\t\t\t.querySelector(\".m-query\")\r\n\t\t\t\t.classList.add(\"animated\", \"slideInDown\");\r\n\t\t},\r\n\t\ttinyTerms[tinyTerms.pickedList].ops.loadDelay\r\n\t);\r\n\r\n\t// Show onboard if incomplete\r\n\tif (tinyTerms.tutComplete === false) {\r\n\t\tonboardShow();\r\n\t}\r\n\r\n\t// Debug code\r\n\tif (tinyTerms[tinyTerms.pickedList].ops.debug === true) {\r\n\t\tconsole.log(tinyTerms);\r\n\t}\r\n};","// App data\r\n\r\nexport default {\r\n    fonts: {\r\n        feather: [\r\n            \"icon-lines-and-angles_accommodate\",\r\n            \"icon-lines-and-angles_adapt\",\r\n            \"icon-lines-and-angles_add\",\r\n            \"icon-lines-and-angles_adjust\",\r\n            \"icon-lines-and-angles_agitate\",\r\n            \"icon-lines-and-angles_agree\",\r\n            \"icon-lines-and-angles_aid\",\r\n            \"icon-lines-and-angles_alarm\",\r\n            \"icon-lines-and-angles_alert\",\r\n            \"icon-lines-and-angles_amaze\",\r\n            \"icon-lines-and-angles_amplify\",\r\n            \"icon-lines-and-angles_analyze\",\r\n            \"icon-lines-and-angles_announce\",\r\n            \"icon-lines-and-angles_arrest\",\r\n            \"icon-lines-and-angles_ascend\",\r\n            \"icon-lines-and-angles_ask\",\r\n            \"icon-lines-and-angles_assist\",\r\n            \"icon-lines-and-angles_attract\",\r\n            \"icon-lines-and-angles_augment\",\r\n            \"icon-lines-and-angles_bake\",\r\n            \"icon-lines-and-angles_balance\",\r\n            \"icon-lines-and-angles_battle\",\r\n            \"icon-lines-and-angles_be\",\r\n            \"icon-lines-and-angles_believe\",\r\n            \"icon-lines-and-angles_birth\",\r\n            \"icon-lines-and-angles_blaze\",\r\n            \"icon-lines-and-angles_blend\",\r\n            \"icon-lines-and-angles_bloom\",\r\n            \"icon-lines-and-angles_blow\",\r\n            \"icon-lines-and-angles_bookmark\",\r\n            \"icon-lines-and-angles_bootleg\",\r\n            \"icon-lines-and-angles_bounce\",\r\n            \"icon-lines-and-angles_break\",\r\n            \"icon-lines-and-angles_brew\",\r\n            \"icon-lines-and-angles_broadcast\",\r\n            \"icon-lines-and-angles_browse\",\r\n            \"icon-lines-and-angles_build\",\r\n            \"icon-lines-and-angles_burn\",\r\n            \"icon-lines-and-angles_bury\",\r\n            \"icon-lines-and-angles_buy\",\r\n            \"icon-lines-and-angles_caffeinate\",\r\n            \"icon-lines-and-angles_calculate\",\r\n            \"icon-lines-and-angles_calibrate\",\r\n            \"icon-lines-and-angles_carry\",\r\n            \"icon-lines-and-angles_carve\",\r\n            \"icon-lines-and-angles_cast\",\r\n            \"icon-lines-and-angles_catch\",\r\n            \"icon-lines-and-angles_cease\",\r\n            \"icon-lines-and-angles_celebrate\",\r\n            \"icon-lines-and-angles_challenge\",\r\n            \"icon-lines-and-angles_charge\",\r\n            \"icon-lines-and-angles_charm\",\r\n            \"icon-lines-and-angles_chart\",\r\n            \"icon-lines-and-angles_chat\",\r\n            \"icon-lines-and-angles_choose\",\r\n            \"icon-lines-and-angles_chop\",\r\n            \"icon-lines-and-angles_clean\",\r\n            \"icon-lines-and-angles_cleanse\",\r\n            \"icon-lines-and-angles_climb\",\r\n            \"icon-lines-and-angles_drum\",\r\n            \"icon-lines-and-angles_eat\",\r\n            \"icon-lines-and-angles_edit\",\r\n            \"icon-lines-and-angles_enhance\",\r\n            \"icon-lines-and-angles_enlarge\",\r\n            \"icon-lines-and-angles_enter\",\r\n            \"icon-lines-and-angles_equal\",\r\n            \"icon-lines-and-angles_erase\",\r\n            \"icon-lines-and-angles_examine\",\r\n            \"icon-lines-and-angles_experiment\",\r\n            \"icon-lines-and-angles_explore\",\r\n            \"icon-lines-and-angles_extrude\",\r\n            \"icon-lines-and-angles_feed\",\r\n            \"icon-lines-and-angles_fight\",\r\n            \"icon-lines-and-angles_fill\",\r\n            \"icon-lines-and-angles_film\",\r\n            \"icon-lines-and-angles_filter\",\r\n            \"icon-lines-and-angles_find\",\r\n            \"icon-lines-and-angles_finish\",\r\n            \"icon-lines-and-angles_fix\",\r\n            \"icon-lines-and-angles_flag\",\r\n            \"icon-lines-and-angles_float\",\r\n            \"icon-lines-and-angles_flow\",\r\n            \"icon-lines-and-angles_fly\",\r\n            \"icon-lines-and-angles_focus\",\r\n            \"icon-lines-and-angles_fold\",\r\n            \"icon-lines-and-angles_forbid\",\r\n            \"icon-lines-and-angles_forebode\",\r\n            \"icon-lines-and-angles_fork\",\r\n            \"icon-lines-and-angles_format\",\r\n            \"icon-lines-and-angles_game\",\r\n            \"icon-lines-and-angles_give\",\r\n            \"icon-lines-and-angles_glance\",\r\n            \"icon-lines-and-angles_grill\",\r\n            \"icon-lines-and-angles_grow\",\r\n            \"icon-lines-and-angles_guide\",\r\n            \"icon-lines-and-angles_hang\",\r\n            \"icon-lines-and-angles_harvest\",\r\n            \"icon-lines-and-angles_haunt\",\r\n            \"icon-lines-and-angles_heal\",\r\n            \"icon-lines-and-angles_hear\",\r\n            \"icon-lines-and-angles_hide\",\r\n            \"icon-lines-and-angles_hold\",\r\n            \"icon-lines-and-angles_home\",\r\n            \"icon-lines-and-angles_identify\",\r\n            \"icon-lines-and-angles_imagine\",\r\n            \"icon-lines-and-angles_influence\",\r\n            \"icon-lines-and-angles_inject\",\r\n            \"icon-lines-and-angles_invade\",\r\n            \"icon-lines-and-angles_iron\",\r\n            \"icon-lines-and-angles_jam\",\r\n            \"icon-lines-and-angles_join\",\r\n            \"icon-lines-and-angles_judge\",\r\n            \"icon-lines-and-angles_keep\",\r\n            \"icon-lines-and-angles_kick\",\r\n            \"icon-lines-and-angles_pitch\",\r\n            \"icon-lines-and-angles_plan\",\r\n            \"icon-lines-and-angles_plant\",\r\n            \"icon-lines-and-angles_play\",\r\n            \"icon-lines-and-angles_push\",\r\n            \"icon-lines-and-angles_rain\",\r\n            \"icon-lines-and-angles_read\",\r\n            \"icon-lines-and-angles_record\",\r\n            \"icon-lines-and-angles_redo\",\r\n            \"icon-lines-and-angles_reheat\",\r\n            \"icon-lines-and-angles_remind\",\r\n            \"icon-lines-and-angles_repeat\",\r\n            \"icon-lines-and-angles_report\",\r\n            \"icon-lines-and-angles_resurrect\",\r\n            \"icon-lines-and-angles_rewind\",\r\n            \"icon-lines-and-angles_ride\",\r\n            \"icon-lines-and-angles_ring\",\r\n            \"icon-lines-and-angles_rise\",\r\n            \"icon-lines-and-angles_rock\",\r\n            \"icon-lines-and-angles_roll\",\r\n            \"icon-lines-and-angles_rule\",\r\n            \"icon-lines-and-angles_run\",\r\n            \"icon-lines-and-angles_save\",\r\n            \"icon-lines-and-angles_schedule\",\r\n            \"icon-lines-and-angles_screw\",\r\n            \"icon-lines-and-angles_scroll\",\r\n            \"icon-lines-and-angles_search\",\r\n            \"icon-lines-and-angles_see\",\r\n            \"icon-lines-and-angles_select\",\r\n            \"icon-lines-and-angles_sell\",\r\n            \"icon-lines-and-angles_send\",\r\n            \"icon-lines-and-angles_sew\",\r\n            \"icon-lines-and-angles_shade\",\r\n            \"icon-lines-and-angles_shake\",\r\n            \"icon-lines-and-angles_share\",\r\n            \"icon-lines-and-angles_shine\",\r\n            \"icon-lines-and-angles_shop\",\r\n            \"icon-lines-and-angles_shower\",\r\n            \"icon-lines-and-angles_shuffle\",\r\n            \"icon-lines-and-angles_sing\",\r\n            \"icon-lines-and-angles_sit\",\r\n            \"icon-lines-and-angles_skip\",\r\n            \"icon-lines-and-angles_sleep\",\r\n            \"icon-lines-and-angles_slice\",\r\n            \"icon-lines-and-angles_slide\",\r\n            \"icon-lines-and-angles_smell\",\r\n            \"icon-lines-and-angles_smuggle\",\r\n            \"icon-lines-and-angles_snow\",\r\n            \"icon-lines-and-angles_solve\",\r\n            \"icon-lines-and-angles_sound\",\r\n            \"icon-lines-and-angles_sparkle\",\r\n            \"icon-lines-and-angles_speak\",\r\n            \"icon-lines-and-angles_spin\",\r\n            \"icon-lines-and-angles_spy\",\r\n            \"icon-lines-and-angles_stack\",\r\n            \"icon-lines-and-angles_stamp\",\r\n            \"icon-lines-and-angles_steam\",\r\n            \"icon-lines-and-angles_stomp\",\r\n            \"icon-lines-and-angles_stop\",\r\n            \"icon-lines-and-angles_strum\",\r\n            \"icon-lines-and-angles_study\",\r\n            \"icon-lines-and-angles_submerge\",\r\n            \"icon-lines-and-angles_succeed\",\r\n            \"icon-lines-and-angles_sweep\",\r\n            \"icon-lines-and-angles_swim\",\r\n            \"icon-lines-and-angles_sync\",\r\n            \"icon-lines-and-angles_tag\",\r\n            \"icon-lines-and-angles_target\",\r\n            \"icon-lines-and-angles_teach\",\r\n            \"icon-lines-and-angles_think\",\r\n            \"icon-lines-and-angles_thunder\",\r\n            \"icon-lines-and-angles_tie\",\r\n            \"icon-lines-and-angles_tower\",\r\n            \"icon-lines-and-angles_transport\",\r\n            \"icon-lines-and-angles_trash\",\r\n            \"icon-lines-and-angles_travel\",\r\n            \"icon-lines-and-angles_trend\",\r\n            \"icon-lines-and-angles_turn\",\r\n            \"icon-lines-and-angles_type\",\r\n            \"icon-lines-and-angles_undo\",\r\n            \"icon-lines-and-angles_unlock\",\r\n            \"icon-lines-and-angles_upload\",\r\n            \"icon-lines-and-angles_use\",\r\n            \"icon-lines-and-angles_wait\",\r\n            \"icon-lines-and-angles_wash\",\r\n            \"icon-lines-and-angles_watch\",\r\n            \"icon-lines-and-angles_wear\",\r\n            \"icon-lines-and-angles_weigh\",\r\n            \"icon-lines-and-angles_win\",\r\n            \"icon-lines-and-angles_work\",\r\n            \"icon-lines-and-angles_worship\",\r\n            \"icon-lines-and-angles_write\",\r\n            \"icon-lines-and-angles_yell\",\r\n            \"icon-lines-and-angles_clip\",\r\n            \"icon-lines-and-angles_close\",\r\n            \"icon-lines-and-angles_code\",\r\n            \"icon-lines-and-angles_collect\",\r\n            \"icon-lines-and-angles_commit\",\r\n            \"icon-lines-and-angles_connect\",\r\n            \"icon-lines-and-angles_contact\",\r\n            \"icon-lines-and-angles_contain\",\r\n            \"icon-lines-and-angles_control\",\r\n            \"icon-lines-and-angles_cook\",\r\n            \"icon-lines-and-angles_cool\",\r\n            \"icon-lines-and-angles_copy\",\r\n            \"icon-lines-and-angles_crave\",\r\n            \"icon-lines-and-angles_create\",\r\n            \"icon-lines-and-angles_creep\",\r\n            \"icon-lines-and-angles_crop\",\r\n            \"icon-lines-and-angles_cry\",\r\n            \"icon-lines-and-angles_curdle\",\r\n            \"icon-lines-and-angles_cut\",\r\n            \"icon-lines-and-angles_dance\",\r\n            \"icon-lines-and-angles_dazzle\",\r\n            \"icon-lines-and-angles_decide\",\r\n            \"icon-lines-and-angles_defend\",\r\n            \"icon-lines-and-angles_deliver\",\r\n            \"icon-lines-and-angles_design\",\r\n            \"icon-lines-and-angles_destroy\",\r\n            \"icon-lines-and-angles_develop\",\r\n            \"icon-lines-and-angles_die\",\r\n            \"icon-lines-and-angles_disappear\",\r\n            \"icon-lines-and-angles_discard\",\r\n            \"icon-lines-and-angles_discover\",\r\n            \"icon-lines-and-angles_disguise\",\r\n            \"icon-lines-and-angles_divide\",\r\n            \"icon-lines-and-angles_download\",\r\n            \"icon-lines-and-angles_draw\",\r\n            \"icon-lines-and-angles_drill\",\r\n            \"icon-lines-and-angles_drink\",\r\n            \"icon-lines-and-angles_drive\",\r\n            \"icon-lines-and-angles_drop\",\r\n            \"icon-lines-and-angles_kiss\",\r\n            \"icon-lines-and-angles_launch\",\r\n            \"icon-lines-and-angles_lick\",\r\n            \"icon-lines-and-angles_lift\",\r\n            \"icon-lines-and-angles_light\",\r\n            \"icon-lines-and-angles_like\",\r\n            \"icon-lines-and-angles_link\",\r\n            \"icon-lines-and-angles_live\",\r\n            \"icon-lines-and-angles_load\",\r\n            \"icon-lines-and-angles_locate\",\r\n            \"icon-lines-and-angles_lock\",\r\n            \"icon-lines-and-angles_madho\",\r\n            \"icon-lines-and-angles_manufacture\",\r\n            \"icon-lines-and-angles_mark\",\r\n            \"icon-lines-and-angles_measure\",\r\n            \"icon-lines-and-angles_medicate\",\r\n            \"icon-lines-and-angles_melt\",\r\n            \"icon-lines-and-angles_merge\",\r\n            \"icon-lines-and-angles_mill\",\r\n            \"icon-lines-and-angles_move\",\r\n            \"icon-lines-and-angles_multiply\",\r\n            \"icon-lines-and-angles_mute\",\r\n            \"icon-lines-and-angles_navigate\",\r\n            \"icon-lines-and-angles_open\",\r\n            \"icon-lines-and-angles_pack\",\r\n            \"icon-lines-and-angles_paint\",\r\n            \"icon-lines-and-angles_park\",\r\n            \"icon-lines-and-angles_paste\",\r\n            \"icon-lines-and-angles_pause\",\r\n            \"icon-lines-and-angles_pay\",\r\n            \"icon-lines-and-angles_perform\",\r\n            \"icon-lines-and-angles_photograph\",\r\n            \"icon-lines-and-angles_pick\",\r\n            \"icon-lines-and-angles_pin\",\r\n            \"icon-lines-and-angles_plot\",\r\n            \"icon-lines-and-angles_point\",\r\n            \"icon-lines-and-angles_poison\",\r\n            \"icon-lines-and-angles_present\",\r\n            \"icon-lines-and-angles_press\",\r\n            \"icon-lines-and-angles_primp\",\r\n            \"icon-lines-and-angles_print\",\r\n            \"icon-lines-and-angles_pucker\"\r\n            ]\r\n    }\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, makeSafeClass, countLines } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { createRevealTimer } from 'termInteraction';\r\n\r\n// Exports\r\nexport { viewCreate, addHearts, setScore, progressBar };\r\n\r\n// Create app view\r\nconst viewCreate = function viewCreate(termsToCreate) {\r\n\r\n    let viewHTML = \"\";\r\n\r\n    // Create HTML for terms\r\n    for (let value of termsToCreate) {\r\n\r\n        // Get terms and definitions from data\r\n        let termValue = tinyTerms[tinyTerms.pickedList].terms[value].term;\r\n        let definitionValue = tinyTerms[tinyTerms.pickedList].terms[value].definition;\r\n        let supportValue = tinyTerms[tinyTerms.pickedList].terms[value].support;\r\n        let termEncode = makeSafeClass(termValue);\r\n        let revealCounter;\r\n        let viewsCount;\r\n\r\n        // Check storage for revealed count\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealGoal = tinyTerms[tinyTerms.pickedList].storedData.revealGoal || {};\r\n\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[termValue] === undefined) {\r\n            viewsCount = 0;\r\n        }\r\n        else {\r\n            viewsCount = (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[termValue]) || 0;\r\n        }\r\n\r\n        document.querySelector('h1').innerHTML = tinyTerms.pickedList;\r\n        document.querySelector('.list-action').innerHTML = tinyTerms[tinyTerms.pickedList].action + '<span class=\"query-holder\">'+tinyTerms[tinyTerms.pickedList].storedData.dailyQuery+'</span>';\r\n\r\n        // Create terms HTML\r\n        let newHolder =\r\n            `<div class=\"m-term-wrapper ${termEncode}\">\r\n                <p class=\"term-holder\">${termValue}</p>\r\n                <div class=\"theme-holder\"><p class=\"symbol-holder\"></p></div>\r\n                <div class=\"right\">\r\n                    <p class=\"term-views\"><span>Goal:</span> <span class=\"count\">${viewsCount}</span> / ${tinyTerms[tinyTerms.pickedList].ops.revealGoalTarget}</p>\r\n                    <button class=\"reveal\">Reveal</button>\r\n                </div>\r\n                <div class=\"definition-wrapper hidden\">\r\n                    <p class=\"definition-holder\">${definitionValue}</p>\r\n                    <div class=\"helpers\">\r\n                        <a href=\"#\" class=\"lookup\"></a>\r\n                        <a href=\"#\" class=\"colour\"></a>\r\n                        <a href=\"#\" class=\"symbol\"></a>\r\n                    </div>\r\n                    <div class=\"support-wrapper\">${supportValue}</div>\r\n                </div>\r\n            </div>`;\r\n\r\n        viewHTML += newHolder;\r\n    }\r\n    // Add to view\r\n    document.querySelector('.terms-wrapper').innerHTML = viewHTML;\r\n\r\n    // Style terms based on number of lines\r\n    let termHolders = document.querySelectorAll('.term-holder');\r\n\r\n    for (let i = 0; i < termHolders.length; i++) {\r\n        termHolders[i].style.minHeight = '0px';\r\n        termHolders[i].classList.add('lines-'+countLines(termHolders[i]));\r\n        termHolders[i].style.minHeight = '86px';\r\n    }\r\n\r\n    // Add theme to previously created terms\r\n    for (let value of termsToCreate) {\r\n        let termValue = tinyTerms[tinyTerms.pickedList].terms[value].term;\r\n        let termEncode = makeSafeClass(termValue);\r\n\r\n        // Check storage for assigned colour\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue] !== undefined && tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].colour !== undefined) {\r\n            let termWrapper = document.querySelector('.' + termEncode + '');\r\n            let pickedColour = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].colour;\r\n            // Add colour to object\r\n            termWrapper.querySelector('.theme-holder').style.background = pickedColour;\r\n            termWrapper.querySelector('.theme-holder').classList.add('bg-active');\r\n            termWrapper.querySelector('.term-holder').style.color = \"#fff\";\r\n        }\r\n        // Check storage for assigned symbol\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue] !== undefined && tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].symbol !== undefined) {\r\n            let termWrapper = document.querySelector('.' + termEncode + '');\r\n            let pickedSymbol = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[termValue].symbol;\r\n            // Add symbol to object\r\n            termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n            termWrapper.querySelector('.symbol-holder').classList.add(pickedSymbol);\r\n        }\r\n    }\r\n\r\n    // Add countdown timers to term buttons\r\n    for (let value of termsToCreate) {\r\n\r\n        // Check if timer data exists\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns !== undefined) {\r\n\r\n            // Add countdown timers to buttons\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[value] !== undefined) {\r\n\r\n                let revealBtn = document.querySelectorAll('.reveal');\r\n\r\n                // Find button node that matches term in DOM\r\n                for (let i = 0; i < revealBtn.length; i++) {\r\n                    let revealTerm = revealBtn[i].parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n                    if (revealTerm === value) {\r\n                        createRevealTimer(revealBtn[i]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Add hearts to page\r\nconst addHearts = function addHearts() {\r\n    let heartHolder = document.querySelector('.hearts');\r\n    let heartsHTML = \"\";\r\n\r\n    // If no hearts data exists\r\n    if (tinyTerms[tinyTerms.pickedList].storedData.hearts === undefined) {\r\n        tinyTerms[tinyTerms.pickedList].storedData.hearts = tinyTerms[tinyTerms.pickedList].ops.points.hearts;\r\n    }\r\n    for (let i = 0; i < tinyTerms[tinyTerms.pickedList].storedData.hearts; i++) {\r\n        heartsHTML += '<p></p>';\r\n    }\r\n    // Add to view\r\n    heartHolder.innerHTML = heartsHTML;\r\n\r\n    // Add to storage\r\n    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n}\r\n\r\n// Sets the score\r\nconst setScore = function setScore() {\r\n\r\n    let scoreHolder = document.querySelector('.score-holder');\r\n\r\n    // Set score if it doesn't exist\r\n    if (tinyTerms[tinyTerms.pickedList].storedData.score === undefined) {\r\n        tinyTerms[tinyTerms.pickedList].storedData.score = 0;\r\n    }\r\n\r\n    let score = tinyTerms[tinyTerms.pickedList].storedData.score;\r\n\r\n    // Add to view\r\n    scoreHolder.innerHTML = score;\r\n}\r\n\r\n// Add progress bar\r\nconst progressBar = function progressBar() {\r\n    // Create correct terms default\r\n    tinyTerms[tinyTerms.pickedList].storedData.learnedTerms = tinyTerms[tinyTerms.pickedList].storedData.learnedTerms || {};\r\n    let completed = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms).length;\r\n    let remaining = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length;\r\n\r\n    // Add to DOM\r\n    document.querySelector('.m-progress-bar').querySelector('.completed').innerHTML = completed;\r\n    document.querySelector('.m-progress-bar').querySelector('.remaining').innerHTML = ' / ' + remaining;\r\n    document.querySelector('.m-progress-bar').querySelector('.progress-bg').style.width = ((completed / remaining) * 100) + \"%\";\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, pickRandom, checkQuery, makeSafeClass } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { addHearts } from 'viewCreation';\r\n\r\n// Exports\r\nexport { createNewQuery };\r\n\r\n// Sets up query\r\nconst createNewQuery = function createNewQuery(bonus) {\r\n\r\n    // Pick a term for query\r\n    let randomTerm;\r\n    let i = 0;\r\n\r\n    // If no stored data for reveal countdowns\r\n    tinyTerms[tinyTerms.pickedList].storedData.queryTerms = tinyTerms[tinyTerms.pickedList].storedData.queryTerms || {};\r\n\r\n    // Set correctTerms storage if not exists\r\n    tinyTerms[tinyTerms.pickedList].storedData.correctTerms = tinyTerms[tinyTerms.pickedList].storedData.correctTerms || {};\r\n\r\n    // Set incorrectTerms storage if not exists\r\n    tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms = tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms || {};\r\n\r\n    let cycledTerms = [];\r\n    // Choose term from viewed terms\r\n    while (i < Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length) {\r\n\r\n        // If no daily term\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.dailyQuery === undefined) {\r\n            // Pick a random term\r\n            randomTerm = pickRandom(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms);\r\n        }\r\n        else {\r\n            randomTerm = tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n        }\r\n        // Make sure not answered correctly before\r\n        if (!tinyTerms[tinyTerms.pickedList].storedData.correctTerms.hasOwnProperty(randomTerm)) {\r\n\r\n            // If query not from daily reminder term\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder !== undefined) {\r\n                if (!tinyTerms[tinyTerms.pickedList].storedData.dailyReminder.hasOwnProperty(randomTerm)) {\r\n                    queryHandler();\r\n                    break;\r\n                }\r\n            }\r\n            // If query not from daily terms\r\n            else if (!tinyTerms[tinyTerms.pickedList].storedData.dailyTerms.hasOwnProperty(randomTerm)) {\r\n                queryHandler();\r\n                break;\r\n            }\r\n        }\r\n        if (!cycledTerms.indexOf(randomTerm)) {\r\n            i++\r\n        }\r\n        // Else look for another\r\n        if (i === Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length) {\r\n            document.querySelector('.result-holder').innerHTML = \"Reveal more terms to get a query\";\r\n            document.querySelector('.result-holder').classList.remove('hidden');\r\n        }\r\n    }\r\n\r\n    // Build the query\r\n    function queryHandler() {\r\n        let queryWrapper = document.querySelector('.query-wrapper');\r\n        let querySubmit = document.querySelector('.query-submit');\r\n        let resultHolder = document.querySelector('.result-holder');\r\n        let scoreHolder = document.querySelector('.score-holder');\r\n        let heartHolder = document.querySelector('.hearts');\r\n        let score = parseInt(scoreHolder.innerHTML);\r\n        let definition = tinyTerms[tinyTerms.pickedList].terms[randomTerm].definition;\r\n        let count = 0;\r\n\r\n        // Save to storage\r\n        tinyTerms[tinyTerms.pickedList].storedData.dailyQuery = randomTerm;\r\n        tinyTerms[tinyTerms.pickedList].storedData.queryComplete = false;\r\n\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        let termEncode = makeSafeClass(randomTerm);\r\n\r\n        // Hide daily term definition if same\r\n        if (document.querySelector('.' + termEncode + '') !== null) {\r\n            document.querySelector('.' + termEncode + '').querySelector('.definition-wrapper').classList.add('hidden');\r\n        }\r\n\r\n        // Add hearts\r\n        delete tinyTerms[tinyTerms.pickedList].storedData.hearts;\r\n        addHearts();\r\n\r\n        // Show the query wrapper\r\n        queryWrapper.classList.remove('hidden');\r\n\r\n        // Change title if bonus\r\n        if (bonus) {\r\n            queryWrapper.getElementsByTagName('h2')[0].innerHTML = \"Bonus Test\";\r\n        }\r\n\r\n        window.addEventListener(\"keypress\", function (e) {\r\n            if (e.keyCode === 13) {\r\n                querySubmit.click();\r\n            }\r\n        });\r\n\r\n        // Query outcomes\r\n        querySubmit.addEventListener(\"click\", (e) => {\r\n            e.preventDefault();\r\n            let queryInput = document.querySelector('.query-input').value;\r\n\r\n            if (checkQuery(queryInput, definition) === true) {\r\n                winCase();\r\n            }\r\n            else if (checkQuery(queryInput, definition) === \"mispelled\") {\r\n                winCase(\"mispelled\", queryInput);\r\n            }\r\n            else if (queryInput === \"\") {\r\n                document.querySelector('.query-input').style.border = \"1px solid #ff0000\";\r\n                resultHolder.innerHTML = \"Please enter a definition.\";\r\n                resultHolder.classList.remove('hidden');\r\n            }\r\n            else {\r\n                loseCase();\r\n            }\r\n        });\r\n\r\n        // If definition is right\r\n        function winCase(spelling, input) {\r\n            // Hide the query input\r\n            document.querySelector('.query-form').classList.add('hidden');\r\n            heartHolder.classList.add('hidden');\r\n            // If mispelled\r\n            if (spelling === \"mispelled\") {\r\n                // Display win message\r\n                resultHolder.innerHTML = \"Well done but check your spelling (\" + input + \"), the definition is <strong>\\\"\" + definition + \"\\\"</strong>\";\r\n                resultHolder.classList.remove('hidden');\r\n            }\r\n            else {\r\n                // Display win message\r\n                resultHolder.innerHTML = \"Well done, the definition is <strong>\\\"\" + definition + \"\\\"</strong>\";\r\n                resultHolder.classList.remove('hidden');\r\n            }\r\n            // Add to score\r\n            score += tinyTerms[tinyTerms.pickedList].ops.points.correct;\r\n            // Update view\r\n            scoreHolder.innerHTML = score;\r\n            // Add to stored data\r\n            tinyTerms[tinyTerms.pickedList].storedData.score = score;\r\n            tinyTerms[tinyTerms.pickedList].storedData.correctTerms[randomTerm] = definition;\r\n            tinyTerms[tinyTerms.pickedList].storedData.queryComplete = true;\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n            // Save to storage\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n        }\r\n        // If definition is wrong\r\n        function loseCase() {\r\n            let queryInput = document.querySelector('.query-input');\r\n            queryInput.style.border = \"1px solid #ccc\";\r\n            \r\n            // Add placeholder\r\n            queryInput.placeholder = queryInput.value;\r\n            // Remove guess\r\n            queryInput.value = \"\";\r\n            // Update view\r\n            resultHolder.innerHTML = \"Try again.\";\r\n            resultHolder.classList.remove('hidden');\r\n            // Lose a heart\r\n            heartHolder.removeChild(heartHolder.getElementsByTagName('p')[0]);\r\n            tinyTerms[tinyTerms.pickedList].storedData.hearts -= 1;\r\n            // If all hearts lost\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.hearts === 0) {\r\n                // Hide query \r\n                document.querySelector('.query-form').classList.add('hidden');\r\n                heartHolder.classList.add('hidden');\r\n                // Update DOM\r\n                queryInput.value = \"\";\r\n                queryInput.placeholder = \"Enter the definition\";\r\n                // Update view\r\n                resultHolder.innerHTML = \"Sorry, you are out of attempts!\";\r\n                resultHolder.classList.remove('hidden');\r\n                // Add to storedDatta \r\n                tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms[randomTerm] = definition;\r\n                tinyTerms[tinyTerms.pickedList].storedData.queryComplete = true;\r\n                delete tinyTerms[tinyTerms.pickedList].storedData.hearts;\r\n            }\r\n            // Save to storage\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n        }\r\n    }\r\n}","\r\n// Imports\r\nimport { cl, clv, clickListener, alertMsg, jsonp, findKeys, makeSafeClass } from 'helperFunctions';\r\nimport appData from 'appData';\r\nimport tinyTerms from 'app';\r\nimport { createNewQuery } from 'queryInteraction';\r\nimport { setScore, addHearts, progressBar } from 'viewCreation';\r\n\r\n// Exports\r\nexport { revealedBtnHandler, createRevealTimer, dictionaryLookup, textToSpeech, addColour, hideModal, pickSymbol };\r\n\r\n// Handles functions when reveal button clicked\r\nconst revealedBtnHandler = function revealedBtnHandler() {\r\n\r\n    let revealBtn = document.querySelectorAll('.reveal');\r\n\r\n    clickListener(revealBtn, (i) => {\r\n\r\n        // Disabled button prevention\r\n        if (revealBtn[i].classList.contains('disabled')) {\r\n            return false;\r\n        }\r\n\r\n        let term = [revealBtn[i].parentNode.parentNode.querySelector('.term-holder').innerHTML];\r\n\r\n        // Updates the revealed view counter\r\n        let countHolder = revealBtn[i].parentNode.querySelector('.count');\r\n        let definitionWrapper = revealBtn[i].parentNode.parentNode.querySelector('.definition-wrapper');\r\n        let definitionHolder = revealBtn[i].parentNode.parentNode.querySelector('.definition-holder');\r\n        let count = parseInt(countHolder.innerHTML);\r\n\r\n        // Show definition\r\n        definitionWrapper.classList.remove('hidden');\r\n\r\n        // Animations\r\n        definitionWrapper.classList.add('slideInUp','animated');\r\n        revealBtn[i].parentNode.classList.add('rubberBand','animated');\r\n\r\n        // Set storedData\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term] = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term] || {};\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount || 0;\r\n        tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount += 1;\r\n        \r\n        // Daily reveal bonus\r\n        let revealGoalCount;\r\n\r\n        // If no existing term bonus\r\n        if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] === undefined) {\r\n            revealGoalCount = 1;\r\n        }\r\n\r\n        // Add one to daily bonus\r\n        else {\r\n            revealGoalCount = tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term];\r\n            revealGoalCount += 1;\r\n        }\r\n\r\n        // Update DOM\r\n        countHolder.innerHTML = revealGoalCount;\r\n\r\n        // If bonus is met\r\n        if (revealGoalCount === tinyTerms[tinyTerms.pickedList].ops.revealGoalTarget) {\r\n\r\n            // Add term to learned terms list\r\n            tinyTerms[tinyTerms.pickedList].storedData.learnedTerms = tinyTerms[tinyTerms.pickedList].storedData.learnedTerms || {};\r\n            tinyTerms[tinyTerms.pickedList].storedData.learnedTerms[term] = true;\r\n\r\n            // Check if whole term list answered correctly\r\n            if (Object.keys(tinyTerms[tinyTerms.pickedList].storedData.learnedTerms).length === Object.keys(tinyTerms[tinyTerms.pickedList].terms).length) {\r\n                tinyTerms[tinyTerms.pickedList].storedData.gameWon = true;\r\n                gameWon();\r\n            }\r\n\r\n            // If game won\r\n            function gameWon() {\r\n                let modal = document.querySelector('.m-modal');\r\n\r\n                // Bring up modal\r\n                modal.classList.remove('hidden');\r\n                document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n                let view = `<header>\r\n                                <h2 class=\"\">Whoop whoop!!</h2>\r\n                            </header>\r\n                            <p>Well done you completed the whole list! You get a bonus 10 points for each term learned.</p>\r\n                            <p>You can keep learning this list, reset it in the options to start from scratch or move on to\r\n                            learn something new entirely.</p>\r\n                            <p><strong>Great job!</strong></p>`;\r\n\r\n                // Add view\r\n                modal.querySelector('.content').innerHTML += view;\r\n\r\n                // Award bonus points\r\n                let completeBonus = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length * 10;\r\n                tinyTerms[tinyTerms.pickedList].storedData.score += completeBonus;\r\n                setScore();\r\n            }\r\n\r\n            // Update progress bar\r\n            progressBar();\r\n\r\n            // If daily bonus not already triggered\r\n            if (tinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete === false) {\r\n\r\n                // Keep query active \r\n                tinyTerms[tinyTerms.pickedList].storedData.queryComplete = false;\r\n                \r\n                // Create a new query\r\n                createNewQuery(true);\r\n            }\r\n            // Set only once a day\r\n            tinyTerms[tinyTerms.pickedList].storedData.revealGoal.complete = true;\r\n            tinyTerms[tinyTerms.pickedList].storedData.score += tinyTerms[tinyTerms.pickedList].ops.points.dailyBonus;\r\n            setScore();\r\n        }\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] = revealGoalCount;\r\n\r\n        // Save to storage\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        // Starts a timer \r\n        createRevealTimer(revealBtn[i]);\r\n    });\r\n}\r\n\r\n// Adds a timer to the reveal button\r\nconst createRevealTimer = function createRevealTimer(revealBtn) {\r\n\r\n    // If no stored data for reveal countdowns\r\n    tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns || {};\r\n\r\n    let term = [revealBtn.parentNode.parentNode.querySelector('.term-holder').innerHTML];\r\n    let minutes = tinyTerms[tinyTerms.pickedList].ops.counterMins;\r\n    let seconds = tinyTerms[tinyTerms.pickedList].ops.counterSecs;\r\n    let remainingMinutes;\r\n    let remainingSeconds;\r\n    let startTime;\r\n    let timerEnded;\r\n\r\n    // New timer\r\n    if (tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term] === undefined) {\r\n\r\n        // Get a new time\r\n        startTime = new Date().getTime();\r\n\r\n        // Set storedData\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term] = {\r\n            \"startTime\": startTime,\r\n            \"timerEnded\": false\r\n        };\r\n\r\n        // Start timer\r\n        startTimer();\r\n    }\r\n    // Existing timer\r\n    else {\r\n        // Start timer\r\n        startTimer();\r\n    }\r\n\r\n    function startTimer() {\r\n        let nowTime = new Date().getTime();\r\n        \r\n        // Disable button\r\n        revealBtn.classList.add('disabled');\r\n        revealBtn.setAttribute(\"disabled\", true);\r\n\r\n        // Get terms start time for countdown\r\n        startTime = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].startTime;\r\n        timerEnded = tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerEnded;\r\n\r\n        // Get difference in seconds\r\n        let diffSecs = Math.floor((nowTime - startTime) / 1000);\r\n        // Get total in seconds\r\n        let totalSecs = (tinyTerms[tinyTerms.pickedList].ops.counterMins * 60) + seconds;\r\n\r\n        // NowTime overtaken startTime\r\n        if (diffSecs >= totalSecs) {\r\n            timerEnded = true;\r\n            // Stop interval\r\n            clearInterval(tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerUpdate);\r\n            // Clear storage for term timer\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term];\r\n        }\r\n        // Timer stopped, return to normal\r\n        if (timerEnded === true) {\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            return false;\r\n        }\r\n        // Set remaining time \r\n        remainingSeconds = totalSecs - diffSecs;\r\n    }\r\n\r\n    // Set start time to storage\r\n    localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n    let timeout;\r\n    let checkCount = 0;\r\n\r\n    // If timer is active   \r\n    if (timerEnded === false) {\r\n\r\n        // Start timer interval\r\n        tinyTerms[tinyTerms.pickedList].storedData.revealCountdowns[term].timerUpdate = setInterval(() => {\r\n            // Resync timer in some devices when off screen\r\n            checkCount += 1;\r\n            if (checkCount % 5 === 0) {\r\n                startTimer();\r\n            }\r\n            // Call UI timer build\r\n            buttonTimer();\r\n        }, 1000)\r\n    }\r\n    else {\r\n        revealBtn.innerHTML = (\"Reveal\");\r\n        revealBtn.classList.remove('disabled');\r\n        revealBtn.disabled = false;\r\n    }\r\n\r\n    // Builds the timer\r\n    function buttonTimer() {\r\n        let displayedMinutes = Math.floor(remainingSeconds / 60);\r\n        let displayedSeconds = remainingSeconds % 60;\r\n        let hiddenZero = '';\r\n\r\n        // Timer end\r\n        if (remainingSeconds <= 0) {\r\n            revealBtn.innerHTML = (\"Reveal\");\r\n            revealBtn.classList.remove('disabled');\r\n            revealBtn.disabled = false;\r\n            return false;\r\n        }\r\n\r\n        // Handle issues like zero index\r\n        if (displayedSeconds < 10 && displayedSeconds >= 0) {\r\n            hiddenZero = '0';\r\n        }\r\n        if (remainingSeconds === 60) {\r\n            displayedSeconds = '00';\r\n        }\r\n        // Update DOM\r\n        revealBtn.innerHTML = (displayedMinutes + ':' + hiddenZero + displayedSeconds);\r\n\r\n        // Decrease timer\r\n        remainingSeconds -= 1;\r\n    }\r\n};\r\n\r\n// Allows for text to speech\r\nconst textToSpeech = function textToSpeech() {\r\n    let termHolder = document.querySelectorAll('.term-holder');\r\n\r\n    clickListener(termHolder, (i) => {\r\n\r\n        let languages = {\r\n            'German':'de-DE',\r\n            'English':'en-GB',\r\n            'Spanish':'es-ES',\r\n            'French':'fr-FR',\r\n            'Italian':'it-IT',\r\n            'Portuguese':'pt-BR'\r\n        }\r\n\r\n        if (typeof TTS === \"undefined\") {\r\n            let speech = new SpeechSynthesisUtterance(termHolder[i].innerHTML);\r\n            speech.lang = languages[tinyTerms[tinyTerms.pickedList].speechLang];\r\n\r\n            window.speechSynthesis.speak(speech);\r\n        }\r\n        else {\r\n            TTS\r\n            .speak({\r\n                text: termHolder[i].innerHTML,\r\n                locale: languages[tinyTerms[tinyTerms.pickedList].speechLang],\r\n                rate: 1\r\n            }, function () {\r\n            }, function (reason) {\r\n                alertMsg(reason);\r\n            });\r\n        }\r\n    });\r\n    if (tinyTerms[tinyTerms.pickedList].speechLang === \"None\") {\r\n        for (let k = 0; k < termHolder.length; k++){\r\n            termHolder[k].classList.add('no-speak');\r\n        }\r\n    }\r\n}\r\n\r\n// Retrieves dictionary references\r\nconst dictionaryLookup = function dictionaryLookup() {\r\n\r\n    let dictionaryBtn = document.querySelectorAll('.lookup');\r\n    let modal = document.querySelector('.m-modal');\r\n\r\n    clickListener(dictionaryBtn, (i) => {\r\n        let term = dictionaryBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"dictionary\">Dictionary definitions</h2>\r\n                    </header>\r\n                    <p>${term}:</p>\r\n                    <ul class=\"definitions\">\r\n                    </ul>`;\r\n\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        // Make JSONP call to Glosbe API\r\n        let definitionHolder = modal.querySelector('.definitions');\r\n        let dictionaryLookup = encodeURI('https://glosbe.com/gapi/translate?from='+tinyTerms[tinyTerms.pickedList]\r\n        .dictFrom+'&dest='+tinyTerms[tinyTerms.pickedList]\r\n        .dictTo+'&format=json&pretty=true&phrase=' + term.toLowerCase() + '');\r\n\r\n        // Make request to Glosbe\r\n        jsonp(dictionaryLookup)\r\n        .then(function (data) {\r\n            let dictionaryResponses = \"\";\r\n\r\n            try {\r\n                // Search through data for \"meanings\"\r\n                findProp(data, \"text\");\r\n\r\n                function findProp(obj, key, out) {\r\n                    let i;\r\n                    let proto = Object.prototype;\r\n                    let ts = proto.toString;\r\n                    let hasOwn = proto.hasOwnProperty.bind(obj);\r\n\r\n                    for (i in obj) {\r\n                        if (hasOwn(i)) {\r\n                            if (i === key) {\r\n                                dictionaryResponses += '<li>' + obj[i] + '</li>';\r\n                            } else if ('[object Array]' === ts.call(obj[i]) || '[object Object]' === ts.call(obj[i])) {\r\n                                findProp(obj[i], key, out);\r\n                            }\r\n                        }\r\n                    }\r\n                    return out;\r\n                }\r\n                if (data.tuc === undefined || data.tuc.length === 0) {\r\n                    dictionaryResponses = \"(Sorry, no dictionary results found)\"\r\n                }\r\n                // Add to DOM\r\n                definitionHolder.innerHTML = dictionaryResponses;\r\n            }\r\n            catch (err) {\r\n                console.log(err);\r\n            }\r\n        });\r\n    });\r\n}\r\n\r\n// Adds colours to term holders\r\nconst addColour = function addColour() {\r\n\r\n    let modal = document.querySelector('.m-modal');\r\n    let colourBtn = document.querySelectorAll('.colour');\r\n    let picker;\r\n    let colours;\r\n\r\n    clickListener(colourBtn, (i) => {\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let termHolder = colourBtn[i].parentNode.parentNode.parentNode;\r\n        let term = colourBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"colour\">Colour picker</h2>\r\n                    </header>\r\n                    <p>Click below to add a colour for <br>\"<span class=\"colour-term\">${term}</span>\":</p>\r\n                    <ul class=\"colour-wrap\">\r\n                        <li><a href=\"#\" data-colour=\"#F44336\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#E91E63\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#9C27B0\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#3F51B5\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#2196F3\"></a></li>\r\n\t\t\t\t\t\t<li><a href=\"#\" data-colour=\"#009688\"></a></li>\r\n                        <br>\r\n                        <li><a href=\"#\" data-colour=\"#4CAF50\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#CDDC39\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#FFC107\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#FF5722\"></a></li>\r\n                        <li><a href=\"#\" data-colour=\"#212121\"></a></li>\r\n                        <li><a href=\"#\" class=\"no-colour\" data-colour=\"#fff\"></a></li>\r\n                    </ul>`;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        let coloursHolder = modal.querySelector('.colour-wrap');\r\n        // Add colour vars\r\n        colours = coloursHolder.getElementsByTagName('a');\r\n\r\n        for (let j = 0; j < colours.length; j++) {\r\n            colours[j].style.backgroundColor = colours[j].getAttribute('data-colour');\r\n        }\r\n        colourListener();\r\n    });\r\n\r\n    // Add colour function\r\n    function colourListener() {\r\n        let term = document.querySelector('.colour-term').innerHTML;\r\n        let termEncode = makeSafeClass(term);\r\n        let termWrapper = document.querySelector('.' + termEncode + '');\r\n\r\n        // Pick a colour\r\n        clickListener(colours, (i) => {\r\n            let pickedColour = colours[i].getAttribute('data-colour');\r\n            // Add colour to object\r\n            termWrapper.querySelector('.theme-holder').style.background = pickedColour;\r\n            termWrapper.querySelector('.theme-holder').classList.add('bg-active');\r\n            termWrapper.querySelector('.term-holder').style.color = \"#fff\";\r\n            // Set storage\r\n            tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].colour = pickedColour;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            // Hide modal\r\n            hideModal(true);\r\n        });\r\n        document.querySelector('.no-colour').addEventListener('click',(e)=> {\r\n            termWrapper.querySelector('.term-holder').style.color = \"#3F4747\";\r\n            // Set storage\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].colour;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n        });\r\n    }\r\n}\r\n\r\n// Symbol picker\r\nconst pickSymbol = function pickSymbol() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let symbolBtn = document.querySelectorAll('.symbol');\r\n    let symbolHTML = \"<tr>\";\r\n    let symbols = appData.fonts;\r\n    let k = 0;\r\n\r\n    for (let i = 0; i < appData.fonts.feather.length; i++) {\r\n\r\n        if (k % 5 === 0 && k != 0) {\r\n            symbolHTML += '</tr><tr>';\r\n        }\r\n        symbolHTML += '<td><p class='+appData.fonts.feather[i]+'></p></td>';\r\n        k++;\r\n\r\n        if (i === (appData.fonts.feather.length - 1)) {\r\n            symbolHTML += \"</tr>\"\r\n        }\r\n    }\r\n\r\n    /* OLD UNICODE SYMOBLS\r\n    let symbolRanges = [[0x2600,0x26FF]]; //,[0x1200, 0x135A],[0xA000, 0xA48C]\r\n    for (let j = 0; j < symbolRanges.length; j++) {\r\n\r\n        for (let i = symbolRanges[j][0]; i < symbolRanges[j][1]; i++) {\r\n\r\n            if (k % 5 === 0 && k != 0) {\r\n                symbolHTML += '</tr><tr>';\r\n            }\r\n\r\n            let symbol = String.fromCodePoint(i);\r\n            symbolHTML += '<td><p>' + symbol + '&#xFE0E;</p></td>';\r\n            k++;\r\n\r\n            if (i === (symbolRanges[j][1] - 1)) {\r\n                symbolHTML += \"</tr>\"\r\n            }\r\n        }\r\n    }\r\n    */\r\n\r\n    clickListener(symbolBtn, (i) => {\r\n        // Bring up modal\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let termHolder = symbolBtn[i].parentNode.parentNode.parentNode;\r\n        let term = symbolBtn[i].parentNode.parentNode.parentNode.querySelector('.term-holder').innerHTML;\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"symbol\">Glyph picker</h2>\r\n                    </header>\r\n                    <p>Click below to add a glyph for <br>\"<span class=\"symbol-term\">${term}</span>\":</p>\r\n                    <div class=\"symbol-wrap\">\r\n                        <a href=\"#\" class=\"symbol-clear icon-right-open\">Reset</a>\r\n                        <table>${symbolHTML}</table>\r\n                    </div>`;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        symbolListener();\r\n    });\r\n    // Check for clicked symbol\r\n    function symbolListener() {\r\n        let term = document.querySelector('.symbol-term').innerHTML;\r\n        let termEncode = makeSafeClass(term);\r\n        let termWrapper = document.querySelector('.' + termEncode + '');\r\n        let pickedSymbol = \"\";\r\n\r\n        modal.getElementsByTagName('table')[0].addEventListener('click', function(e) {\r\n            e = e || window.event;\r\n            let target = e.target || e.srcElement;\r\n            pickedSymbol = target.getAttribute(\"class\");   \r\n            // Add symbol to object\r\n            termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n            termWrapper.querySelector('.symbol-holder').classList.add(pickedSymbol);\r\n            // Set storage\r\n            tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].symbol = pickedSymbol;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            // Hide modal\r\n            hideModal(true);\r\n        }, false);\r\n\r\n        document.querySelector('.symbol-clear').addEventListener('click',(e)=>{\r\n            // Set storage\r\n            termWrapper.querySelector('.symbol-holder').classList = ('symbol-holder');\r\n            delete tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].symbol;\r\n            localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n            hideModal(true);\r\n        });\r\n    }\r\n}\r\n\r\n// Hide modal\r\nconst hideModal = function hideModal(trigger) {\r\n    let modal = document.querySelector('.m-modal');\r\n    let modalClose = modal.querySelector('.close');\r\n\r\n    modalClose.addEventListener(\"click\", (e) => {\r\n        e.preventDefault();\r\n        closeModal();\r\n    });\r\n    // Programatically close modal\r\n    if (trigger) {\r\n        closeModal();\r\n    }\r\n    // Hide modal\r\n    function closeModal() {\r\n        document.getElementsByTagName('body')[0].classList.remove('modal-active');\r\n        modal.classList.add('hidden');\r\n        modal.querySelector('.content').innerHTML = \"\";\r\n    }\r\n}\r\n","\r\n// Imports\r\nimport { cl, clv, clickListener, checkURL, makeSafeClass } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { hideModal } from 'termInteraction';\r\n\r\n// Exports\r\nexport { showHome };\r\n\r\n// Show home screen\r\nconst showHome = function showHome() {\r\n\r\n\t// Once loaded\r\n\tsetTimeout(() => {\r\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.remove(\"loading\");\r\n\t\tdocument\r\n\t\t\t.querySelector(\".m-query\")\r\n\t\t\t.classList.add(\"animated\", \"slideInDown\");\r\n\t},\r\n\t\t2500\r\n\t);\r\n\r\n\ttinyTerms.uploadedLists = tinyTerms.uploadedLists || {};\r\n\r\n\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\ttinyTerms.customListChoices = tinyTerms.customListChoices || {};\r\n\r\n\t\t// Get uploaded lists\r\n\t\tfor (let val in uploadedLists) {\r\n\t\t\tlet listName = uploadedLists[val].name;\r\n\t\t\tlet listCategory = uploadedLists[val].category;\r\n\t\t\tlet listURL = uploadedLists[val].sheetURL;\r\n\r\n\t\t\ttinyTerms.customListChoices[listName] = {\r\n\t\t\t\tname: listName,\r\n\t\t\t\tcategory: listCategory,\r\n\t\t\t\tsheetURL: listURL\r\n\t\t\t}\r\n\t\t}\r\n\t\tcategoryHandler();\r\n\t});\r\n\r\n\t// Show home screen\r\n\tlet homeWrapper = document.querySelector('.m-menu');\r\n\thomeWrapper.classList.remove('hidden');\r\n\tdocument.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\tdocument.getElementsByTagName('body')[0].classList.add('home');\r\n\r\n\tlet homeHeader = document.querySelector('.home-bg').getElementsByTagName('h2')[0];\r\n\tlet chooseList = homeWrapper.querySelector('.choose-list');\r\n\tlet categories = chooseList.getElementsByTagName('nav')[0].innerHTML;\r\n\tlet navBack = document.querySelector('.nav-back');\r\n\tlet scrollArrow = document.querySelector('.scroll-arrow');\r\n\tlet scrollCheck;\r\n\tlet lists;\r\n\r\n\t// Sets initial listeners on categories\r\n\tfunction categoryHandler() {\r\n\t\tlet categoryBtn = document.querySelectorAll('.category');\r\n\r\n\t\t// Show custom list category if user uploaded\r\n\t\tif (Object.keys(tinyTerms.customListChoices).length > 0) {\r\n\t\t\tdocument.querySelector('.custom').style.display = \"inline-block\";\r\n\t\t}\r\n\r\n\t\tfor (let i = 0; i < categoryBtn.length; i++) {\r\n\t\t\tcategoryBtn[i].addEventListener('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t// Build coresponding list\r\n\t\t\t\tbuildList(categoryBtn[i].innerHTML);\r\n\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t// Show the list\r\n\t\t\t\t\tshowList();\r\n\t\t\t\t\t// Listener to go back to categories\r\n\t\t\t\t\tnavBack.addEventListener('click', (e) => {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tshowCategoriesAgain();\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Set listeners for nav\r\n\t\t\t\t\tnavListeners();\r\n\t\t\t\t}, 500);\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tfunction buildList(category) {\r\n\t\tchooseList.classList.add('animated', 'slideOutLeft');\r\n\t\thomeHeader.classList.add('animated', 'fadeOutUp');\r\n\t\tlists = \"\";\r\n\t\tfor (let val in tinyTerms.listChoices) {\r\n\r\n\t\t\tif (tinyTerms.listChoices[val].category === category) {\r\n\t\t\t\tlists += '<a href=\"#\">' + tinyTerms.listChoices[val].name + '</a>';\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let val in tinyTerms.customListChoices) {\r\n\t\t\t\r\n\t\t\tif (tinyTerms.customListChoices[val].category === category) {\r\n\t\t\t\tlists += '<div class=\"' + makeSafeClass(tinyTerms.customListChoices[val].name) + '\"><span class=\"custom-list\"></span><a href=\"#\">' + tinyTerms.customListChoices[val].name + '</a></div>';\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showList() {\r\n\t\thomeHeader.innerHTML = \"Choose a list:\";\r\n\t\thomeHeader.classList.remove('fadeOutUp');\r\n\t\thomeHeader.classList.add('fadeInDown');\r\n\t\tnavBack.classList.remove('hidden');\r\n\t\tchooseList.getElementsByTagName('nav')[0].innerHTML = lists;\r\n\t\tchooseList.classList.remove('slideOutLeft');\r\n\t\tchooseList.classList.add('slideInRight');\r\n\r\n\t\tif (chooseList.getElementsByTagName('a').length > 3) {\r\n\t\t\tchooseList.classList.add('slideInRight', 'scroll');\r\n\r\n\t\t\tscrollCheck = setInterval(() => {\r\n\t\t\t\tif (chooseList.clientHeight === (chooseList.scrollHeight - chooseList.scrollTop)) {\r\n\t\t\t\t\tscrollArrow.classList.add('hidden');\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tscrollArrow.classList.remove('hidden');\r\n\t\t\t\t}\r\n\t\t\t}, 500);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction showCategoriesAgain() {\r\n\t\thomeHeader.classList.add('fadeOutUp');\r\n\t\thomeHeader.classList.remove('fadeInDown');\r\n\t\tchooseList.classList.remove('slideInRight');\r\n\t\tchooseList.classList.add('slideOutRight');\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\thomeHeader.innerHTML = \"Choose a category:\";\r\n\t\t\thomeHeader.classList.remove('fadeOutUp');\r\n\t\t\thomeHeader.classList.add('fadeInDown');\r\n\t\t\tnavBack.classList.add('hidden');\r\n\t\t\tchooseList.getElementsByTagName('nav')[0].innerHTML = categories;\r\n\t\t\tchooseList.classList.add('slideInLeft');\r\n\t\t\tchooseList.classList.remove('slideOutRight', 'scroll');\r\n\t\t\tcategoryHandler();\r\n\t\t}, 500);\r\n\t}\r\n\r\n\tfunction navListeners() {\r\n\t\t// Add listener to nav\r\n\t\tlet listItem = document.querySelector('.choose-list').querySelectorAll('a');\r\n\r\n\t\tfor (var i = 0; i < listItem.length; i++) {\r\n\t\t\tlistItem[i].addEventListener('click', function (e) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\ttinyTerms.pickedList = this.innerHTML;\r\n\t\t\t\tlocalforage.getItem('tinyTermsAllPicked', function (err, value) {\r\n\t\t\t\t\ttinyTerms.AllPicked = value || [];\r\n\r\n\t\t\t\t\tif (tinyTerms.AllPicked.includes(tinyTerms.pickedList) === false) {\r\n\t\t\t\t\t\ttinyTerms.AllPicked.push(tinyTerms.pickedList);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlocalforage.setItem('tinyTermsAllPicked', tinyTerms.AllPicked, () => {\r\n\t\t\t\t\t\tlocalforage.setItem('tinyTermsDefault', tinyTerms.pickedList, () => {\r\n\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Add listener to remove list\r\n\t\tlet removeList = document.querySelectorAll('.custom-list');\r\n\t\tfor (let i = 0; i < removeList.length; i++) {\r\n\r\n\t\t\tremoveList[i].addEventListener('click', (e) => {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tlet insertPoint = removeList[i].nextSibling;\r\n\t\t\t\tdocument.querySelector('.create-list').classList.add('hidden');\r\n\t\t\t\tremoveList[i].classList.add('hidden');\r\n\t\t\t\tremoveList[i].parentNode.insertBefore(document.createElement(\"div\"), insertPoint.nextSibling);\r\n\t\t\t\tinsertPoint.nextSibling.innerHTML = '<p>Are you sure you want to delete your list? (Can\\'t undo)</p><button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n\t\t\t\tdocument.querySelector('.delete-confirm').addEventListener('click', () => {\r\n\t\t\t\t\tlet listName = removeList[i].parentNode.childNodes[1].innerHTML;\r\n\r\n\t\t\t\t\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\t\t\t\t\ttinyTerms.uploadedLists = uploadedLists || {};\r\n\t\t\t\t\t\tdelete tinyTerms.uploadedLists[listName];\r\n\t\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Delete list from nav\r\n\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\tremoveList[i].parentNode.removeChild(insertPoint.nextSibling);\r\n\t\t\t\t\t\tremoveList[i].parentNode.parentNode.removeChild(document.querySelector('.' + makeSafeClass(listName)));\r\n\r\n\t\t\t\t\t\t// Delete list references\r\n\t\t\t\t\t\tlocalforage.removeItem(tinyTerms.storedName).then(function () {\r\n\t\t\t\t\t\t\tlocalforage.removeItem(tinyTerms[tinyTerms.pickedList]).then(function () {\r\n\t\t\t\t\t\t\t\tlocalforage.removeItem(\"tinyTermsDefault\");\r\n\t\t\t\t\t\t\t\tlocation.reload();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tdocument.querySelector('.delete-cancel').addEventListener('click', () => {\r\n\t\t\t\t\tremoveList[i].parentNode.removeChild(insertPoint.nextSibling);\r\n\t\t\t\t\tremoveList[i].classList.remove('hidden');\r\n\t\t\t\t\tdocument.querySelector('.create-list').classList.remove('hidden');\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\t// Upload list button\r\n\tdocument.querySelector('.upload-info').addEventListener('click', (e) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet modal = document.querySelector('.m-modal');\r\n\r\n\t\t// Bring up modal\r\n\t\tmodal.classList.remove('hidden');\r\n\t\tmodal.style.zIndex = \"101\";\r\n\t\tmodal.querySelector('.close').addEventListener('click', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\thideModal(true);\r\n\t\t});\r\n\r\n\t\tlet view = `<header>\r\n                        <h2 class=\"\">Upload a list</h2>\r\n                    </header>\r\n                    <p>Create your very own list of Tiny Terms! For more info please visit:</p>\r\n                    <a target=\"_blank\" href=\"http://www.tiny-terms.com\">http://www.tiny-terms.com</a>\r\n                    \r\n                    <div class=\"list-uploader\">\r\n                        <label>List Name (max 25 characters)</label>\r\n                        <input class=\"upload-name\" type=\"text\" placeholder=\"Enter list name\">\r\n                        <label>List URL</label>\r\n                        <input class=\"upload-sheet\" type=\"text\" placeholder=\"Paste list URL\">\r\n                        <button class=\"upload-list\">Upload</button>\r\n                    </div>`;\r\n\r\n\t\t// Add view\r\n\t\tmodal.querySelector('.content').innerHTML += view;\r\n\r\n\t\twindow.addEventListener(\"keypress\", function (e) {\r\n\t\t\tlet inputName = document.querySelector('.upload-name').value;\r\n\t\t\tlet inputSheet = document.querySelector('.upload-sheet').value;\r\n\r\n\t\t\tif (e.keyCode === 13) {\r\n\t\t\t\tuploadList(inputName, inputSheet);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tdocument.querySelector('.upload-list').addEventListener('click', (e) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tlet inputName = document.querySelector('.upload-name').value;\r\n\t\t\tlet inputSheet = document.querySelector('.upload-sheet').value;\r\n\r\n\t\t\tuploadList(inputName, inputSheet);\r\n\t\t});\r\n\t});\r\n\tfunction uploadList(inputName, inputSheet) {\r\n\t\tinputName = inputName.substring(0, 25);\r\n\r\n\t\tif (inputName.length === 0) {\r\n\t\t\tdocument.querySelector('.upload-name').style.border = \"1px solid #ff0000\";\r\n\t\t\tdocument.querySelector('.upload-name').placeholder = \"Please enter a name\";\r\n\t\t}\r\n\t\tif (inputName.length > 0 && inputSheet.length > 0) {\r\n\r\n\t\t\t// Check valid URL\r\n\t\t\tif (checkURL(inputSheet) === true) {\r\n\t\t\t\tlocalforage.getItem('tinyTerms.uploadedLists', function (err, uploadedLists) {\r\n\t\t\t\t\ttinyTerms.uploadedLists = uploadedLists || {};\r\n\t\t\t\t\ttinyTerms.uploadedLists[inputName] = {\r\n\t\t\t\t\t\tname: inputName,\r\n\t\t\t\t\t\tcategory: 'Your lists',\r\n\t\t\t\t\t\tsheetURL: inputSheet\r\n\t\t\t\t\t};\r\n\t\t\t\t\tlocalforage.setItem('tinyTerms.uploadedLists', tinyTerms.uploadedLists, () => {\r\n\t\t\t\t\t\ttinyTerms.customListChoices = tinyTerms.customListChoices || {};\r\n\t\t\t\t\t\ttinyTerms.customListChoices[inputName] = {\r\n\t\t\t\t\t\t\tname: inputName,\r\n\t\t\t\t\t\t\tcategory: 'Your lists',\r\n\t\t\t\t\t\t\tsheetURL: inputSheet\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tdocument.querySelector('.custom').style.display = \"inline-block\";\r\n\t\t\t\t\t\tbuildList('Your lists');\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t// Show the list\r\n\t\t\t\t\t\t\tshowList();\r\n\t\t\t\t\t\t\t// Listener to go back to categories\r\n\t\t\t\t\t\t\tnavBack.addEventListener('click', (e) => {\r\n\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\tshowCategoriesAgain();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t// Set listeners for nav\r\n\t\t\t\t\t\t\tnavListeners();\r\n\t\t\t\t\t\t}, 500);\r\n\t\t\t\t\t\thideModal(true);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdocument.querySelector('.upload-sheet').style.border = \"1px solid #ff0000\";\r\n\t\t\t\tdocument.querySelector('.upload-sheet').value = \"\";\r\n\t\t\t\tdocument.querySelector('.upload-sheet').placeholder = \"Please enter a valid Sheets URL\";\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","// Imports\nimport tinyTerms from \"app\";\nimport { showHome } from \"homeScreen\";\n\n// Exports\nexport {\n\tready,\n\tcl,\n\tclv,\n\terrorReport,\n\tbuildData,\n\tcheckSameDay,\n\tarrayCheck,\n\tcheckConnection,\n\tmakeSafeClass,\n\tgetTodaysDate,\n\tcheckURL,\n\terrorAlert,\n\talertMsg,\n\tpickRandom,\n\tclickListener,\n\tcountLines,\n\tgetTimeComplete,\n\tcheckQuery,\n\tsortArrayByKey,\n\tappBlur,\n\tjsonp,\n\tfindKeys,\n\tupdateDataCount,\n\tgetCSS\n};\n\n// JS ready\nfunction ready(fn) {\n\tif (document.readyState != \"loading\") {\n\t\tfn();\n\t}\n\telse {\n\t\tdocument.addEventListener(\"DOMContentLoaded\", fn);\n\t}\n}\n\n// Console log -> cl\nfunction cl(log) {\n\tconsole.log(log);\n}\n\n// Console log plus value\nfunction clv(term, log) {\n\tconsole.log(term + \"= \" + log);\n}\n\n// Send crash report\nconst errorReport = function errorReport() {\n\n\tif (typeof cordova !== \"undefined\") {\n\t\tcordova.plugins.instabug.invoke();\n\t}\n}\n\n// Alert errors\nconst errorAlert = function errorAlert(message, cb) {\n\n\twindow.onerror = (errorMsg, url, lineNumber, column, errorObj) => {\n\t\tlet modal = document.querySelector('.m-modal');\n\t\tmodal.classList.remove(\"hidden\");\n\t\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\t\tlet view = `<header>\n                        <h2 class=\"\">Uh oh!</h2>\n                    </header>\n                    <br>\n                    <h3>${message}</h3>\n                    <p><strong>Here's the exact problem:</strong></p>\n                    <p>'Error: ${errorMsg}</p> \n                    <p>Script: ${url}</p> \n                    <p>Line: ${lineNumber}</p>\n                    <p>Column: ${column}</p> \n                    <p>StackTrace: ${errorObj}</p>\n\n                    <button class=\"crash-report\">Report issue</button><button class=\"home-btn\">Close</button>\n                    `;\n\n\t\t// Add view\n\t\tmodal.querySelector(\".content\").innerHTML += view;\n\t\tmodal.classList.add('onboard');\n\t\tcb();\n\n\t\tdocument.querySelector('.errorReport').addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\terrorReport();\n\t\t});\n\n\t\tdocument.querySelector(\".home-btn\").addEventListener(\"click\", (e) => {\n\t\t\te.preventDefault();\n\t\t\tshowHome()\n\t\t});\n\t\treturn false;\n\t};\n}\n\n// Alert errors\nconst alertMsg = function alertMsg(message, cb) {\n\n\tlet modal = document.querySelector('.m-modal');\n\tmodal.classList.remove(\"hidden\");\n\tdocument.getElementsByTagName(\"body\")[0].classList.add(\"modal-active\");\n\n\tlet view = `<header>\n\t\t\t\t\t<h2 class=\"\">Something's not right</h2>\n\t\t\t\t</header>\n\t\t\t\t<p>${message}</p>\n\n\t\t\t\t<button class=\"home-btn\">Close</button>\n\t\t\t\t`;\n\n\t// Add view\n\tmodal.querySelector(\".content\").innerHTML += view;\n\tmodal.classList.add('onboard');\n\tcb();\n\treturn false;\n}\n\n// Gets data from Google Sheets\nconst buildData = function buildData(data) {\n\tlet columnName = data.Sheet1.columnNames[1];\n\n\ttinyTerms[tinyTerms.pickedList].speechLang = columnName;\n\ttinyTerms[tinyTerms.pickedList].dictFrom = data.Sheet1.elements[0][columnName];\n\ttinyTerms[tinyTerms.pickedList].dictTo = data.Sheet1.elements[1][columnName];\n\ttinyTerms[tinyTerms.pickedList].action = data.Sheet1.elements[2][columnName];\n\ttinyTerms[tinyTerms.pickedList].terms = tinyTerms[tinyTerms.pickedList].terms || {};\n\n\tfor (let i = 0; i < data.Sheet1.elements.length; i++) {\n\t\tlet termContent = data.Sheet1.elements[i].Term;\n\t\tlet definitionContent = data.Sheet1.elements[i].Definition;\n\t\tlet supportContent = data.Sheet1.elements[i].Support;\n\n\t\ttinyTerms[tinyTerms.pickedList].terms[termContent] = {};\n\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].term = termContent;\n\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].definition = definitionContent;\n\t\ttinyTerms[tinyTerms.pickedList].terms[termContent].support = supportContent;\n\t}\n\ttinyTerms.postBuildCallback();\n};\n\n// Check for network connection\nconst checkConnection = function checkConnection() {\n\n\tlet networkState = navigator.connection.type;\n\tlet states = {};\n\n\tstates[Connection.UNKNOWN] = 'Unknown';\n\tstates[Connection.ETHERNET] = 'Ethernet';\n\tstates[Connection.WIFI] = 'WiFi';\n\tstates[Connection.CELL_2G] = '2G';\n\tstates[Connection.CELL_3G] = '3G';\n\tstates[Connection.CELL_4G] = '4G';\n\tstates[Connection.CELL] = 'Cell';\n\tstates[Connection.NONE] = 'None';\n\n\treturn states[networkState];\n}\n\n// Count number of lines of text\nconst countLines = function countLines(target) {\n\tlet style = window.getComputedStyle(target, null);\n\tlet height = parseInt(style.getPropertyValue(\"height\"));\n\tlet font_size = parseInt(style.getPropertyValue(\"font-size\"));\n\tlet line_height = parseInt(style.getPropertyValue(\"line-height\"));\n\tlet box_sizing = style.getPropertyValue(\"box-sizing\");\n\n\tif (isNaN(line_height)) line_height = font_size * 1.2;\n\n\tif (box_sizing == 'border-box') {\n\t\tlet padding_top = parseInt(style.getPropertyValue(\"padding-top\"));\n\t\tlet padding_bottom = parseInt(style.getPropertyValue(\"padding-bottom\"));\n\t\tlet border_top = parseInt(style.getPropertyValue(\"border-top-width\"));\n\t\tlet border_bottom = parseInt(style.getPropertyValue(\"border-bottom-width\"));\n\t\theight = height - padding_top - padding_bottom - border_top - border_bottom\n\t}\n\tlet lines = Math.ceil(height / line_height);\n\treturn lines;\n}\n\n// Checks if the same or new day\nfunction checkSameDay() {\n\tlet todaysDate = getTodaysDate();\n\tlet storedDate = [];\n\n\t// Get date last stored\n\tstoredDate = Array.from(\n\t\ttinyTerms[tinyTerms.pickedList].storedData.dateOpened\n\t);\n\n\t// Check if same day\n\tif (arrayCheck(todaysDate, storedDate) === true) {\n\t\tif (tinyTerms[tinyTerms.pickedList].ops.addDay === true) {\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = true;\n\t\t}\n\t\telse {\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = false;\n\t\t}\n\t}\n\telse {\n\t\t// Otherwise a new day\n\t\ttinyTerms[tinyTerms.pickedList].storedData.newDay = true;\n\t}\n}\n\n// Creates array of day and month\nfunction getTodaysDate() {\n\t// Get current day + month\n\tlet todayDate = [];\n\tlet day = new Date().getDate();\n\tlet month = new Date().getMonth();\n\n\ttodayDate.push([day, month]);\n\n\treturn todayDate;\n}\n\n// Creates array of day, month, hour, minute, second\nfunction getTimeComplete() {\n\t// Get complete date time value\n\tlet timeComplete = [];\n\tlet day = new Date().getDate();\n\tlet month = new Date().getMonth();\n\tlet hour = new Date().getHours();\n\tlet minute = new Date().getMinutes();\n\tlet second = new Date().getSeconds();\n\n\ttimeComplete.push([day, month, hour, minute, second]);\n\n\treturn timeComplete;\n}\n\n// Validate URL\nconst checkURL = function checkURL(str) {\n\tlet a = document.createElement(\"a\");\n\ta.href = str;\n\treturn a.host && a.host != window.location.host;\n};\n\n// Makes a safe class name\nconst makeSafeClass = function makeSafeClass(name) {\n\treturn name.replace(/[^a-z0-9]/g, function (s) {\n\t\tlet c = s.charCodeAt(0);\n\t\tif (c == 32) return \"-\";\n\t\tif (c >= 65 && c <= 90) return \"_\" + s.toLowerCase();\n\t\treturn \"__\" + (\"000\" + c.toString(16)).slice(-4);\n\t});\n};\n\n// Check if arrays are the same\nfunction arrayCheck(arr1, arr2) {\n\t// If same return true\n\tif (JSON.stringify(arr1) == JSON.stringify(arr2)) {\n\t\treturn true;\n\t}\n\t// Else false\n\treturn false;\n}\n\n// Adds click functionality to selectors\nfunction clickListener(elements, clickFunction) {\n\tfor (let i = 0; i < elements.length; i++) {\n\t\telements[i].addEventListener(\"click\", e => {\n\t\t\te.preventDefault();\n\t\t\tclickFunction(i);\n\t\t});\n\t}\n}\n\n// Get a random term\nfunction pickRandom(objectList) {\n\tlet keys = Object.keys(objectList);\n\tlet pickedTerm = keys[keys.length * Math.random() << 0];\n\treturn pickedTerm;\n}\n\n// Check if two words the same\nfunction checkQuery(item1, item2) {\n\tif (item1 === item2) return true;\n\tif (item1.toUpperCase() === item2.toUpperCase()) return true;\n\n\t// Perform fuzzy comparison\n\tlet getBigrams = function (string) {\n\t\tlet i, j, ref, s, v;\n\t\ts = string.toLowerCase();\n\t\tv = new Array(s.length - 1);\n\t\tfor ((i = (j = 0)), (ref = v.length); j <= ref; i = (j += 1)) {\n\t\t\tv[i] = s.slice(i, i + 2);\n\t\t}\n\t\treturn v;\n\t};\n\tlet stringSimilarity = function (str1, str2) {\n\t\tlet hit_count, j, k, len, len1, pairs1, pairs2, union, x, y;\n\t\tif (str1.length > 0 && str2.length > 0) {\n\t\t\tpairs1 = getBigrams(str1);\n\t\t\tpairs2 = getBigrams(str2);\n\t\t\tunion = pairs1.length + pairs2.length;\n\t\t\thit_count = 0;\n\t\t\tfor ((j = 0), (len = pairs1.length); j < len; j++) {\n\t\t\t\tx = pairs1[j];\n\t\t\t\tfor ((k = 0), (len1 = pairs2.length); k < len1; k++) {\n\t\t\t\t\ty = pairs2[k];\n\t\t\t\t\tif (x === y) {\n\t\t\t\t\t\thit_count++;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hit_count > 0) {\n\t\t\t\treturn 2.0 * hit_count / union;\n\t\t\t}\n\t\t}\n\t\treturn 0.0;\n\t};\n\tlet relevance = stringSimilarity(item1, item2);\n\tif (relevance > tinyTerms[tinyTerms.pickedList].ops.wordAccuracy)\n\t\treturn \"mispelled\";\n\n\t// Else false\n\treturn false;\n}\n\n// When user navigates away from page\nconst appBlur = function appBlur() {\n\tlet hidden = \"hidden\";\n\n\t// Standards:\n\tif (hidden in document)\n\t\tdocument.addEventListener(\"visibilitychange\", onchange);\n\telse if ((hidden = \"mozHidden\") in document)\n\t\tdocument.addEventListener(\"mozvisibilitychange\", onchange);\n\telse if ((hidden = \"webkitHidden\") in document)\n\t\tdocument.addEventListener(\"webkitvisibilitychange\", onchange);\n\telse if ((hidden = \"msHidden\") in document)\n\t\tdocument.addEventListener(\"msvisibilitychange\", onchange);\n\telse if (\"onfocusin\" in document)\n\t\t// IE 9 and lower:\n\t\tdocument.onfocusin = (document.onfocusout = onchange);\n\telse\n\t\t// All others:\n\t\twindow.onpageshow = (window.onpagehide = (window.onfocus = (window.onblur = onchange)));\n\n\tfunction onchange(evt) {\n\t\tlet v = \"visible\",\n\t\t\th = \"hidden\",\n\t\t\tevtMap = {\n\t\t\t\tfocus: v,\n\t\t\t\tfocusin: v,\n\t\t\t\tpageshow: v,\n\t\t\t\tblur: h,\n\t\t\t\tfocusout: h,\n\t\t\t\tpagehide: h\n\t\t\t};\n\n\t\tevt = evt || window.event;\n\t\tif (evt.type in evtMap) {\n\t\t\t//cl(evtMap[evt.type]);\n\t\t}\n\t\telse {\n\t\t\tlocation.reload();\n\t\t}\n\t}\n\n\t// set the initial state (but only if browser supports the Page Visibility API)\n\tif (document[hidden] !== undefined)\n\t\tonchange({\n\t\t\ttype: document[hidden] ? \"blur\" : \"focus\"\n\t\t});\n};\n\n// Order array based on nested key\nconst sortArrayByKey = function sortArrayByKey(arr, key, reverse) {\n\tlet sortOrder = 1;\n\tif (reverse) {\n\t\tsortOrder = -1;\n\t}\n\treturn arr.sort(function (a, b) {\n\t\tlet x = a[1][key];\n\t\tlet y = b[1][key];\n\t\treturn sortOrder * (x < y ? -1 : x > y ? 1 : 0);\n\t});\n};\n\n// Creates JSONP requests\nconst jsonp = function jsonp(uri) {\n\treturn new Promise(function (resolve, reject) {\n\t\tlet id = \"_\" + Math.round(10000 * Math.random());\n\t\tlet callbackName = \"jsonp_callback_\" + id;\n\t\twindow[callbackName] = function (data) {\n\t\t\tdelete window[callbackName];\n\t\t\tlet ele = document.getElementById(id);\n\t\t\tele.parentNode.removeChild(ele);\n\t\t\tresolve(data);\n\t\t};\n\n\t\tlet src = uri + \"&callback=\" + callbackName;\n\t\tlet script = document.createElement(\"script\");\n\t\tscript.src = src;\n\t\tscript.id = id;\n\t\tscript.addEventListener(\"error\", reject);\n\t\t(document.getElementsByTagName(\"head\")[0] ||\n\t\t\tdocument.body ||\n\t\t\tdocument.documentElement)\n\t\t\t.appendChild(script);\n\t});\n};\n\n// Find all keys in object ! Potentially cyclicle !\nconst findKeys = function findKeys(obj, key) {\n\tlet val = obj[key];\n\tlet keysList = [];\n\n\tfor (val in obj) {\n\t\tif (obj[val] === key) {\n\t\t\tkeysList.push(obj[val]);\n\t\t}\n\t}\n\treturn keysList;\n};\n\n// Handles count of a type of data\nconst updateDataCount = function updateDataCount(\n\tobjectParent,\n\tnewProps,\n\tbaseValue\n) {\n\t// If no viewed data, create new\n\tif (!objectParent.hasOwnProperty(newProps)) {\n\t\tfor (let value of newProps) {\n\t\t\tobjectParent[value] = baseValue;\n\t\t}\n\t}\n\telse {\n\t\t// If viewed data exists\n\t\t// Update count\n\t\tfor (let value of newProps) {\n\t\t\tif (objectParent.hasOwnProperty(value)) {\n\t\t\t\tobjectParent[value] += 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tobjectParent[value] = baseValue;\n\t\t\t}\n\t\t}\n\t}\n\t// Pass back final object\n\treturn objectParent;\n};\n\n// Returns a CSS property for an elements\nconst getCSS = function getCSS(style, selector) {\n\tfor (let i = 0; i < document.styleSheets.length; i++) {\n\t\tlet mysheet = document.styleSheets[i];\n\t\tlet myrules = mysheet.cssRules ? mysheet.cssRules : mysheet.rules;\n\t\tfor (let j = 0; j < myrules.length; j++) {\n\t\t\tif (\n\t\t\t\tmyrules[j].selectorText &&\n\t\t\t\tmyrules[j].selectorText.toLowerCase() === selector\n\t\t\t) {\n\t\t\t\treturn myrules[j].style[style];\n\t\t\t}\n\t\t}\n\t}\n};","\r\n// Imports\r\nimport { cl, clv, pickRandom, sortArrayByKey } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\n\r\n// Exports\r\nexport { getListOfTerms };\r\n\r\n// Creates a list of terms\r\nconst getListOfTerms = function getListOfTerms() {\r\n\tlet i = 0;\r\n\tlet j = 0;\r\n\tlet listOfTerms = [];\r\n\tlet scannedTerms = [];\r\n\tconst dataLength = Object.keys(tinyTerms[tinyTerms.pickedList].terms).length;\r\n\r\n\t// Prevent overflow\r\n\tif (tinyTerms[tinyTerms.pickedList].ops.displayedTerms > dataLength) {\r\n\t\ttinyTerms[tinyTerms.pickedList].ops.displayedTerms = dataLength;\r\n\t}\r\n\r\n\t// First time app opened\r\n\tif (tinyTerms[tinyTerms.pickedList].storedData.firstTime === undefined) {\r\n\r\n\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\tlet pickedTerm = pickRandom(tinyTerms[tinyTerms.pickedList].terms);\r\n\r\n\t\t\t// Ensure term hasn't been already scanned\r\n\t\t\tif (!listOfTerms.includes(pickedTerm)) {\r\n\t\t\t\tlistOfTerms.push(pickedTerm);\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// App opened before\r\n\telse {\r\n\r\n\t\t// Add reminder for previous incorrect term\r\n\t\ttinyTerms[tinyTerms.pickedList].storedData.incorrectTerms = tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms || {};\r\n\r\n\t\tif (Object.keys(tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms).length > 0) {\r\n\r\n\t\t\tlet reminderTerm;\r\n\r\n\t\t\t// Add reminded terms list\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms = tinyTerms[tinyTerms.pickedList].storedData.remindedTerms || {};\r\n\r\n\t\t\t// Keep reminded term the same\r\n\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder === undefined) {\r\n\t\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyReminder = {};\r\n\t\t\t\treminderTerm = pickRandom(tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms);\r\n\t\t\t\ttinyTerms[tinyTerms.pickedList].storedData.dailyReminder[reminderTerm] = tinyTerms[tinyTerms.pickedList].terms[reminderTerm].definition;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treminderTerm = tinyTerms[tinyTerms.pickedList].storedData.dailyReminder;\r\n\t\t\t\treminderTerm = Object.getOwnPropertyNames(reminderTerm);\r\n\t\t\t}\r\n\r\n\t\t\t// Add to terms\r\n\t\t\tlistOfTerms.push(reminderTerm);\r\n\r\n\t\t\t// Remove from incorrect terms\r\n\t\t\tdelete tinyTerms[tinyTerms.pickedList].storedData.incorrectTerms[reminderTerm];\r\n\r\n\t\t\t// Add to list of reminded terms\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.remindedTerms[reminderTerm] = tinyTerms[tinyTerms.pickedList].terms[reminderTerm].definition;\r\n\t\t\ti++;\r\n\t\t}\r\n\r\n\t\t// Choose terms to  display\r\n\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.viewedTerms = tinyTerms[tinyTerms.pickedList].storedData.viewedTerms || {};\r\n\t\t\tlet viewedLength = Object.keys(tinyTerms[tinyTerms.pickedList].storedData.viewedTerms).length;\r\n\r\n\t\t\t// If all terms viewed \r\n\t\t\tif ((viewedLength + i) === dataLength) {\r\n\t\t\t\tlet viewedSorted = [];\r\n\r\n\t\t\t\t// Convert viewed terms to array\r\n\t\t\t\tfor (let term in tinyTerms[tinyTerms.pickedList].storedData.viewedTerms) {\r\n\t\t\t\t\tviewedSorted.push([term, tinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term]]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If reminder term picked remove from selection\r\n\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder !== undefined) {\r\n\r\n\t\t\t\t\tfor (let m = viewedSorted.length - 1; m >= 0; m--) {\r\n\r\n\t\t\t\t\t\tif (tinyTerms[tinyTerms.pickedList].storedData.dailyReminder.hasOwnProperty(viewedSorted[m][0])) {\r\n\t\t\t\t\t\t\tviewedSorted.splice(m, 1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Sort array by view count\r\n\t\t\t\tviewedSorted = sortArrayByKey(viewedSorted, 'viewCount');\r\n\r\n\t\t\t\t// Finish off iterator with lowest viewed terms\r\n\t\t\t\twhile (i < tinyTerms[tinyTerms.pickedList].ops.displayedTerms) {\r\n\t\t\t\t\tlistOfTerms.push(viewedSorted[i][0]);\r\n\t\t\t\t\ti++;\r\n\t\t\t\t}\r\n                \r\n\t\t\t\t// Overflow protection\r\n\t\t\t\ti++;\r\n\t\t\t}\r\n\t\t\t// Still unviewed terms in data\r\n\t\t\telse {\r\n\t\t\t\tlet pickedTerm = pickRandom(tinyTerms[tinyTerms.pickedList].terms);\r\n\r\n\t\t\t\t// Ensure term hasn't been already scanned\r\n\t\t\t\tif (!scannedTerms.includes(pickedTerm)) {\r\n\t\t\t\t\tscannedTerms.push(pickedTerm);\r\n\r\n\t\t\t\t\t// Ensure term not viewed before\r\n\t\t\t\t\tif (!tinyTerms[tinyTerms.pickedList].storedData.viewedTerms.hasOwnProperty(pickedTerm)) {\r\n\t\t\t\t\t\tlistOfTerms.push(pickedTerm);\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Overflow protection\r\n\t\t\tif (j > 10000) {\r\n\t\t\t\ti = tinyTerms[tinyTerms.pickedList].ops.displayedTerms;\r\n\t\t\t}\r\n\t\t\tj++;\r\n\t\t}\r\n\t}\r\n\t// Return final list of terms\r\n\treturn listOfTerms;\r\n}","\r\n// Imports\r\nimport { cl, clv, clickListener } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { hideModal } from 'termInteraction';\r\nimport { createNewQuery } from 'queryInteraction';\r\n\r\n// Exports\r\nexport { onboardShow };\r\n\r\n// Show home screen\r\nconst onboardShow = function onboardShow() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let onBoardText = document.querySelector('.m-onboarding');\r\n    let topTerm = document.querySelectorAll('.m-term-wrapper')[0];\r\n    let definitionHolder = topTerm.querySelector('.definition-holder');\r\n\tlet topBtn = topTerm.getElementsByTagName('button')[0];\r\n\r\n    tinyTerms.tutComplete = false;\r\n    localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n\r\n    // Onboard - Stage 1\r\n    modal.classList.remove('hidden');\r\n    document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n    let view = `<header>\r\n                    <h2 class=\"icon-child\">Welcome to Tiny Terms!</h2>\r\n                </header>\r\n                <p>Looks like this is your first time here, so let's go over some basics before you get started.</p>\r\n                <button class=\"onboard-1\">Let's go!</button>\r\n                <a href=\"#\" class=\"close-tut\">Skip the tutorial</a>\r\n                `;\r\n    modal.querySelector('.content').innerHTML = view;\r\n    modal.classList.add('onboard');\r\n    document.querySelector('.close-tut').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        hideModal(true);\r\n        modal.classList.remove('onboard');\r\n        tinyTerms.tutComplete = true;\r\n        localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n    });\r\n\r\n    document.querySelector('.onboard-1').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        onboardStage2();\r\n    });\r\n    function onboardStage2() {\r\n        hideModal(true);\r\n        topTerm.style.zIndex = \"100\";\r\n        topTerm.querySelector('.term-holder').classList.add('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.definition-wrapper').classList.add('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n        topBtn.setAttribute('disabled', 'true');\r\n        document.querySelector('.m-modal').style.cssText = \"display: none !important\";\r\n        onBoardText.classList.remove('hidden');\r\n\r\n        let view = `<p>This is one of the terms you will be learning, you get 5 each day.</p>\r\n                    <button class=\"onboard-2\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        let termOffset = topTerm.offsetTop + topTerm.offsetHeight;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        document.querySelector('.onboard-2').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage3();\r\n        });\r\n    }\r\n    function onboardStage3() {\r\n        topTerm.querySelector('.term-holder').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.term-views').classList.add('animated', 'pulse', 'infinite');\r\n        let view = `<p>On the right is the goal meter, fill this and the term is marked as complete.</p>\r\n                    <button class=\"onboard-3\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        onBoardText.classList.add('onboard-right');\r\n\r\n        document.querySelector('.onboard-3').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage4();\r\n        });\r\n    }\r\n    function onboardStage4() {\r\n        topTerm.querySelector('.term-views').classList.remove('animated', 'pulse', 'infinite');\r\n        topBtn.classList.add('animated', 'pulse', 'infinite');\r\n        \r\n\t\tlet timerOveride = setInterval(()=>{\r\n\t\t\ttopBtn.classList.remove('disabled');\r\n        \ttopBtn.removeAttribute('disabled');\r\n\t\t},100);\r\n\r\n        let view = `<p style=\"border:0; margin: 10px 0; padding: 0\">Press the reveal button to continue!</p>\r\n                    `;\r\n        onBoardText.innerHTML = view;\r\n\r\n        topBtn.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n\t\t\tclearInterval(timerOveride);\r\n            onboardStage5();\r\n        });\r\n    }\r\n    function onboardStage5() {\r\n        topBtn.classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.definition-wrapper').classList.remove('hidden');\r\n        topTerm.querySelector('.definition-holder').classList.add('animated', 'pulse', 'infinite');\r\n        topBtn.classList.add('disabled');\r\n\r\n\t\t// Prevent cheating\r\n\t\tlet goal = topTerm.querySelector('.count');\r\n\t\tlet goalCount = parseInt(goal.innerHTML);\r\n\r\n\t\tif (goalCount > 1) {\r\n\t\t\tgoalCount -= 1;\r\n\t\t\tgoal.innerHTML = goalCount;\r\n\t\t\tlet term = topTerm.querySelector('.term-holder').innerHTML;\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.viewedTerms[term].viewCount = goalCount;\r\n\t\t\ttinyTerms[tinyTerms.pickedList].storedData.revealGoal[term] = goal.innerHTML = goalCount;\r\n\t\t\t // Save to storage\r\n        \tlocalforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\t\t}\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + definitionHolder.offsetHeight + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>This is the definition you need to learn, helpful information is displayed underneath.</p>\r\n                    <button class=\"onboard-5\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        onBoardText.classList.remove('onboard-right');\r\n\r\n        document.querySelector('.onboard-5').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage6();\r\n        });\r\n    }\r\n    function onboardStage6() {\r\n        topTerm.querySelector('.definition-holder').classList.remove('animated', 'pulse', 'infinite');\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>Tiny Terms uses spaced repetition, check back in an hour to add to the goal.</p>\r\n                    <button class=\"onboard-6\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n        onBoardText.classList.add('onboard-right');\r\n\r\n        document.querySelector('.onboard-6').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage7();\r\n        });\r\n    }\r\n    function onboardStage7() {\r\n        topTerm.querySelector('.colour').classList.add('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.symbol').classList.add('animated', 'pulse', 'infinite');\r\n        document.querySelector('.query-holder').setAttribute('disabled', 'true');\r\n\r\n        let termOffset = topTerm.offsetTop + definitionHolder.offsetTop + definitionHolder.offsetHeight + 95;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n\r\n        let view = `<p>You can add a colour and symbol to the term, the visual association will help you rememeber.</p>\r\n                    <button class=\"onboard-7\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        document.querySelector('.onboard-7').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage8();\r\n        });\r\n    }\r\n    function onboardStage8() {\r\n        topTerm.querySelector('.colour').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.querySelector('.symbol').classList.remove('animated', 'pulse', 'infinite');\r\n        topTerm.style.zIndex = \"50\";\r\n        let queryWrap = document.querySelector('.m-query');\r\n        document.querySelector('.query-submit').setAttribute('disabled', 'true');\r\n        document.querySelector('.m-modal').style.cssText = \"\";\r\n        hideModal(true);\r\n\r\n        createNewQuery(true);\r\n        delete tinyTerms[tinyTerms.pickedList].storedData.dailyQuery;\r\n        localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]);\r\n\r\n        let termOffset = queryWrap.offsetTop + queryWrap.offsetHeight;\r\n        onBoardText.style.top = termOffset + \"px\";\r\n        queryWrap.style.zIndex = \"100\";\r\n\r\n        let view = `<p>Each day you get a mini test to see how well you have rememebered, you can also unlock an extra test by completing at least one goal meter in a day.</p>\r\n                    <button class=\"onboard-8\">Next</button>`;\r\n        onBoardText.innerHTML = view;\r\n\r\n        document.querySelector('.onboard-8').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            onboardStage9();\r\n        });\r\n    }\r\n    function onboardStage9() {\r\n        modal.classList.remove('hidden');\r\n        onBoardText.innerHTML = \"\";\r\n        onBoardText.classList.add('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n        let queryWrap = document.querySelector('.m-query');\r\n        document.querySelector('.query-holder').removeAttribute('disabled');\r\n        document.querySelector('.query-submit').removeAttribute('disabled');\r\n        \r\n\r\n        queryWrap.style.zIndex = \"50\";\r\n        queryWrap.classList.add('hidden');\r\n        topTerm.querySelector('.definition-wrapper').classList.remove('hidden');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"\">That's about it</h2>\r\n                    </header>\r\n                    <p>Fill the progress bar by completing the goal meters to finish the list! You get points for answering tests correctly and completing goal meters, use them to unlock cool stuff. <br><br>Good luck!</p>\r\n                    <button class=\"close-tut\">Close the tutorial</button>\r\n                    `;\r\n        modal.querySelector('.content').innerHTML = view;\r\n        modal.classList.add('onboard');\r\n        document.querySelector('.close-tut').addEventListener(\"click\", (e) => {\r\n            e.preventDefault();\r\n            hideModal(true);\r\n            tinyTerms.tutComplete = true;\r\n            localforage.setItem(\"tinyTerms.tutComplete\", tinyTerms.tutComplete);\r\n            modal.classList.remove('onboard');\r\n        });\r\n    }\r\n}","\r\n// Imports\r\nimport { cl, clv, errorReport } from 'helperFunctions';\r\nimport tinyTerms from 'app';\r\nimport { showHome } from \"homeScreen\";\r\nimport { onboardShow } from \"introInstructions\";\r\nimport { hideModal } from 'termInteraction';\r\n\r\n// Exports\r\nexport { navMenu, footerMenu, optionsDisplay };\r\n\r\n// Nav menu functions\r\nconst navMenu = function navMenu() {\r\n    let nav = document.querySelector('.m-nav').querySelectorAll('nav')[0];\r\n\r\n    showNav();\r\n\r\n    function showNav() {\r\n        document.getElementsByTagName('h1')[0].addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            document.querySelector('.m-nav').classList.toggle('hidden');\r\n            document.getElementsByTagName('body')[0].classList.toggle('nav-on');\r\n\r\n            setTimeout(() => { hideNav() }, 100);\r\n        });\r\n    }\r\n\r\n    function hideNav() {\r\n        document.querySelector('.nav-on').querySelector('.container').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            document.querySelector('.m-nav').classList.toggle('hidden');\r\n            document.getElementsByTagName('body')[0].classList.toggle('nav-on');\r\n\r\n            setTimeout(() => { showNav() }, 100);\r\n        });\r\n    }\r\n\r\n    document.querySelector('.nav-close').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        document.querySelector('.m-nav').classList.toggle('hidden');\r\n        document.getElementsByTagName('body')[0].classList.toggle('nav-on');\r\n\r\n        setTimeout(() => { showNav() }, 100);\r\n    });\r\n\r\n\r\n    localforage.getItem(\"tinyTermsAllPicked\", function (err, tinyTermsAllPicked) {\r\n        tinyTerms.AllPicked = tinyTermsAllPicked || [];\r\n        let navHTML = nav.innerHTML;\r\n\r\n        for (let i = 0; i < tinyTerms.AllPicked.length; i++) {\r\n            navHTML += '<a href=\"#\">' + tinyTerms.AllPicked[i] + '</a>';\r\n        }\r\n        nav.innerHTML = navHTML;\r\n\r\n        let navItems = nav.querySelectorAll('a');\r\n        let i = 1;\r\n\r\n        do {\r\n            navItems[i].addEventListener('click', function (e) {\r\n\r\n                e.preventDefault();\r\n                tinyTerms.pickedList = this.innerHTML;\r\n\r\n                localforage.setItem('tinyTermsDefault', tinyTerms.pickedList, () => {\r\n                    location.reload();\r\n                });\r\n            });\r\n            i++\r\n        }\r\n        while (i < navItems.length);\r\n\r\n        document.querySelector('.view-all').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            showHome();\r\n        });\r\n    });\r\n}\r\n\r\n// Footer menu functions\r\nconst footerMenu = function footerMenu() {\r\n    let modal = document.querySelector('.m-modal');\r\n\r\n    document.querySelector('.refresh').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        location.reload();\r\n    });\r\n\r\n    document.querySelector('.store').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-gift\">Store</h2>\r\n                    </header>\r\n                    <div class=\"options\">\r\n                        <p>Unlocks: (coming soon)</p>\r\n                        <a href=\"#\" class=\"icon-right-open points-neon-colours\">1000: Unlock neon colours</a>\r\n                        <a href=\"#\" class=\"icon-right-open points-life-glyphs\">5000: Unlock solid symbols</a>\r\n                        <a href=\"#\" class=\"icon-right-open points-metal-colours\">10000: Unlock metal colours</a>\r\n                    </div>\r\n                    `;\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n    });\r\n\r\n    document.querySelector('.stats').addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-chart-bar\">Progress</h2>\r\n                    </header>\r\n                    <div class=\"options\">\r\n                        <p>Unlocks: (coming soon)</p>\r\n                        <a href=\"#\" class=\"icon-right-open points-neon-colours\">1000: Unlock neon colours</a>\r\n                        <a href=\"#\" class=\"icon-right-open points-life-glyphs\">5000: Unlock solid symbols</a>\r\n                        <a href=\"#\" class=\"icon-right-open points-metal-colours\">10000: Unlock metal colours</a>\r\n                    </div>\r\n                    `;\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n    });\r\n}\r\n\r\n// Options menu\r\nconst optionsDisplay = function optionsDisplay() {\r\n    let modal = document.querySelector('.m-modal');\r\n    let settingsBtn = document.querySelector('.settings');\r\n\r\n    settingsBtn.addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        modal.classList.remove('hidden');\r\n        document.getElementsByTagName('body')[0].classList.add('modal-active');\r\n\r\n        let view = `<header>\r\n                        <h2 class=\"icon-cog-outline\">Options</h2>\r\n                    </header>\r\n                    <div class=\"options\">\r\n                        <p>Help</p>\r\n                        <a href=\"#\" class=\"icon-right-open show-tut\">Show the tutorial again</a>\r\n                        <a href=\"mailto:info@tiny-terms.com\" class=\"icon-right-open\">Email a question</a>\r\n                        <a href=\"#\" class=\"icon-right-open feedback\">Report a bug/leave feedback</a>\r\n                        <p>More Options</p>\r\n                        <a href=\"#\" class=\"icon-right-open reset-list\">Reset list progress</a>\r\n                        <a href=\"#\" class=\"icon-right-open reset\">Reset the app</a>\r\n                        <p class=\"low-header\">Credits</p>\r\n                        <p><small>All design and development by Alex Plummer.</small><br>\r\n                        <small>Icons courtesy of <a href=\"http://www.toicon.com/authors/1\">Shannon E Thomas</a> at <a href=\"http://www.toicon.com\">toicon.com</a></small></p>\r\n                    </div>\r\n                    `;\r\n\r\n        // Add view\r\n        modal.querySelector('.content').innerHTML += view;\r\n\r\n        let resetList = document.querySelector('.reset-list');\r\n        let resetApp = document.querySelector('.reset');\r\n\r\n        document.querySelector('.show-tut').addEventListener('click', (e) => { e.preventDefault(); onboardShow() });\r\n\r\n        document.querySelector('.feedback').addEventListener('click', (e) => { e.preventDefault(); errorReport() });\r\n\r\n        function resetMenu() {\r\n            if (document.querySelector('.delete-confirm') !== null) {\r\n                resetList.innerHTML = \"Reset list progress\";\r\n                resetApp.innerHTML = \"Reset the app\";\r\n                document.querySelector('.delete-confirm').parentNode.removeChild(document.querySelector('.delete-cancel'));\r\n                document.querySelector('.delete-confirm').parentNode.removeChild(document.querySelector('.delete-confirm'));\r\n            }\r\n        }\r\n        resetList.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            resetMenu();\r\n            resetList.innerHTML = \"Are you sure you want to delete progress for this list? (Can't undo)\";\r\n            resetList.parentNode.insertBefore(document.createElement(\"div\"), resetList.nextSibling);\r\n            resetList.nextSibling.innerHTML = '<button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n            document.querySelector('.delete-confirm').addEventListener('click', () => {\r\n                delete tinyTerms[tinyTerms.pickedList];\r\n                localforage.setItem(tinyTerms.storedName, tinyTerms[tinyTerms.pickedList]).then(function (value) {;\r\n                    localforage.removeItem('tinyTermsDefault').then(function() {\r\n                        location.reload();\r\n                    }); \r\n                });\r\n            });\r\n            document.querySelector('.delete-cancel').addEventListener('click', () => {\r\n                hideModal(true);\r\n            });\r\n        });\r\n        document.querySelector('.reset').addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            resetMenu();\r\n            resetApp.innerHTML = \"Are you sure you want to delete all progress for the app? (Can't undo)\";\r\n            resetApp.parentNode.insertBefore(document.createElement(\"div\"), resetApp.nextSibling);\r\n            resetApp.nextSibling.innerHTML = '<button class=\"delete-cancel\">Cancel</button><button class=\"delete-confirm\">Confim</button>';\r\n\r\n            document.querySelector('.delete-confirm').addEventListener('click', () => {\r\n                localforage.clear().then(() => {\r\n                    location.reload();\r\n                });\r\n            });\r\n            document.querySelector('.delete-cancel').addEventListener('click', () => {\r\n                hideModal(true);\r\n            });\r\n        });\r\n    });\r\n}"]}